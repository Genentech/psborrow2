[{"path":"https://genentech.github.io/psborrow2/CODE_OF_CONDUCT.html","id":null,"dir":"","previous_headings":"","what":"Contributor Code of Conduct","title":"Contributor Code of Conduct","text":"contributors maintainers project, pledge respect people contribute reporting issues, posting feature requests, updating documentation, submitting pull requests patches, activities. committed making participation project harassment-free experience everyone, regardless level experience, gender, gender identity expression, sexual orientation, disability, personal appearance, body size, race, ethnicity, age, religion. Examples unacceptable behavior participants include use sexual language imagery, derogatory comments personal attacks, trolling, public private harassment, insults, unprofessional conduct. Project maintainers right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct. Project maintainers follow Code Conduct may removed project team. Instances abusive, harassing, otherwise unacceptable behavior may reported opening issue contacting one project maintainers. Code Conduct adapted Contributor Covenant (https://www.contributor-covenant.org), version 1.0.0, available https://contributor-covenant.org/version/1/0/0/.","code":""},{"path":"https://genentech.github.io/psborrow2/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to psborrow2","title":"Contributing to psborrow2","text":"Contributions welcome, greatly appreciated! Every little bit helps, credit always given.","code":""},{"path":"https://genentech.github.io/psborrow2/CONTRIBUTING.html","id":"submit-an-issue","dir":"","previous_headings":"","what":"Submit an Issue","title":"Contributing to psborrow2","text":"best way get started file issue GitHub discuss like work (bug, feature request, documentation). way spend time working something prioritized.","code":""},{"path":"https://genentech.github.io/psborrow2/CONTRIBUTING.html","id":"fork-the-repository-and-create-a-branch","dir":"","previous_headings":"","what":"Fork the Repository and Create a Branch","title":"Contributing to psborrow2","text":"issue prepared tackle, fork repository create branch work issue. get started making changes address issue, recommend successfully running R CMD CHECK locally make sure can catch problems address may cause package fail checks.","code":""},{"path":"https://genentech.github.io/psborrow2/CONTRIBUTING.html","id":"make-changes-locally","dir":"","previous_headings":"","what":"Make Changes Locally","title":"Contributing to psborrow2","text":"Make changes locally commit . Make sure write good commit messages, used generate release notes package. Make sure : - Add tests new features bug fixes - Update documentation reflect changes (see DOCUMENTATION.md) - Run R CMD CHECK devtools::check() locally make sure introduced new problems - Check spelling devtools::spell_check() Note package style linting addressed entire package release.","code":""},{"path":"https://genentech.github.io/psborrow2/CONTRIBUTING.html","id":"push-to-github-and-open-a-pull-request","dir":"","previous_headings":"","what":"Push to GitHub and Open a Pull Request","title":"Contributing to psborrow2","text":"finished making changes, push branch GitHub open pull request. Make sure include description changes reference issue addressing.","code":""},{"path":"https://genentech.github.io/psborrow2/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to psborrow2","text":"Please note psborrow2 project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"https://genentech.github.io/psborrow2/DOCUMENTATION.html","id":null,"dir":"","previous_headings":"","what":"Creating Documention for psborrow2","title":"Creating Documention for psborrow2","text":"psborrow2 relies (CmdStan)[https://mc-stan.org/users/interfaces/cmdstan], shell interface Stan missing CRAN’s system dependencies, vignettes pre-knitted included package. making new vignette proposing changes existing vignette, first build package locally (devtools::build()), install package (e.g., install.packages(\"path//local/package.tar.gz\", repos = NULL)), make changes vignette vignettes/original directory. use Make target build build vignettes. See vignettes/Makefile targets.","code":""},{"path":"https://genentech.github.io/psborrow2/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"License","title":"License","text":"Copyright 2023, Genentech, Inc. Licensed Apache License, Version 2.0 (“License”); may use file except compliance License. may obtain copy License http://www.apache.org/licenses/LICENSE-2.0 Unless required applicable law agreed writing, software distributed License distributed “” BASIS, WITHOUT WARRANTIES CONDITIONS KIND, either express implied. See License specific language governing permissions limitations License.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"generating-baseline-data","dir":"Articles","previous_headings":"","what":"Generating Baseline Data","title":"7. Data Simulation","text":"First define generate baseline data study. simplest form need define many patients arms: treated internal, control internal, control external. object defines data created. actually generate sample, use generate() produce list containing data.frames arm. can convert single data.frame needed. Often interested additional covariates. Internally package uses multivariate normal distributions, need specify means (co-)variances. option specify different distribution parameters internal external arms. internal arms assumed randomized therefore come distribution. external parameters specified, internal ones used . complex setting, can generate correlated baseline covariates specifying variance-covariance matrix main diagonal (variance components) upper triangle (covariance components). Finally, option transform non-normal covariates, binary cut-offs. can added existing objects can use built-functions used defined.","code":"simple_baseline <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 100 ) baseline_data <- generate(simple_baseline) baseline_data #> Baseline Data List #>  #> Internal Treated #>  patid ext trt #>      1   0   1 #>      2   0   1 #>      3   0   1 #>      4   0   1 #>      5   0   1 #>      6   0   1 #> Internal Control #>  patid ext trt #>    101   0   0 #>    102   0   0 #>    103   0   0 #>    104   0   0 #>    105   0   0 #>    106   0   0 #> External Control #>  patid ext trt #>    151   1   0 #>    152   1   0 #>    153   1   0 #>    154   1   0 #>    155   1   0 #>    156   1   0 as.data.frame(baseline_data) #>   patid ext trt #> 1     1   0   1 #> 2     2   0   1 #> 3     3   0   1 #> 4     4   0   1 #> 5     5   0   1 #> 6     6   0   1 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 244 rows ] with_age <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 100,   covariates = baseline_covariates(     names = \"age\",     means_int = 55,     covariance_int = covariance_matrix(5)   ) ) set.seed(123) generate(with_age) #> Baseline Data List #>  #> Internal Treated #>  patid ext trt      age #>      1   0   1 53.74674 #>      2   0   1 54.48531 #>      3   0   1 58.48538 #>      4   0   1 55.15766 #>      5   0   1 55.28910 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 1 rows ] #> Internal Control #>  patid ext trt      age #>    101   0   0 53.41148 #>    102   0   0 55.57441 #>    103   0   0 54.44838 #>    104   0   0 54.22287 #>    105   0   0 52.87212 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 1 rows ] #> External Control #>  patid ext trt      age #>    151   1   0 56.76144 #>    152   1   0 56.71963 #>    153   1   0 55.74283 #>    154   1   0 52.74520 #>    155   1   0 54.73290 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 1 rows ] covariance_matrix(diag = c(5, 1.2), upper_tri = c(0.1)) #>      [,1] [,2] #> [1,]  5.0  0.1 #> [2,]  0.1  1.2  with_age_score <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 100,   covariates = baseline_covariates(     names = c(\"age\", \"score\"),     means_int = c(55, 5),     means_ext = c(60, 5),     covariance_int = covariance_matrix(diag = c(5, 1)),     covariance_ext = covariance_matrix(diag = c(5, 1.2), upper_tri = c(0.1))   ) ) data_age_score <- generate(with_age_score) df_age_score <- as.data.frame(data_age_score) plot(   x = df_age_score$age,   y = df_age_score$score,   col = df_age_score$trt + 1,   pch = df_age_score$ext * 16,   xlab = \"Age\",   ylab = \"Score\" ) legend(   \"topright\",   legend = c(\"internal treated\", \"internal control\", \"external control\"),   col = c(2, 1, 1),   pch = c(0, 0, 16) ) with_age_score <- with_age_score %>%   set_transformations(     score_high = binary_cutoff(\"score\", int_cutoff = 0.7, ext_cutoff = 0.7),     score_rounded = function(data) round(data$score)   ) set.seed(123) generate(with_age_score) #> Baseline Data List #>  #> Internal Treated #>  patid ext trt      age    score score_high score_rounded #>      1   0   1 53.74674 4.769823          0             5 #>      2   0   1 58.48538 5.070508          0             5 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 4 rows ] #> Internal Control #>  patid ext trt      age    score score_high score_rounded #>    101   0   0 59.91669 6.312413          1             6 #>    102   0   0 54.40712 5.543194          1             6 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 4 rows ] #> External Control #>  patid ext trt      age    score score_high score_rounded #>    151   1   0 58.40067 4.247311          0             4 #>    152   1   0 57.90136 3.947487          0             4 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 4 rows ]"},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"generating-survival-data","dir":"Articles","previous_headings":"","what":"Generating Survival Data","title":"7. Data Simulation","text":"Using baseline object specified, can generate survival outcome data including various parameters like dropout rate, enrollment rate clinical cut-. First need specify outcome distribution. underlying data generation handled simsurv package. create_event_dist() function take parameters needed define distribution. simplest case can use exponential distribution specifying single lambda parameter. also use Weibull Gompertz distributions, mixtures distributions, even specify arbitrary (log/cumulative) hazard function. minimum required parameters create data simulation object baseline object event distribution. can expand including baseline object covariates need coefficients including hazard calculation. can include coefficient treatment parameter (treatment_hr) difference internal external arms (drift_hr). can peek data get_data(): can control datasets generated n, treatment_hr drift_hr parameters generate(). override defaults specified create_data_simulation(). add features simulation set_enrollment(), set_cut_off() set_dropout() functions modify DataSimObject.","code":"exponential_dist <- create_event_dist(dist = \"exponential\", lambda = 1 / 24) create_data_simulation(   baseline = create_baseline_object(n_trt_int = 100, n_ctrl_int = 50, n_ctrl_ext = 100),   event_dist = exponential_dist ) %>% generate() #> SimDataList object with  1  different scenarios #>   sim_id treatment_hr drift_hr n_datasets_per_param #> 1      1            1        1                    1 data_sim <- create_data_simulation(   baseline = with_age_score,   coefficients = c(age = 0.001, score_high = 1.5),   event_dist = exponential_dist,   treatment_hr = 0.5,   drift_hr = 0.9 )  data_list <- generate(data_sim)  data_list #> SimDataList object with  1  different scenarios #>   sim_id treatment_hr drift_hr n_datasets_per_param #> 1      1          0.5      0.9                    1 get_data(data_list, index = 1, dataset = 1) %>% head() #>   patid      age score_high trt ext  eventtime status enrollment cens #> 1     1 53.25887          0   1   0 163.587989      1          1    0 #> 2     2 55.64217          0   1   0   6.884799      1          1    0 #>  [ reached getOption(\"max.print\") -- omitted 4 rows ] generate(data_sim, n = 10, treatment_hr = c(1, 1.3, 2), drift_hr = c(1, 1.2)) #> SimDataList object with  6  different scenarios #>   sim_id treatment_hr drift_hr n_datasets_per_param #> 1      1          1.0      1.0                   10 #> 2      2          1.3      1.0                   10 #> 3      3          2.0      1.0                   10 #> 4      4          1.0      1.2                   10 #> 5      5          1.3      1.2                   10 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 1 rows ]"},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"enrollment","dir":"Articles","previous_headings":"Generating Survival Data","what":"Enrollment","title":"7. Data Simulation","text":"Currently one enrollment option defined, enrollment_constant fixed number patients enrolled period given time duration, enrollment_constant(rate = c(5, 2), for_time = c(4, 5)) enrolls 5 patients periods 1, 2, 3, 4, 2 patients 5, 6, 7, 8, 9. New methods can specified defining function takes parameter n, number patients generate enrollment times .","code":"poisson_enrollment <- custom_enrollment(   fun = function(n) rpois(n, lambda = 5),   label = \"Poisson enrollment distribution\" ) set_enrollment(data_sim, internal = poisson_enrollment) #> DataSimObject #> ------------- #> Baseline object: #> Baseline Data Simulation Object #>   N internal treated:  100  #>   N internal control:  50  #>   N external control:  100  #>  #> Covariates:  #> [[1]] #>  covariate means_internal means_external #>        age             55             60 #>      score              5              5 #>  #> Covariance Matrices #> Internal          External #>       age score         age score  #> age     5     0   age   5.0   0.1  #> score   0     1   score 0.1   1.2  #>  #> Transformations:  #>    score_high, score_rounded  #>  #> Event distribution: #> exponential distribution with lambda = 0.0416666666666667  #>  #> Treatment HR:  0.5  #> Drift HR:  0.9  #>  #> Coefficients: #>        age score_high  #>      0.001      1.500  #>  #> Enrollment: #>  Internal: Poisson enrollment distribution  #>  External: Poisson enrollment distribution  #>  #> Dropout: #>  Internal treated: No distribution specified  #>  Internal control: No distribution specified  #>  External control: No distribution specified  #>  #> Clinical cut off: #>  Internal: No cut off  #>  External: No cut off"},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"drop-out","dir":"Articles","previous_headings":"Generating Survival Data","what":"Drop Out","title":"7. Data Simulation","text":"Drop defined using create_event_dist() function survival time. covariates can specified distributions, can set different distributions three arms.","code":"set_dropout(   data_sim,   internal_treated = create_event_dist(dist = \"exponential\", lambdas = 1 / 50),   internal_control = create_event_dist(dist = \"exponential\", lambdas = 1 / 55),   external_control = create_event_dist(dist = \"weibull\", lambdas = 1 / 40, gammas = 1.1) ) #> DataSimObject #> ------------- #> Baseline object: #> Baseline Data Simulation Object #>   N internal treated:  100  #>   N internal control:  50  #>   N external control:  100  #>  #> Covariates:  #> [[1]] #>  covariate means_internal means_external #>        age             55             60 #>      score              5              5 #>  #> Covariance Matrices #> Internal          External #>       age score         age score  #> age     5     0   age   5.0   0.1  #> score   0     1   score 0.1   1.2  #>  #> Transformations:  #>    score_high, score_rounded  #>  #> Event distribution: #> exponential distribution with lambda = 0.0416666666666667  #>  #> Treatment HR:  0.5  #> Drift HR:  0.9  #>  #> Coefficients: #>        age score_high  #>      0.001      1.500  #>  #> Enrollment: #>  Internal: Enrolling 1 patient per time  #>  External: Enrolling 1 patient per time  #>  #> Dropout: #>  Internal treated: exponential distribution with lambda = 0.02  #>  Internal control: exponential distribution with lambda = 0.0181818181818182  #>  External control: weibull distribution with lambda = 0.025 and gamma = 1.1  #>  #> Clinical cut off: #>  Internal: No cut off  #>  External: No cut off"},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"clinical-cut-off","dir":"Articles","previous_headings":"","what":"Clinical Cut Off","title":"7. Data Simulation","text":"cases want mimic clinical trial cut rule, patient data certain time censored. Different rules available : - fixed time first patient enrolled cut_off_after_first(time = 36) - fixed time last patient enrolled cut_off_after_first(time = 60) - fixed number events observed cut_off_after_events(n = 45) patient survival time longer rules status set 0 eventtime set cut time.","code":"set_cut_off(   data_sim,   internal = cut_off_after_first(time = 36),   external = cut_off_after_events(n = 45) ) #> DataSimObject #> ------------- #> Baseline object: #> Baseline Data Simulation Object #>   N internal treated:  100  #>   N internal control:  50  #>   N external control:  100  #>  #> Covariates:  #> [[1]] #>  covariate means_internal means_external #>        age             55             60 #>      score              5              5 #>  #> Covariance Matrices #> Internal          External #>       age score         age score  #> age     5     0   age   5.0   0.1  #> score   0     1   score 0.1   1.2  #>  #> Transformations:  #>    score_high, score_rounded  #>  #> Event distribution: #> exponential distribution with lambda = 0.0416666666666667  #>  #> Treatment HR:  0.5  #> Drift HR:  0.9  #>  #> Coefficients: #>        age score_high  #>      0.001      1.500  #>  #> Enrollment: #>  Internal: Enrolling 1 patient per time  #>  External: Enrolling 1 patient per time  #>  #> Dropout: #>  Internal treated: No distribution specified  #>  Internal control: No distribution specified  #>  External control: No distribution specified  #>  #> Clinical cut off: #>  Internal: Cut off after first enrolled patient reaches time = 36  #>  External: Cut off after 45 events"},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"running-a-simulation","dir":"Articles","previous_headings":"","what":"Running a simulation","title":"7. Data Simulation","text":"Putting together: Now can define simulation setup models: finally sample models. See vignette “4. Conduct simulation study” details.","code":"my_baseline <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 100,   covariates = baseline_covariates(     names = c(\"age\", \"score\"),     means_int = c(55, 5),     means_ext = c(60, 5),     covariance_int = covariance_matrix(diag = c(5, 1)),     covariance_ext = covariance_matrix(diag = c(5, 1.2), upper_tri = c(0.1))   ),   transformations = list(score_high = binary_cutoff(\"score\", int_cutoff = 0.7, ext_cutoff = 0.7)) )  my_data_sim_setup <- create_data_simulation(   baseline = my_baseline,   coefficients = c(age = 0.001, score_high = 1.1),   event_dist = create_event_dist(dist = \"exponential\", lambdas = 1 / 50) ) %>%   set_enrollment(     internal = enrollment_constant(rate = c(25, 10), for_time = c(4, 30)),     external = enrollment_constant(rate = c(30, 10), for_time = c(4, 30))   ) %>%   set_dropout(     internal_treated = create_event_dist(dist = \"exponential\", lambdas = 1 / 50),     internal_control = create_event_dist(dist = \"exponential\", lambdas = 1 / 55),     external_control = create_event_dist(dist = \"exponential\", lambdas = 1 / 40)   ) %>%   set_cut_off(     internal = cut_off_after_first(time = 60),     external = cut_off_after_events(n = 100)   )  my_data_list <- generate(my_data_sim_setup, n = 3, treatment_hr = c(1, 1.3), drift_hr = c(1, 1.2)) borrowing <- sim_borrowing_list(list(full = borrowing_full(\"ext\"))) outcome <- sim_outcome_list(   list(standard_outcome = outcome_surv_exponential(     time_var = \"eventtime\",     cens_var = \"cens\",     baseline_prior = prior_normal(0, 1000)   )) ) covariate <- sim_covariate_list(list(   cov1 = add_covariates(c(\"age\", \"score_high\"), prior_normal(0, 1000)),   no_covs = NULL ))  treatment <- sim_treatment_list(   list(standard_tx = treatment_details(trt_flag_col = \"trt\", trt_prior = prior_normal(0, 1000))) )  sim_obj <- create_simulation_obj(   data_matrix_list = my_data_list,   outcome = outcome,   borrowing = borrowing,   treatment = treatment,   covariate = covariate ) sim_results <- mcmc_sample(sim_obj, chains = 1) get_results(sim_results)"},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"using-fixed-external-data","dir":"Articles","previous_headings":"Running a simulation","what":"Using fixed external data","title":"7. Data Simulation","text":"can also include known data set external data, wish simulate operating characteristics using previously collected data. done setting external_data argument create_data_simulation data frame. data included enrollment, cut-dropout functions applied, effect fixed data. possible include fixed external dataset additionally simulate external patients setting n_ctrl_ext non-zero value. simulate external patients addition fixed data.","code":"historical_trial_data <- data.frame(   age = rnorm(40, 60, 5),   score_high = rbinom(40, 1, 0.7),   trt = 0,   eventtime = rexp(40, 1 / 50),   status = 1,   enrollment = 1 # enrollment is specified here but not used in clinical cut off )  my_internal_baseline <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 0,   covariates = baseline_covariates(     names = c(\"age\", \"score\"),     means_int = c(55, 5),     means_ext = c(60, 5),     covariance_int = covariance_matrix(diag = c(5, 1)),     covariance_ext = covariance_matrix(diag = c(5, 1.2), upper_tri = c(0.1))   ),   transformations = list(score_high = binary_cutoff(\"score\", int_cutoff = 0.7, ext_cutoff = 0.7)) )  my_data_sim_setup_with_fixed <- create_data_simulation(   baseline = my_internal_baseline,   coefficients = c(age = 0.001, score_high = 1.1),   event_dist = create_event_dist(dist = \"exponential\", lambdas = 1 / 50),   fixed_external_data = historical_trial_data ) %>%   set_enrollment(     internal = enrollment_constant(rate = c(25, 10), for_time = c(4, 30)),     external = enrollment_constant(rate = c(30, 10), for_time = c(4, 30))   ) %>%   set_dropout(     internal_treated = create_event_dist(dist = \"exponential\", lambdas = 1 / 50),     internal_control = create_event_dist(dist = \"exponential\", lambdas = 1 / 55),     external_control = create_event_dist(dist = \"exponential\", lambdas = 1 / 40)   ) %>%   set_cut_off(     internal = cut_off_after_first(time = 60),     external = cut_off_after_events(n = 100)   ) my_data_sim_setup_with_fixed #> DataSimObject #> ------------- #> Baseline object: #> Baseline Data Simulation Object #>   N internal treated:  100  #>   N internal control:  50  #>   N external control:  0  #>  #> Covariates:  #> [[1]] #>  covariate means_internal means_external #>        age             55             60 #>      score              5              5 #>  #> Covariance Matrices #> Internal          External #>       age score         age score  #> age     5     0   age   5.0   0.1  #> score   0     1   score 0.1   1.2  #>  #> Transformations:  #>    score_high  #>  #> Event distribution: #> exponential distribution with lambda = 0.02  #>  #> Treatment HR:  1  #> Drift HR:  1  #>  #> Coefficients: #>        age score_high  #>      0.001      1.100  #>  #> Enrollment: #>  Internal: Enrolling patients per time at rates: 25, 25, 25, 25, 10, 10, 10, 10, 10, 10, 10, 10....  #>  External: Enrolling patients per time at rates: 30, 30, 30, 30, 10, 10, 10, 10, 10, 10, 10, 10....  #>  #> Dropout: #>  Internal treated: exponential distribution with lambda = 0.02  #>  Internal control: exponential distribution with lambda = 0.0181818181818182  #>  External control: exponential distribution with lambda = 0.025  #>  #> Clinical cut off: #>  Internal: Cut off after first enrolled patient reaches time = 60  #>  External: Cut off after 100 events  #>  #> Fixed external data: #>  Columns: age, score_high, trt, eventtime, status, enrollment, ext  #>  N: 40  # Drift is not be used for the fixed external data! generate(my_data_sim_setup_with_fixed, n = 1, treatment_hr = c(1, 1.3), drift_hr = c(1, 1.2)) #> Warning: Drift parameter is not applied to fixed external data #> SimDataList object with  4  different scenarios #>   sim_id treatment_hr drift_hr n_datasets_per_param #> 1      1          1.0      1.0                    1 #> 2      2          1.3      1.0                    1 #> 3      3          1.0      1.2                    1 #> 4      4          1.3      1.2                    1  external_data_list <- generate(my_data_sim_setup_with_fixed, n = 3, treatment_hr = c(1, 1.3), drift_hr = c(1))"},{"path":"https://genentech.github.io/psborrow2/articles/data_simulation.html","id":"combining-simulations","dir":"Articles","previous_headings":"Running a simulation","what":"Combining simulations","title":"7. Data Simulation","text":"Simulation data objects can combined simulation can run .","code":"combined_data_list <- c(my_data_list, external_data_list) combined_data_list #> SimDataList object with  6  different scenarios #>   sim_id treatment_hr drift_hr n_datasets_per_param #> 1      1          1.0      1.0                    3 #> 2      2          1.3      1.0                    3 #> 3      3          1.0      1.2                    3 #> 4      4          1.3      1.2                    3 #> 5      5          1.0      1.0                    3 #>  [ reached 'max' / getOption(\"max.print\") -- omitted 1 rows ]"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"before-you-start","dir":"Articles","previous_headings":"","what":"Before you start","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"functionality article relies Stan model fitting, specifically via CmdStan cmdstanr tools. haven’t used CmdStan ’ll need install R package external program. information can found cmdstanr installation guide. short version : Now ’re ready start psborrow2.","code":"# Install the cmdstanr package install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\"))) library(cmdstanr)  # Install the external CmdStan program check_cmdstan_toolchain() install_cmdstan(cores = 2) library(psborrow2) library(cmdstanr)"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"creating-an-analysis-object","dir":"Articles","previous_headings":"","what":"Creating an analysis object","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"BDB analysis psborrow2, need create object class Analysis contains information needed build model compile MCMC sampler using Stan. create Analysis object, call function create_analysis_obj(). Let’s look four required arguments function evaluate one---time.","code":"create_analysis_obj(   data_matrix,   outcome,   borrowing,   treatment )"},{"path":[]},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"required-elements","dir":"Articles","previous_headings":"Creating an analysis object > 1. data_matrix","what":"Required elements","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"data_matrix input one-row-per-patient numeric matrix analysis. column names matrix fixed, names columns specified outcome, treatment, borrowing sections. two columns required analyses: flag denoting receipt experimental intervention (1) (0) flag denoting whether patient part external data source (1) internal trial (0)","code":""},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"time-to-event","dir":"Articles","previous_headings":"Creating an analysis object > 1. data_matrix > Required elements","what":"Time-to-event","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"outcome time--event, two additional columns needed: duration follow-patient flag denoting whether patient censored (1) (0)","code":""},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"binary-endpoints","dir":"Articles","previous_headings":"Creating an analysis object > 1. data_matrix > Required elements","what":"Binary endpoints","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"outcome binary, one additional column needed: flag denoting whether patient event interest (1) (0)","code":""},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"covariates","dir":"Articles","previous_headings":"Creating an analysis object > 1. data_matrix > Required elements","what":"Covariates","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"Covariates may also included BDB analyses. included data matrix plan adjust . Note numeric matrices supported. See Example data creating matrix data.frame. Note missing data currently allowed, values must non-missing.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"example-data","dir":"Articles","previous_headings":"Creating an analysis object > 1. data_matrix","what":"Example data","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"using example dataset stored psborrow2 (example_matrix). starting data frame tibble, can easily create suitable matrix psborrow2 helper function create_data_matrix().","code":""},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"creating-a-data-matrix-with-create_data_matrix","dir":"Articles","previous_headings":"Creating an analysis object > 1. data_matrix > Example data","what":"Creating a data matrix with create_data_matrix()","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"","code":"# Start with data.frame diabetic_df <- survival::diabetic  # For demonstration purposes, let some patients be external controls diabetic_df$external <- ifelse(diabetic_df$trt == 0 & diabetic_df$id > 1000, 1, 0)  # Create the censor flag diabetic_df$cens <- ifelse(diabetic_df$status == 0, 1, 0)  diabetes_matrix <- create_data_matrix(   diabetic_df,   outcome = c(\"time\", \"cens\"),   trt_flag_col = \"trt\",   ext_flag_col = \"external\",   covariates = ~ age + laser + risk ) # Call `add_covariates()` with `covariates =  c(\"age\", \"laserargon\", \"risk\") `  head(diabetes_matrix) #    time cens trt external age laserargon risk # 1 46.23    1   0        0  28          1    9 # 2 46.23    1   1        0  28          1    9 # 3 42.50    1   1        0  12          0    8 # 4 31.30    0   0        0  12          0    6 # 5 42.27    1   1        0   9          0   11 # 6 42.27    1   0        0   9          0   11"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"psborrow2-example-matrix","dir":"Articles","previous_headings":"Creating an analysis object > 1. data_matrix > Example data","what":"psborrow2 example matrix","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"Let’s look first rows example matrix: column definitions : ext, 0/1, flag external controls trt, 0/1, flag treatment arm cov1, 0/1, baseline covariate cov2, 0/1, baseline covariate time, positive numeric, survival time cnsr, 0/1, censoring indicator resp, 0/1, indicator binary response outcome","code":"head(example_matrix) #      id ext trt cov4 cov3 cov2 cov1       time status cnsr resp # [1,]  1   0   0    1    1    1    0  2.4226411      1    0    1 # [2,]  2   0   0    1    1    0    1 50.0000000      0    1    1 # [3,]  3   0   0    0    0    0    1  0.9674372      1    0    1 # [4,]  4   0   0    1    1    0    1 14.5774738      1    0    1 # [5,]  5   0   0    1    1    0    0 50.0000000      0    1    0 # [6,]  6   0   0    1    1    0    1 50.0000000      0    1    0"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"outcome","dir":"Articles","previous_headings":"Creating an analysis object","what":"2. outcome","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"psborrow2 currently supports four outcomes: Time--event exponential distribution (constant hazard), created outcome_surv_exponential() Time--event Weibull distribution proportional hazards parametrization, created outcome_surv_weibull_ph() Binary endpoints Bernoulli distribution using logistic regression, created outcome_bin_logistic() Continuous endpoints normal distribution, created outcome_cont_normal() select outcome distribution want, need specify prior distribution baseline event rate, baseline_prior. case, baseline_prior log hazard rate. Let’s assume prior knowledge event rate, ’ll specify uninformative prior: prior_normal(0, 1000). example, let’s conduct time--event analysis using exponential distribution.","code":"outcome <- outcome_surv_exponential(   time_var = \"time\",   cens_var = \"cnsr\",   baseline_prior = prior_normal(0, 1000) ) outcome # Outcome object with class OutcomeSurvExponential  #  # Outcome variables: # time_var cens_var  #   \"time\"   \"cnsr\"  #  # Baseline prior: # Normal Distribution # Parameters: #  Stan  R    Value #  mu    mean    0  #  sigma sd   1000"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"borrowing","dir":"Articles","previous_headings":"Creating an analysis object","what":"3. borrowing","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"psborrow2 supports three different borrowing methods, class: borrowing: internal trial comparison without external data. Use borrowing_none() specify . Full borrowing: pooling external internal control arms. Use borrowing_full() specify . Bayesian dynamic borrowing hierarchical commensurate prior: borrowing described Hobbs et al. (2011) uses hierarchical commensurate prior. Use borrowing_hierarchical_commensurate() specify . column name external control column flag matrix also required passed ext_flag_col. Finally, dynamic borrowing , hyperprior distribution commensurability parameter must specified. hyperprior determines (along comparability outcomes internal external controls) much borrowing external control group performed. Example hyperpriors include largely uninformative inverse gamma distributions e.g., prior_gamma(alpha = .001, beta = .001) well informative distributions e.g., prior_gamma(alpha = 1, beta = .001), though distribution positive real line can used. Distributions density higher values (.e., higher precision) lead borrowing. ’ll choose uninformative gamma prior example. Note: Prior distributions outlined greater detail separate vignette, see vignette('prior_distributions', package = 'psborrow2').","code":"borrowing <- borrowing_hierarchical_commensurate(   ext_flag_col = \"ext\",   tau_prior = prior_gamma(0.001, 0.001) ) borrowing # Borrowing object using the  Bayesian dynamic borrowing with the hierarchical commensurate prior  approach #  # External control flag: ext  #  # Commensurability parameter prior: # Gamma Distribution # Parameters: #  Stan  R     Value #  alpha shape 0.001 #  beta  rate  0.001 # Constraints: <lower=0>"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"treatment","dir":"Articles","previous_headings":"Creating an analysis object","what":"3. treatment","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"Finally, treatment details outlined treatment_details(). , first specify column treatment flag trt_flag_col. addition, need specify prior effect estimate, trt_prior. ’ll use another uninformative normal distribution prior treatment effect:","code":"treatment <- treatment_details(   trt_flag_col = \"trt\",   trt_prior = prior_normal(0, 1000) ) treatment # Treatment object #  # Treatment flag column: trt  #  # Treatment effect prior: # Normal Distribution # Parameters: #  Stan  R    Value #  mu    mean    0  #  sigma sd   1000"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"application","dir":"Articles","previous_headings":"Creating an analysis object","what":"Application","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"Now thought inputs create_analysis_obj(), let’s create analysis object: Stan model compiled successfully informed us ready begin sampling. Note interested seeing Stan code generated, can use get_stan_code() function see full Stan code compiled.","code":"anls_obj <- create_analysis_obj(   data_matrix = example_matrix,   outcome = outcome,   borrowing = borrowing,   treatment = treatment,   quiet = TRUE ) get_stan_code(anls_obj) #  #   functions { #    # } #  #   data { #   int<lower=0> N; #   vector[N] trt; #   vector[N] time; # vector[N] cens; #  #   matrix[N,2] Z; #    # } #  #   parameters { # real beta_trt; #  # real<lower=0> tau; # vector[2] alpha; #  # } #  #   transformed parameters { #   real HR_trt = exp(beta_trt); # } #  #   model { #   vector[N] lp; #   vector[N] elp; #   beta_trt ~ normal(0, 1000); #   lp = Z * alpha + trt * beta_trt; # elp = exp(lp) ; #    #    #   tau ~ gamma(0.001, 0.001) ; # real sigma; # sigma = 1 / tau; # alpha[2] ~ normal(0, 1000) ; # alpha[1] ~ normal(alpha[2], sqrt(sigma)) ; #   for (i in 1:N) { #    if (cens[i] == 1) { #       target += exponential_lccdf(time[i] | elp[i] ); #    } else { #       target += exponential_lpdf(time[i] | elp[i] ); #    } # } # }"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"sampling-from-an-analysis-object","dir":"Articles","previous_headings":"","what":"Sampling from an analysis object","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"can take draws posterior distribution using function mcmc_sample(). function takes input Analysis object arguments (data argument) passed CmdStanModel objects. Note running may take minutes.","code":"results <- mcmc_sample(anls_obj,   iter_warmup = 2000,   iter_sampling = 50000,   chains = 4,   seed = 112233 )"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"summarizing-results","dir":"Articles","previous_headings":"","what":"Summarizing results","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"CmdStanMCMC object, results several methods outlined cmdstanr website. instance, can see see summary posterior distribution samples results$summary(): summary includes information several parameter estimates BDB model. may immediately clear parameters Stan model refer , psborrow2 function returns variable dictionary analysis object help interpret parameters: can also capture draws calling results$draws(), returns object class draws. draws objects common many MCMC sampling software packages allow us leverage packages posterior bayesplot. psborrow2 also function rename variables draws objects interpretable, rename_draws_covariates(). function uses variable_dictionary labels. Let’s use make results easier interpret:","code":"results$summary() # # A tibble: 6 × 10 #   variable      mean    median     sd    mad          q5      q95  rhat ess_bulk #   <chr>        <dbl>     <dbl>  <dbl>  <dbl>       <dbl>    <dbl> <dbl>    <dbl> # 1 lp__     -1618.    -1618.    1.50   1.29   -1621.      -1.62e+3  1.00   71314. # 2 beta_trt    -0.155    -0.158 0.199  0.198     -0.477    1.74e-1  1.00   85216. # 3 tau          1.21      0.506 1.92   0.693      0.00418  4.74e+0  1.00   81024. # 4 alpha[1]    -3.36     -3.35  0.161  0.161     -3.63    -3.10e+0  1.00   86029. # 5 alpha[2]    -2.40     -2.40  0.0557 0.0557    -2.49    -2.31e+0  1.00  132062. # 6 HR_trt       0.873     0.854 0.176  0.168      0.620    1.19e+0  1.00   85216. # # ℹ 1 more variable: ess_tail <dbl> variable_dictionary(anls_obj) #   Stan_variable                        Description # 1           tau         commensurability parameter # 2      alpha[1] baseline log hazard rate, internal # 3      alpha[2] baseline log hazard rate, external # 4      beta_trt                   treatment log HR # 5        HR_trt                       treatment HR draws <- results$draws() print(draws) # # A draws_array: 50000 iterations, 4 chains, and 6 variables # , , variable = lp__ #  #          chain # iteration     1     2     3     4 #         1 -1616 -1616 -1616 -1616 #         2 -1616 -1616 -1618 -1618 #         3 -1616 -1617 -1619 -1617 #         4 -1616 -1618 -1619 -1618 #         5 -1617 -1617 -1617 -1617 #  # , , variable = beta_trt #  #          chain # iteration     1      2      3      4 #         1 -0.20 -0.009 -0.022 -0.109 #         2 -0.31 -0.092 -0.167 -0.305 #         3 -0.16 -0.082  0.027  0.092 #         4 -0.24 -0.319 -0.092  0.226 #         5 -0.30 -0.081 -0.012 -0.439 #  # , , variable = tau #  #          chain # iteration    1    2    3    4 #         1 1.62 1.14 1.94 2.58 #         2 0.84 1.03 1.32 0.23 #         3 0.48 1.90 0.61 1.12 #         4 1.46 0.48 0.18 0.48 #         5 0.33 1.64 0.32 2.15 #  # , , variable = alpha[1] #  #          chain # iteration    1    2    3    4 #         1 -3.4 -3.4 -3.5 -3.4 #         2 -3.3 -3.4 -3.5 -3.4 #         3 -3.4 -3.4 -3.7 -3.5 #         4 -3.3 -3.4 -3.6 -3.6 #         5 -3.3 -3.5 -3.5 -3.2 #  # # ... with 49995 more iterations, and 2 more variables draws <- rename_draws_covariates(draws, anls_obj) summary(draws) # # A tibble: 6 × 10 #   variable          mean   median     sd    mad       q5      q95  rhat ess_bulk #   <chr>            <dbl>    <dbl>  <dbl>  <dbl>    <dbl>    <dbl> <dbl>    <dbl> # 1 lp__          -1.62e+3 -1.62e+3 1.50   1.29   -1.62e+3 -1.62e+3  1.00   71314. # 2 treatment lo… -1.55e-1 -1.58e-1 0.199  0.198  -4.77e-1  1.74e-1  1.00   85216. # 3 commensurabi…  1.21e+0  5.06e-1 1.92   0.693   4.18e-3  4.74e+0  1.00   81024. # 4 baseline log… -3.36e+0 -3.35e+0 0.161  0.161  -3.63e+0 -3.10e+0  1.00   86029. # 5 baseline log… -2.40e+0 -2.40e+0 0.0557 0.0557 -2.49e+0 -2.31e+0  1.00  132062. # 6 treatment HR   8.73e-1  8.54e-1 0.176  0.168   6.20e-1  1.19e+0  1.00   85216. # # ℹ 1 more variable: ess_tail <dbl>"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"using-bayesplot","dir":"Articles","previous_headings":"Summarizing results","what":"Using bayesplot","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"draws objects bayesplot package, can create many useful visual summary plots. can visualize marginal posterior distribution variable interested plotting histograms draws function mcmc_hist(). Let’s Hazard ratio treatment effect commensurability parameter, tau. plot chunk mcmc-hist can see plots help us understand diagnose problems MCMC sampler, trace rank plots: plot chunk mcmc-trace Many functions outlined bayesplot vignettes.","code":"bayesplot::mcmc_hist(draws, c(\"treatment HR\", \"commensurability parameter\")) bayesplot::color_scheme_set(\"mix-blue-pink\")  bayesplot::mcmc_trace(   draws[1:5000, 1:2, ], # Using a subset of draws only   pars = c(\"treatment HR\", \"commensurability parameter\"),   n_warmup = 1000 )"},{"path":"https://genentech.github.io/psborrow2/articles/dataset.html","id":"using-posterior","dir":"Articles","previous_headings":"Summarizing results","what":"Using posterior","title":"2. Conduct a hybrid control analysis on a dataset using BDB","text":"draws objects also supported posterior package, provides many tools analyzing MCMC draw data. instance, can use summarize_draws() function derive 80% credible intervals parameters: Another useful application posterior package evaluation Monte Carlo standard error quantiles variable interest: posterior contains many helpful functions, outlined vignettes.","code":"library(posterior) summarize_draws(draws, ~ quantile(.x, probs = c(0.1, 0.9))) # # A tibble: 6 × 3 #   variable                                `10%`     `90%` #   <chr>                                   <dbl>     <dbl> # 1 lp__                               -1620.     -1616.    # 2 treatment log HR                      -0.408      0.100 # 3 commensurability parameter             0.0172     3.22  # 4 baseline log hazard rate, internal    -3.57      -3.15  # 5 baseline log hazard rate, external    -2.47      -2.33  # 6 treatment HR                           0.665      1.11 vm <- extract_variable_matrix(draws, \"treatment HR\") mcse_quantile(x = vm, probs = c(0.1, 0.5, 0.9)) #  mcse_q10  mcse_q50  mcse_q90  # 0.0006465 0.0006845 0.0012300"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"simulating-trial-data","dir":"Articles","previous_headings":"","what":"Simulating trial data","title":"1. Matching and Weighting Methods","text":"specifying moments covariate distribution, simulate covariates using rcorrvar2 function SimMultiCorrData package. now simulate survival outcome data using Cox proportional hazards model (Cox 1972) hazard function \\(\\lambda(t|\\boldsymbol X, Z)\\) given \\[\\lambda(t|\\boldsymbol X, Z)=\\lambda_0(t) \\exp\\{\\boldsymbol X \\boldsymbol \\beta_{Trial} + Z \\gamma\\},\\] \\(\\lambda_0(t)=2\\) baseline hazard function assumed constant, \\(\\boldsymbol X\\) matrix baseline covariates, \\(\\boldsymbol \\beta_{Trial}\\) vector covariate effects, \\(Z\\) treatment indicator, \\(\\gamma\\) treatment effect terms log hazard ratio. survival function given \\[S(t|\\boldsymbol X, Z)=exp\\{-\\Lambda(t|\\boldsymbol X, Z)\\},\\] \\(\\Lambda(t|\\boldsymbol X, Z)=\\int_0^t\\lambda(u|\\boldsymbol X, Z)du\\). time event generated using inverse CDF method. censoring time generated independently exponential distribution rate=1/4. first 10 observations RCT data shown . censoring event rate RCT data distribution outcome time summary baseline covariates standardized mean difference treatment arms shown .","code":"#Simulating covariates trial.data <- rcorrvar2(n = n_t, k_cont = k_cont, k_cat = k_cat, k_nb = 0,                         method = \"Fleishman\",  seed=1,                         means = means_cont_tc, vars = vars_cont_tc, # if continuous variables                         skews = skews_tc, skurts = skurts_tc,                          marginal=marginal_tc, rho = rho_tc) #>  #>  Constants: Distribution  1   #>  #>  Constants: Distribution  2   #>  #>  Constants: Distribution  3   #>  #>  Constants: Distribution  4   #>  #>  Constants: Distribution  5   #>  #> Constants calculation time: 0.004 minutes  #> Intercorrelation calculation time: 0.002 minutes  #> Error loop calculation time: 0 minutes  #> Total Simulation time: 0.006 minutes trial.data <- data.frame(cbind(id=paste(\"TRIAL\",1:n_t,sep=\"\"), trial.data$continuous_variables,                          ifelse(trial.data$ordinal_variables==1,1,0))) colnames(trial.data) <- c(\"ID\", \"Age\", \"Weight\",\"Height\",\"Biomarker1\",\"Biomarker2\",\"Smoker\",                            \"Sex\", \"ECOG1\") #Simulate survival outcome using Cox proportional hazards regression model set.seed(1) u <- runif(1) lambda0 <- 2 #constant baseline hazard #Simulate treatment indicator in the trial data trial.data$group <- rbinom(n_t,1,prob=0.7) beta <- c(0.3,0.1,-0.3,-0.2,-0.12,0.3,1,-1,-0.4) times <- -log(u)/(lambda0*exp(as.matrix(trial.data[,-1])%*%beta)) #Inverse CDF method cens.time <- rexp(n_t,rate=1/4) #Censoring time from exponential distribution event <- as.numeric(times <= cens.time) #Event indicator. 0 is censored. time <- pmin(times,cens.time) #Combine trial data trial.data <- data.frame(trial.data,time,event,data=\"TRIAL\") table(trial.data$event)/nrow(trial.data)  #>  #>         0         1  #> 0.3883333 0.6116667 summary(trial.data$time) #>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  #>  0.00771  0.35048  0.89904  1.61350  2.04652 21.27313 myVars <- c(\"Age\", \"Weight\", \"Height\", \"Biomarker1\", \"Biomarker2\", \"Smoker\", \"Sex\",           \"ECOG1\")  ## Vector of categorical variables  catVars <- c(\"Smoker\", \"Sex\", \"ECOG1\", \"group\")  tab1 <- CreateTableOne(vars = myVars, strata = \"group\" , data = trial.data, factorVars = catVars) print(tab1,smd=TRUE) #>                         Stratified by group #>                          0              1              p      test SMD    #>   n                         178            422                            #>   Age (mean (SD))         54.82 (4.00)   55.08 (3.83)   0.451       0.067 #>   Weight (mean (SD))     150.18 (3.02)  149.92 (3.24)   0.357       0.084 #>   Height (mean (SD))      65.30 (2.39)   64.88 (2.49)   0.056       0.173 #>   Biomarker1 (mean (SD))  35.26 (2.38)   34.89 (2.16)   0.066       0.161 #>   Biomarker2 (mean (SD))  50.21 (2.52)   49.91 (2.43)   0.181       0.119 #>   Smoker = 1 (%)             32 (18.0)      87 (20.6)   0.530       0.067 #>   Sex = 1 (%)               132 (74.2)     344 (81.5)   0.054       0.178 #>   ECOG1 = 1 (%)              44 (24.7)     139 (32.9)   0.057       0.182"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"simulating-external-control-data","dir":"Articles","previous_headings":"","what":"Simulating external control data","title":"1. Matching and Weighting Methods","text":"set covariates \\(X\\) simulated external control data RCT. means, variances continuous variables proportion categorical variables modified external controls compared RCT according code . generating mechanism used RCT data used simulate survival time external controls. first 10 observations external control data shown . censoring event rate trial data distribution outcome time ","code":"means_cont_ec <- c(55+2,150-2,65-2,35+2,50-2) #Vector of means of continuous variables vars_cont_ec <- c(14,10,5,5,5) marginal_ec = list(0.3,0.7,0.4) ext.cont.data <- rcorrvar2(n = n_ec, k_cont = k_cont, k_cat = k_cat, k_nb = 0,                         method = \"Fleishman\",  seed=3,                         means = means_cont_ec, vars = vars_cont_ec, # if continuous variables                         skews = skews_tc, skurts = skurts_tc,                          marginal=marginal_ec, rho = rho_tc) #>  #>  Constants: Distribution  1   #>  #>  Constants: Distribution  2   #>  #>  Constants: Distribution  3   #>  #>  Constants: Distribution  4   #>  #>  Constants: Distribution  5   #>  #> Constants calculation time: 0.003 minutes  #> Intercorrelation calculation time: 0.001 minutes  #> Error loop calculation time: 0 minutes  #> Total Simulation time: 0.005 minutes ext.cont.data <- data.frame(cbind(id=paste(\"EC\",1:n_ec,sep=\"\"), ext.cont.data$continuous_variables,                          ifelse(ext.cont.data$ordinal_variables==1,1,0))) colnames(ext.cont.data) <- c(\"ID\", \"Age\", \"Weight\",\"Height\",\"Biomarker1\",\"Biomarker2\",\"Smoker\", \"Sex\", \"ECOG1\") #Simulate survival outcome using Cox proportional hazards regression model set.seed(1111) u <- runif(1) lambda0 <- 6 #constant baseline hazard beta <- c(-0.27,-0.1,0.3,0.2,0.1,-0.31,-1,1) times <- -log(u)/(lambda0*exp(as.matrix(ext.cont.data[,-1])%*%beta)) #Inverse CDF method cens.time <- rexp(n_ec,rate=3) #Censoring time from exponential distribution event <- as.numeric(times <= cens.time) #Event indicator. 0 is censored. time <- pmin(times,cens.time)  #Simulate treatment indicator in the trial data group <- 0  ext.cont.data <- data.frame(ext.cont.data,group,time,event,data=\"EC\") knitr::kable(head(ext.cont.data, 10)) table(ext.cont.data$event)/nrow(ext.cont.data)  #>  #>     0     1  #> 0.328 0.672 summary(ext.cont.data$time) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.  #> 0.0000166 0.0211811 0.0542664 0.0995427 0.1207454 1.2824912"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"merging-trial-and-external-control-data","dir":"Articles","previous_headings":"","what":"Merging trial and external control data","title":"1. Matching and Weighting Methods","text":"can use bind_rows function merge two datasets. using function, make sure column names variables consistent two datasets. Now, merge two datasets. examine standardized mean difference covariates RCT external control data conducting matching/weighting. Note strata=\"data\" following code. Note standardized mean difference covariates large. Next, conduct matching/weighting approach reduce difference baseline characteristics. also examine standardized mean difference covariates treated control patients conducting matching/weighting. Note strata=\"group\" following code.","code":"names(ext.cont.data) #>  [1] \"ID\"         \"Age\"        \"Weight\"     \"Height\"     \"Biomarker1\" #>  [6] \"Biomarker2\" \"Smoker\"     \"Sex\"        \"ECOG1\"      \"group\"      #> [11] \"time\"       \"event\"      \"data\" names(trial.data) #>  [1] \"ID\"         \"Age\"        \"Weight\"     \"Height\"     \"Biomarker1\" #>  [6] \"Biomarker2\" \"Smoker\"     \"Sex\"        \"ECOG1\"      \"group\"      #> [11] \"time\"       \"event\"      \"data\" #MS I recommend adding a statement that forces the colnames to be the same, like names(ex.cont.data)[1:10]=names(trial.data)[1:10] final.data <- data.frame(bind_rows(trial.data,ext.cont.data)) knitr::kable(head(final.data, 10)) knitr::kable(tail(final.data, 10)) tab2 <- CreateTableOne(vars = myVars, strata = \"data\" , data = final.data, factorVars = catVars) print(tab2,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                         500            600                            #>   Age (mean (SD))         57.00 (3.72)   55.00 (3.88)  <0.001       0.526 #>   Weight (mean (SD))     148.00 (3.15)  150.00 (3.17)  <0.001       0.633 #>   Height (mean (SD))      63.00 (2.23)   65.00 (2.47)  <0.001       0.850 #>   Biomarker1 (mean (SD))  37.00 (2.24)   35.00 (2.24)  <0.001       0.894 #>   Biomarker2 (mean (SD))  48.00 (2.23)   50.00 (2.46)  <0.001       0.853 #>   Smoker = 1 (%)            145 (29.0)     119 (19.8)   0.001       0.215 #>   Sex = 1 (%)               355 (71.0)     476 (79.3)   0.002       0.194 #>   ECOG1 = 1 (%)             195 (39.0)     183 (30.5)   0.004       0.179 tab2 <- CreateTableOne(vars = myVars, strata = \"group\" , data = final.data, factorVars = catVars) print(tab2,smd=TRUE) #>                         Stratified by group #>                          0              1              p      test SMD    #>   n                         678            422                            #>   Age (mean (SD))         56.43 (3.91)   55.08 (3.83)  <0.001       0.348 #>   Weight (mean (SD))     148.57 (3.26)  149.92 (3.24)  <0.001       0.416 #>   Height (mean (SD))      63.60 (2.49)   64.88 (2.49)  <0.001       0.511 #>   Biomarker1 (mean (SD))  36.54 (2.40)   34.89 (2.16)  <0.001       0.723 #>   Biomarker2 (mean (SD))  48.58 (2.50)   49.91 (2.43)  <0.001       0.541 #>   Smoker = 1 (%)            177 (26.1)      87 (20.6)   0.045       0.130 #>   Sex = 1 (%)               487 (71.8)     344 (81.5)  <0.001       0.231 #>   ECOG1 = 1 (%)             239 (35.3)     139 (32.9)   0.472       0.049"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"propensity-scores-overlap","dir":"Articles","previous_headings":"","what":"Propensity scores overlap","title":"1. Matching and Weighting Methods","text":"applying matching/weighting methods, investigate overlapping propensity scores. overlapping coefficient \\(0.19\\) indicating small overlap. plot chunk unnamed-chunk-28","code":"final.data$indicator <- ifelse(final.data$data==\"TRIAL\",1,0) ps.logit <- glm(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                             Sex +ECOG1, data = final.data,                             family=binomial) psfit=predict(ps.logit,type = \"response\",data=final.data)  ps_trial <- psfit[final.data$indicator==1]  ps_extcont <- psfit[final.data$indicator==0] overlap(list(ps_trial=ps_trial, ps_extcont=ps_extcont),plot=TRUE) #> $OV #> [1] 0.3875297"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"matching-methods","dir":"Articles","previous_headings":"","what":"Matching Methods","title":"1. Matching and Weighting Methods","text":"explore several matching methods balance balance baseline characteristics subjects RCT external control data. 1:1 Nearest Neighbor Propensity score matching caliper width 0.2 standard deviation logit propensity score (PSML) 1:1 Nearest Neighbor Propensity score matching caliper width 0.2 standard deviation raw propensity score (PSMR) Genetic matching replacement (GM) 1:1 Genetic matching without replacement (GMW) 1:1 Optimal matching (OM) matching methods can conducted using MatchIt package. matching conducted RCT subjects external control subjects. Hence, introduce variable named indicator final.data represent data source indicator.","code":"final.data$indicator <- ifelse(final.data$data==\"TRIAL\",1,0)"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"psml","dir":"Articles","previous_headings":"Matching Methods","what":"PSML","title":"1. Matching and Weighting Methods","text":"matching method variation nearest neighbour greedy matching selects matches based difference logit propensity score, certain distance (caliper) (Austin 2011). selected caliper width 0.2 standard deviation logit propensity score, propensity score estimated using logistic regression. now compare SMD two datasets.","code":"m.out.nearest.ratio1.caliper.lps <- matchit(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                                                         Sex +ECOG1, estimand=\"ATT\",data = final.data,                                                          method=\"nearest\",ratio=1,caliper=0.20,                                                         distance=\"glm\",link=\"linear.logit\",replace=FALSE,                                                         m.order=\"largest\") #> Warning: Fewer control units than treated units; not all treated units will get #> a match. summary(m.out.nearest.ratio1.caliper.lps) #>  #> Call: #> matchit(formula = indicator ~ Age + Weight + Height + Biomarker1 +  #>     Biomarker2 + Smoker + Sex + ECOG1, data = final.data, method = \"nearest\",  #>     distance = \"glm\", link = \"linear.logit\", estimand = \"ATT\",  #>     replace = FALSE, m.order = \"largest\", caliper = 0.2, ratio = 1) #>  #> Summary of Balance for All Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          2.0386       -1.6416          1.8769     1.0922    0.4123 #> Age              55.0001       56.9985         -0.5151     1.0883    0.1497 #> Weight          150.0006      147.9990          0.6306     1.0170    0.1673 #> Height           65.0010       62.9998          0.8104     1.2222    0.2232 #> Biomarker1       34.9998       36.9999         -0.8948     0.9984    0.2397 #> Biomarker2       50.0003       47.9994          0.8138     1.2180    0.2254 #> Smoker            0.1983        0.2900         -0.2299          .    0.0917 #> Sex               0.7933        0.7100          0.2058          .    0.0833 #> ECOG1             0.3050        0.3900         -0.1846          .    0.0850 #>            eCDF Max #> distance     0.6657 #> Age          0.2277 #> Weight       0.2493 #> Height       0.3247 #> Biomarker1   0.3717 #> Biomarker2   0.3463 #> Smoker       0.0917 #> Sex          0.0833 #> ECOG1        0.0850 #>  #> Summary of Balance for Matched Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.3084       -0.0768          0.1964     1.2651    0.0495 #> Age              55.9994       56.1273         -0.0330     1.2535    0.0200 #> Weight          149.0622      148.8328          0.0723     0.9531    0.0202 #> Height           63.9366       63.8937          0.0174     0.9519    0.0195 #> Biomarker1       35.8765       36.2704         -0.1762     1.1409    0.0574 #> Biomarker2       49.0364       48.8589          0.0722     1.0945    0.0225 #> Smoker            0.2455        0.2277          0.0448          .    0.0179 #> Sex               0.7857        0.7723          0.0331          .    0.0134 #> ECOG1             0.3304        0.3348         -0.0097          .    0.0045 #>            eCDF Max Std. Pair Dist. #> distance     0.1786          0.1973 #> Age          0.0491          1.1372 #> Weight       0.0536          1.1005 #> Height       0.0625          0.9848 #> Biomarker1   0.1473          1.0799 #> Biomarker2   0.0536          0.9051 #> Smoker       0.0179          0.9628 #> Sex          0.0134          0.8489 #> ECOG1        0.0045          0.9987 #>  #> Sample Sizes: #>           Control Treated #> All           500     600 #> Matched       224     224 #> Unmatched     276     376 #> Discarded       0       0 final.data$ratio1_caliper_weights_lps = m.out.nearest.ratio1.caliper.lps$weights svy <- svydesign(id = ~0, data=final.data,weights = ~ratio1_caliper_weights_lps) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      224.00         224.00                            #>   Age (mean (SD))         56.13 (3.63)   56.00 (4.06)   0.725       0.033 #>   Weight (mean (SD))     148.83 (3.14)  149.06 (3.07)   0.434       0.074 #>   Height (mean (SD))      63.89 (2.14)   63.94 (2.08)   0.829       0.020 #>   Biomarker1 (mean (SD))  36.27 (2.10)   35.88 (2.25)   0.056       0.181 #>   Biomarker2 (mean (SD))  48.86 (2.12)   49.04 (2.21)   0.385       0.082 #>   Smoker = 1 (%)           51.0 (22.8)    55.0 (24.6)   0.657       0.042 #>   Sex = 1 (%)             173.0 (77.2)   176.0 (78.6)   0.733       0.032 #>   ECOG1 = 1 (%)            75.0 (33.5)    74.0 (33.0)   0.920       0.009"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"psmr","dir":"Articles","previous_headings":"Matching Methods","what":"PSMR","title":"1. Matching and Weighting Methods","text":"matching method similar PSML except caliper width 0.2 based standard deviation propensity score scale (Stuart et al. 2011). now compare SMD two datasets.","code":"m.out.nearest.ratio1.caliper <- matchit(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                                                     Sex +ECOG1, estimand=\"ATT\",data = final.data,                                                      method = \"nearest\",  ratio = 1, caliper=0.2, replace=FALSE) #> Warning: Fewer control units than treated units; not all treated units will get #> a match. summary(m.out.nearest.ratio1.caliper) #>  #> Call: #> matchit(formula = indicator ~ Age + Weight + Height + Biomarker1 +  #>     Biomarker2 + Smoker + Sex + ECOG1, data = final.data, method = \"nearest\",  #>     estimand = \"ATT\", replace = FALSE, caliper = 0.2, ratio = 1) #>  #> Summary of Balance for All Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.7827        0.2608          2.1517     0.8827    0.4123 #> Age              55.0001       56.9985         -0.5151     1.0883    0.1497 #> Weight          150.0006      147.9990          0.6306     1.0170    0.1673 #> Height           65.0010       62.9998          0.8104     1.2222    0.2232 #> Biomarker1       34.9998       36.9999         -0.8948     0.9984    0.2397 #> Biomarker2       50.0003       47.9994          0.8138     1.2180    0.2254 #> Smoker            0.1983        0.2900         -0.2299          .    0.0917 #> Sex               0.7933        0.7100          0.2058          .    0.0833 #> ECOG1             0.3050        0.3900         -0.1846          .    0.0850 #>            eCDF Max #> distance     0.6657 #> Age          0.2277 #> Weight       0.2493 #> Height       0.3247 #> Biomarker1   0.3717 #> Biomarker2   0.3463 #> Smoker       0.0917 #> Sex          0.0833 #> ECOG1        0.0850 #>  #> Summary of Balance for Matched Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.5431        0.5011          0.1731     1.2229    0.0367 #> Age              56.0260       56.1310         -0.0271     1.1311    0.0181 #> Weight          148.9502      148.8880          0.0196     0.9491    0.0181 #> Height           64.1172       63.9245          0.0781     1.1794    0.0170 #> Biomarker1       35.9585       36.1764         -0.0975     1.1896    0.0426 #> Biomarker2       49.2512       48.9165          0.1361     1.4438    0.0344 #> Smoker            0.2266        0.2365         -0.0247          .    0.0099 #> Sex               0.7734        0.7734          0.0000          .    0.0000 #> ECOG1             0.3251        0.3498         -0.0535          .    0.0246 #>            eCDF Max Std. Pair Dist. #> distance     0.1133          0.1743 #> Age          0.0443          1.1398 #> Weight       0.0640          1.0586 #> Height       0.0443          1.0077 #> Biomarker1   0.1182          0.9965 #> Biomarker2   0.0739          0.9127 #> Smoker       0.0099          0.9883 #> Sex          0.0000          0.3448 #> ECOG1        0.0246          0.9950 #>  #> Sample Sizes: #>           Control Treated #> All           500     600 #> Matched       203     203 #> Unmatched     297     397 #> Discarded       0       0 final.data$ratio1_caliper_weights = m.out.nearest.ratio1.caliper$weights svy <- svydesign(id = ~0, data=final.data,weights = ~ratio1_caliper_weights) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      203.00         203.00                            #>   Age (mean (SD))         56.13 (3.63)   56.03 (3.86)   0.777       0.028 #>   Weight (mean (SD))     148.89 (3.15)  148.95 (3.07)   0.840       0.020 #>   Height (mean (SD))      63.92 (2.15)   64.12 (2.34)   0.387       0.086 #>   Biomarker1 (mean (SD))  36.18 (2.07)   35.96 (2.26)   0.312       0.100 #>   Biomarker2 (mean (SD))  48.92 (2.07)   49.25 (2.49)   0.141       0.146 #>   Smoker = 1 (%)           48.0 (23.6)    46.0 (22.7)   0.814       0.023 #>   Sex = 1 (%)             157.0 (77.3)   157.0 (77.3)   1.000      <0.001 #>   ECOG1 = 1 (%)            71.0 (35.0)    66.0 (32.5)   0.600       0.052"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"gm","dir":"Articles","previous_headings":"Matching Methods","what":"GM","title":"1. Matching and Weighting Methods","text":"Genetic matching form nearest neighbor matching distances computed using generalized Mahalanobis distance, generalization Mahalanobis distance scaling factor covariate represents importance covariate distance. genetic algorithm used select scaling factors. Matching done replacement, external control can matched one patient treatment arm. Weighting used maintain sample size treated arm (Sekhon 2008). treated unit \\(\\) control unit \\(j\\), genetic matching uses generalized Mahalanobis distance \\[\\delta_{GMD}(\\mathbf{x}_i,\\mathbf{x}_j, \\mathbf{W})=\\sqrt{(\\mathbf{x}_i - \\mathbf{x}_j)'(\\mathbf{S}^{-1/2})'\\mathbf{W}(\\mathbf{S}^{-1/2})(\\mathbf{x}_i - \\mathbf{x}_j)}\\] \\(\\mathbf{x}\\) \\(p \\times 1\\) vector containing value \\(p\\) included covariates unit, \\(\\mathbf{S}^{-1/2}\\) Cholesky decomposition covariance matrix \\(\\mathbf{S}\\) covariates, \\(\\mathbf{W}\\) diagonal matrix scaling factors \\(w\\) diagonal (Greifer 2020). \\[   \\begin{pmatrix}     w_1 & 0 & \\dots & 0 \\\\     0 & w_2 & \\dots & 0 \\\\     \\vdots & \\vdots & \\ddots & \\vdots \\\\     0 & 0 & \\dots & w_p   \\end{pmatrix} \\] \\(w_k=1\\) \\(k\\) distance standard Mahalanobis distance. However, genetic matching estimates optimal \\(w_k\\)s. default maximize smallest p-value among balance tests covariates matched sample (Kolmogorov-Smirnov tests t-tests covariate) (Greifer 2020). now compare SMD two datasets.","code":"m.out.genetic.ratio1 <- matchit(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                                             Sex +ECOG1 ,replace=TRUE, estimand=\"ATT\",                                              data = final.data, method = \"genetic\",                                               ratio = 1,pop.size=200)  summary(m.out.genetic.ratio1) #>  #> Call: #> matchit(formula = indicator ~ Age + Weight + Height + Biomarker1 +  #>     Biomarker2 + Smoker + Sex + ECOG1, data = final.data, method = \"genetic\",  #>     estimand = \"ATT\", replace = TRUE, ratio = 1, pop.size = 200) #>  #> Summary of Balance for All Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.7827        0.2608          2.1517     0.8827    0.4123 #> Age              55.0001       56.9985         -0.5151     1.0883    0.1497 #> Weight          150.0006      147.9990          0.6306     1.0170    0.1673 #> Height           65.0010       62.9998          0.8104     1.2222    0.2232 #> Biomarker1       34.9998       36.9999         -0.8948     0.9984    0.2397 #> Biomarker2       50.0003       47.9994          0.8138     1.2180    0.2254 #> Smoker            0.1983        0.2900         -0.2299          .    0.0917 #> Sex               0.7933        0.7100          0.2058          .    0.0833 #> ECOG1             0.3050        0.3900         -0.1846          .    0.0850 #>            eCDF Max #> distance     0.6657 #> Age          0.2277 #> Weight       0.2493 #> Height       0.3247 #> Biomarker1   0.3717 #> Biomarker2   0.3463 #> Smoker       0.0917 #> Sex          0.0833 #> ECOG1        0.0850 #>  #> Summary of Balance for Matched Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.7827        0.7618          0.0860     1.0260    0.0379 #> Age              55.0001       55.1101         -0.0283     1.1784    0.0342 #> Weight          150.0006      149.3077          0.2183     1.2776    0.0561 #> Height           65.0010       64.9209          0.0324     1.1642    0.0145 #> Biomarker1       34.9998       35.3957         -0.1771     1.2578    0.0414 #> Biomarker2       50.0003       49.7966          0.0829     1.4752    0.0245 #> Smoker            0.1983        0.1933          0.0125          .    0.0050 #> Sex               0.7933        0.7933          0.0000          .    0.0000 #> ECOG1             0.3050        0.2483          0.1231          .    0.0567 #>            eCDF Max Std. Pair Dist. #> distance     0.1950          0.1920 #> Age          0.0917          0.9201 #> Weight       0.1367          1.0483 #> Height       0.0683          0.1557 #> Biomarker1   0.1400          0.8230 #> Biomarker2   0.1150          0.6582 #> Smoker       0.0050          0.0125 #> Sex          0.0000          0.0000 #> ECOG1        0.0567          0.7747 #>  #> Sample Sizes: #>               Control Treated #> All            500.       600 #> Matched (ESS)   43.22     600 #> Matched        151.       600 #> Unmatched      349.         0 #> Discarded        0.         0 final.data$genetic_ratio1_weights = m.out.genetic.ratio1$weights svy <- svydesign(id = ~0, data=final.data,weights = ~genetic_ratio1_weights) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      151.00         600.00                            #>   Age (mean (SD))         55.11 (3.54)   55.00 (3.88)   0.830       0.030 #>   Weight (mean (SD))     149.31 (2.78)  150.00 (3.17)   0.111       0.232 #>   Height (mean (SD))      64.92 (2.27)   65.00 (2.47)   0.815       0.034 #>   Biomarker1 (mean (SD))  35.40 (1.98)   35.00 (2.24)   0.122       0.188 #>   Biomarker2 (mean (SD))  49.80 (2.01)   50.00 (2.46)   0.506       0.091 #>   Smoker = 1 (%)           29.2 (19.3)   119.0 (19.8)   0.924       0.013 #>   Sex = 1 (%)             119.8 (79.3)   476.0 (79.3)   1.000      <0.001 #>   ECOG1 = 1 (%)            37.5 (24.8)   183.0 (30.5)   0.346       0.127"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"gmw","dir":"Articles","previous_headings":"Matching Methods","what":"GMW","title":"1. Matching and Weighting Methods","text":"now consider genetic matching without replacement. now compare SMD two datasets.","code":"m.out.genetic.ratio1 <- matchit(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                                             Sex +ECOG1 ,replace=FALSE, estimand=\"ATT\",                                              data = final.data, method = \"genetic\",                                               ratio = 1,pop.size=200) #> Warning: Fewer control units than treated units; not all treated units will get #> a match.  summary(m.out.genetic.ratio1) #>  #> Call: #> matchit(formula = indicator ~ Age + Weight + Height + Biomarker1 +  #>     Biomarker2 + Smoker + Sex + ECOG1, data = final.data, method = \"genetic\",  #>     estimand = \"ATT\", replace = FALSE, ratio = 1, pop.size = 200) #>  #> Summary of Balance for All Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.7827        0.2608          2.1517     0.8827    0.4123 #> Age              55.0001       56.9985         -0.5151     1.0883    0.1497 #> Weight          150.0006      147.9990          0.6306     1.0170    0.1673 #> Height           65.0010       62.9998          0.8104     1.2222    0.2232 #> Biomarker1       34.9998       36.9999         -0.8948     0.9984    0.2397 #> Biomarker2       50.0003       47.9994          0.8138     1.2180    0.2254 #> Smoker            0.1983        0.2900         -0.2299          .    0.0917 #> Sex               0.7933        0.7100          0.2058          .    0.0833 #> ECOG1             0.3050        0.3900         -0.1846          .    0.0850 #>            eCDF Max #> distance     0.6657 #> Age          0.2277 #> Weight       0.2493 #> Height       0.3247 #> Biomarker1   0.3717 #> Biomarker2   0.3463 #> Smoker       0.0917 #> Sex          0.0833 #> ECOG1        0.0850 #>  #> Summary of Balance for Matched Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.8753        0.2608          2.5336     0.2211    0.4823 #> Age              54.7088       56.9985         -0.5902     1.0304    0.1701 #> Weight          150.3086      147.9990          0.7276     0.9875    0.1960 #> Height           65.3230       62.9998          0.9408     1.2096    0.2597 #> Biomarker1       34.6396       36.9999         -1.0560     0.8539    0.2828 #> Biomarker2       50.2868       47.9994          0.9304     1.1739    0.2579 #> Smoker            0.1880        0.2900         -0.2558          .    0.1020 #> Sex               0.8060        0.7100          0.2371          .    0.0960 #> ECOG1             0.2920        0.3900         -0.2129          .    0.0980 #>            eCDF Max Std. Pair Dist. #> distance      0.832          2.5336 #> Age           0.260          0.7405 #> Weight        0.292          0.7796 #> Height        0.382          0.9666 #> Biomarker1    0.434          1.0763 #> Biomarker2    0.398          0.9554 #> Smoker        0.102          0.6169 #> Sex           0.096          0.5433 #> ECOG1         0.098          0.4822 #>  #> Sample Sizes: #>           Control Treated #> All           500     600 #> Matched       500     500 #> Unmatched       0     100 #> Discarded       0       0 final.data$genetic_ratio1_weights_no_replace = m.out.genetic.ratio1$weights svy <- svydesign(id = ~0, data=final.data,weights = ~genetic_ratio1_weights_no_replace) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      500.00         500.00                            #>   Age (mean (SD))         57.00 (3.72)   54.71 (3.78)  <0.001       0.611 #>   Weight (mean (SD))     148.00 (3.15)  150.31 (3.13)  <0.001       0.736 #>   Height (mean (SD))      63.00 (2.23)   65.32 (2.46)  <0.001       0.989 #>   Biomarker1 (mean (SD))  37.00 (2.24)   34.64 (2.07)  <0.001       1.096 #>   Biomarker2 (mean (SD))  48.00 (2.23)   50.29 (2.41)  <0.001       0.985 #>   Smoker = 1 (%)          145.0 (29.0)    94.0 (18.8)  <0.001       0.241 #>   Sex = 1 (%)             355.0 (71.0)   403.0 (80.6)  <0.001       0.226 #>   ECOG1 = 1 (%)           195.0 (39.0)   146.0 (29.2)   0.001       0.208"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"om","dir":"Articles","previous_headings":"Matching Methods","what":"OM","title":"1. Matching and Weighting Methods","text":"optimal matching algorithm performs global minimization propensity score distance RCT subjects matched external controls (Harris Horst 2016). criterion used sum absolute pair distances matched sample. Optimal pair matching nearest neighbor matching often yield similar matched samples research indicated optimal pair matching much better nearest neighbor matching yielding balanced matched samples (Greifer 2020). now compare SMD two datasets.","code":"m.out.optimal.ratio1 <- matchit(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                                             Sex +ECOG1 , estimand=\"ATT\",                                              data = final.data, method = \"optimal\",                                               ratio = 1) #> Warning: Fewer control units than treated units; not all treated units will get #> a match.  summary(m.out.optimal.ratio1) #>  #> Call: #> matchit(formula = indicator ~ Age + Weight + Height + Biomarker1 +  #>     Biomarker2 + Smoker + Sex + ECOG1, data = final.data, method = \"optimal\",  #>     estimand = \"ATT\", ratio = 1) #>  #> Summary of Balance for All Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.7827        0.2608          2.1517     0.8827    0.4123 #> Age              55.0001       56.9985         -0.5151     1.0883    0.1497 #> Weight          150.0006      147.9990          0.6306     1.0170    0.1673 #> Height           65.0010       62.9998          0.8104     1.2222    0.2232 #> Biomarker1       34.9998       36.9999         -0.8948     0.9984    0.2397 #> Biomarker2       50.0003       47.9994          0.8138     1.2180    0.2254 #> Smoker            0.1983        0.2900         -0.2299          .    0.0917 #> Sex               0.7933        0.7100          0.2058          .    0.0833 #> ECOG1             0.3050        0.3900         -0.1846          .    0.0850 #>            eCDF Max #> distance     0.6657 #> Age          0.2277 #> Weight       0.2493 #> Height       0.3247 #> Biomarker1   0.3717 #> Biomarker2   0.3463 #> Smoker       0.0917 #> Sex          0.0833 #> ECOG1        0.0850 #>  #> Summary of Balance for Matched Data: #>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance          0.7410        0.2608          1.9801     0.9032    0.3589 #> Age              55.3043       56.9985         -0.4367     1.1079    0.1263 #> Weight          149.7031      147.9990          0.5369     0.9493    0.1424 #> Height           64.6469       62.9998          0.6670     1.0524    0.1886 #> Biomarker1       35.2375       36.9999         -0.7885     0.9722    0.2114 #> Biomarker2       49.5934       47.9994          0.6483     1.0178    0.1862 #> Smoker            0.2020        0.2900         -0.2207          .    0.0880 #> Sex               0.7760        0.7100          0.1630          .    0.0660 #> ECOG1             0.3360        0.3900         -0.1173          .    0.0540 #>            eCDF Max Std. Pair Dist. #> distance      0.632          1.9801 #> Age           0.192          1.0969 #> Weight        0.220          1.1664 #> Height        0.286          1.1544 #> Biomarker1    0.342          1.2647 #> Biomarker2    0.296          1.1523 #> Smoker        0.088          0.9129 #> Sex           0.066          0.8940 #> ECOG1         0.054          1.1077 #>  #> Sample Sizes: #>           Control Treated #> All           500     600 #> Matched       500     500 #> Unmatched       0     100 #> Discarded       0       0 final.data$optimal_ratio1_weights = m.out.optimal.ratio1$weights svy <- svydesign(id = ~0, data=final.data,weights = ~optimal_ratio1_weights) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      500.00         500.00                            #>   Age (mean (SD))         57.00 (3.72)   55.30 (3.91)  <0.001       0.444 #>   Weight (mean (SD))     148.00 (3.15)  149.70 (3.07)  <0.001       0.548 #>   Height (mean (SD))      63.00 (2.23)   64.65 (2.29)  <0.001       0.728 #>   Biomarker1 (mean (SD))  37.00 (2.24)   35.24 (2.21)  <0.001       0.793 #>   Biomarker2 (mean (SD))  48.00 (2.23)   49.59 (2.25)  <0.001       0.712 #>   Smoker = 1 (%)          145.0 (29.0)   101.0 (20.2)   0.001       0.205 #>   Sex = 1 (%)             355.0 (71.0)   388.0 (77.6)   0.017       0.151 #>   ECOG1 = 1 (%)           195.0 (39.0)   168.0 (33.6)   0.076       0.112"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"weighting-methods","dir":"Articles","previous_headings":"","what":"Weighting Methods","title":"1. Matching and Weighting Methods","text":"also explore several weighting approaches. Propensity score weighting based gradient boosted model (GBM) Entropy balancing weighting (EB) Inverse probability treatment weighting (IPW)","code":""},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"gbm","dir":"Articles","previous_headings":"Weighting Methods","what":"GBM","title":"1. Matching and Weighting Methods","text":"GBM (Gradient Boosting Machine) machine learning method generates predicted values flexible regression model. can adjust large number covariates. estimation involves iterative process multiple regression trees capture complex non-linear relationships. One useful features GBM estimating propensity score iterative estimation procedure can tuned find propensity score model leading best balance treated control groups, balance refers similarity different groups propensity score weighted distributions pretreatment covariates (McCaffrey et al. 2013). now compare SMD two datasets.","code":"set.seed(1)   # Toolkit for Weighting and Analysis of Nonequivalent Groups # https://cran.r-project.org/web/packages/twang/vignettes/twang.pdf  # Model includes non-linear effects and interactions with shrinkage to  # avoid overfitting                                                        ps.AOD.ATT <- ps(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                              Sex +ECOG1, data = final.data,                              estimand = \"ATT\", interaction.depth=3,                               shrinkage=0.01, verbose = FALSE, n.trees = 7000,                               stop.method = c(\"es.mean\",\"ks.max\"))  # interaction.dept is the tree depth used in gradient boosting; loosely interpreted as  # the maximum number of variables that can be included in an interaction  # n.trees is the maximum number of gradient boosting iterations to be considered. The # more iterations allows for more nonlienarity and interactions to be considered.  # shrinkage is a numeric value between 0 and 1 denoting the learning rate. Smaller  # values restrict the complexity that is added at each iteration of the gradient  # boosting algorithm. A smaller learning rate requires more iterations (n.trees), but  # adds some protection against model overfit. The default value is 0.01.  # windows() # plot(ps.AOD.ATT, plot=5) #  # summary(ps.AOD.ATT) #  # # Relative influence # summary(ps.AOD.ATT$gbm.obj, n.trees=ps.AOD.ATT$desc$ks.max.ATT$n.trees, plot=FALSE) #  # bal.table(ps.AOD.ATT)  final.data$weights_gbm <- ps.AOD.ATT$w[,1] svy <- svydesign(id = ~0, data=final.data,weights = ~weights_gbm) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      284.19         600.00                            #>   Age (mean (SD))         54.93 (4.03)   55.00 (3.88)   0.902       0.018 #>   Weight (mean (SD))     148.84 (2.69)  150.00 (3.17)  <0.001       0.394 #>   Height (mean (SD))      64.27 (2.11)   65.00 (2.47)   0.002       0.317 #>   Biomarker1 (mean (SD))  35.61 (2.01)   35.00 (2.24)   0.002       0.285 #>   Biomarker2 (mean (SD))  49.57 (2.11)   50.00 (2.46)   0.081       0.188 #>   Smoker = 1 (%)           70.0 (24.6)   119.0 (19.8)   0.338       0.116 #>   Sex = 1 (%)             222.6 (78.3)   476.0 (79.3)   0.816       0.025 #>   ECOG1 = 1 (%)            85.7 (30.2)   183.0 (30.5)   0.950       0.007"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"eb","dir":"Articles","previous_headings":"Weighting Methods","what":"EB","title":"1. Matching and Weighting Methods","text":"Entropy balancing weighting method balance covariates assigning scalar weight external control observations reweighted groups satisfy set balance constraints imposed sample moments covariate distributions (Hainmueller 2012). Note entropy balancing method failed converge. now compare SMD two datasets. definition, SMD EB zero.","code":"eb.out <- ebalance(final.data$indicator,final.data[,c(2:9)],max.iterations = 300) #> Converged within tolerance final.data$eb_weights <- rep(1,nrow(final.data)) final.data$eb_weights[final.data$indicator==0] <- eb.out$w eb.out$converged #> [1] TRUE svy <- svydesign(id = ~0, data=final.data,weights = ~eb_weights) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      600.00         600.00                            #>   Age (mean (SD))         55.00 (3.68)   55.00 (3.88)   1.000      <0.001 #>   Weight (mean (SD))     150.00 (2.82)  150.00 (3.17)   1.000      <0.001 #>   Height (mean (SD))      65.00 (2.15)   65.00 (2.47)   1.000      <0.001 #>   Biomarker1 (mean (SD))  35.00 (1.49)   35.00 (2.24)   1.000      <0.001 #>   Biomarker2 (mean (SD))  50.00 (1.91)   50.00 (2.46)   1.000      <0.001 #>   Smoker = 1 (%)          119.0 (19.8)   119.0 (19.8)   1.000      <0.001 #>   Sex = 1 (%)             476.0 (79.3)   476.0 (79.3)   1.000      <0.001 #>   ECOG1 = 1 (%)           183.0 (30.5)   183.0 (30.5)   1.000      <0.001"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"ipw","dir":"Articles","previous_headings":"Weighting Methods","what":"IPW","title":"1. Matching and Weighting Methods","text":"propensity score defined probability patient trial given observed baseline covariates. utilized ATT weights, defined IPW fixing trial patients weight unity, external control patients \\(\\hat{e}(x)/(1-\\hat{e}(x))\\) \\(\\hat{e}(x)\\) estimated using logistic regression model (Amusa, Zewotir, North 2019). now compare SMD two datasets. Next investigate balance plots.","code":"ps.logit <- glm(indicator ~ Age + Weight + Height + Biomarker1  + Biomarker2 + Smoker +                             Sex +ECOG1, data = final.data,                             family=binomial) psfit=predict(ps.logit,type = \"response\",data=final.data)  ps_trial <- psfit[final.data$indicator==1]  ps_extcont <- psfit[final.data$indicator==0]  final.data$invprob_weights <- NA final.data$invprob_weights[final.data$indicator==0] <- ps_extcont/(1-ps_extcont) final.data$invprob_weights[final.data$indicator==1] <- ps_trial/ps_trial svy <- svydesign(id = ~0, data=final.data,weights = ~invprob_weights) t1 <- svyCreateTableOne(vars = myVars, strata = \"data\" , data = svy, factorVars = catVars) print(t1,smd=TRUE) #>                         Stratified by data #>                          EC             TRIAL          p      test SMD    #>   n                      522.38         600.00                            #>   Age (mean (SD))         54.44 (4.03)   55.00 (3.88)   0.458       0.141 #>   Weight (mean (SD))     148.92 (2.76)  150.00 (3.17)   0.002       0.364 #>   Height (mean (SD))      64.65 (2.26)   65.00 (2.47)   0.311       0.147 #>   Biomarker1 (mean (SD))  35.38 (1.80)   35.00 (2.24)   0.077       0.185 #>   Biomarker2 (mean (SD))  49.83 (2.11)   50.00 (2.46)   0.589       0.076 #>   Smoker = 1 (%)           90.5 (17.3)   119.0 (19.8)   0.568       0.064 #>   Sex = 1 (%)             419.5 (80.3)   476.0 (79.3)   0.849       0.024 #>   ECOG1 = 1 (%)           121.3 (23.2)   183.0 (30.5)   0.158       0.165 covs <- data.frame(final.data[,c(\"Age\",\"Weight\",\"Height\",\"Biomarker1\",\"Biomarker2\",\"Smoker\",\"Sex\",\"ECOG1\")]) data_with_weights <- final.data"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"balance-plots-for-matching-methods","dir":"Articles","previous_headings":"","what":"Balance Plots for Matching Methods","title":"1. Matching and Weighting Methods","text":"now conduct balance diagnostic considering SMD plot. x-axis plot represent absolute value SMD y-axis represent list covariates. SMD greater \\(0.1\\) can considered sign imbalance (Zhang et al. 2019). Hence, put threshold \\(0.1\\) plot vertical dashed line. plot chunk unnamed-chunk-61","code":"love.plot(covs,            treat=data_with_weights$data,           weights = list(NNMPS=data_with_weights$ratio1_caliper_weights,                          NNMLPS=data_with_weights$ratio1_caliper_weights_lps,                          OPTM=data_with_weights$optimal_ratio1_weights,                          GENMATCH=data_with_weights$genetic_ratio1_weights,                          GENMATCHW=data_with_weights$genetic_ratio1_weights_no_replace),           thresholds=0.1 ,binary=\"std\",shapes = c(\"circle filled\"),           line=FALSE,estimand=\"ATT\",abs=TRUE,           sample.names = c(\"PSMR\",                             \"PSML\",                             \"OM\",                            \"GM\",                            \"GMW\"),           title=\"Covariate Balance after matching methods\",           s.d.denom=\"pooled\")"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"balance-plots-for-weighting-methods","dir":"Articles","previous_headings":"","what":"Balance Plots for Weighting Methods","title":"1. Matching and Weighting Methods","text":"plot chunk unnamed-chunk-62 now investigate effective sample size (ESS) trial external control cohort. Note: applying matching methods, patients RCT excluded. demonstration purpose article, also exclude RCT patients matched Bayesian outcome model. However, reality may keep full sample size RCT discounting done second stage power prior commensurate prior. , moving next stage Bayesian borrowing, ESS also needs taken account. ESS cohort using different methods shown . also investigate histogram weights external control patients effective sample size (ESS). plot chunk unnamed-chunk-67","code":"love.plot(covs,            treat=data_with_weights$data,           weights = list(EB=data_with_weights$eb_weights,                          IPW=data_with_weights$invprob_weights,                          GBM=data_with_weights$weights_gbm),           thresholds=0.1 ,binary=\"std\",shapes = c(\"circle filled\"),           line=FALSE,estimand=\"ATT\",abs=TRUE,           sample.names = c(\"EB\",                             \"IPW\",                             \"GBM\"),           title=\"Covariate Balance after weighting methods\",           s.d.denom=\"pooled\") #External control ess.PSML.extcont <- (sum(data_with_weights$ratio1_caliper_weights_lps[data_with_weights$indicator==0]))^2/                      sum((data_with_weights$ratio1_caliper_weights_lps[data_with_weights$indicator==0])^2)  ess.PSMR.extcont <- (sum(data_with_weights$ratio1_caliper_weights[data_with_weights$indicator==0]))^2/                     sum((data_with_weights$ratio1_caliper_weights[data_with_weights$indicator==0])^2)  ess.OM.extcont <- (sum(data_with_weights$optimal_ratio1_weights[data_with_weights$indicator==0]))^2/                   sum((data_with_weights$optimal_ratio1_weights[data_with_weights$indicator==0])^2)  ess.GM.extcont <- (sum(data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==0]))^2/                   sum((data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==0])^2)  ess.eb.extcont <- (sum(data_with_weights$eb_weights[data_with_weights$indicator==0]))^2/                   sum((data_with_weights$eb_weights[data_with_weights$indicator==0])^2)  ess.ipw.extcont <- (sum(data_with_weights$invprob_weights[data_with_weights$indicator==0]))^2/                    sum((data_with_weights$invprob_weights[data_with_weights$indicator==0])^2)  ess.gbm.extcont <- (sum(data_with_weights$weights_gbm[data_with_weights$indicator==0]))^2/                    sum((data_with_weights$weights_gbm[data_with_weights$indicator==0])^2)  ess.genetic.extcont <- (sum(data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==0]))^2/                        sum((data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==0])^2)  ess.genetic.no.replace.extcont <- (sum(data_with_weights$genetic_ratio1_weights_no_replace[data_with_weights$indicator==0]))^2/                        sum((data_with_weights$genetic_ratio1_weights_no_replace[data_with_weights$indicator==0])^2) #Trial ess.PSML.trial <- (sum(data_with_weights$ratio1_caliper_weights_lps[data_with_weights$indicator==1]))^2/                   sum((data_with_weights$ratio1_caliper_weights_lps[data_with_weights$indicator==1])^2)  ess.PSMR.trial <- (sum(data_with_weights$ratio1_caliper_weights[data_with_weights$indicator==1]))^2/                   sum((data_with_weights$ratio1_caliper_weights[data_with_weights$indicator==1])^2)  ess.OM.trial <- (sum(data_with_weights$optimal_ratio1_weights[data_with_weights$indicator==1]))^2/                 sum((data_with_weights$optimal_ratio1_weights[data_with_weights$indicator==1])^2)  ess.GM.trial <- (sum(data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==1]))^2/                 sum((data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==1])^2)  ess.eb.trial <- (sum(data_with_weights$eb_weights[data_with_weights$indicator==1]))^2/                 sum((data_with_weights$eb_weights[data_with_weights$indicator==1])^2)  ess.ipw.trial <- (sum(data_with_weights$invprob_weights[data_with_weights$indicator==1]))^2/                  sum((data_with_weights$invprob_weights[data_with_weights$indicator==1])^2)  ess.gbm.trial <- (sum(data_with_weights$weights_gbm[data_with_weights$indicator==1]))^2/                  sum((data_with_weights$weights_gbm[data_with_weights$indicator==1])^2)  ess.genetic.trial <- (sum(data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==1]))^2/                      sum((data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==1])^2) ess.genetic.no.replace.trial <- (sum(data_with_weights$genetic_ratio1_weights_no_replace[data_with_weights$indicator==1]))^2/                      sum((data_with_weights$genetic_ratio1_weights_no_replace[data_with_weights$indicator==1])^2) out.ess <- data.frame(Unadjusted=c(length(which(final.data$data==\"TRIAL\")),length(which(final.data$data==\"EC\"))),            PSML=c(ess.PSML.trial,ess.PSML.extcont),            PSMR=c(ess.PSMR.trial,ess.PSMR.extcont),            OM=c(ess.OM.trial,ess.OM.extcont),            GM=c(ess.genetic.trial,ess.genetic.extcont),            GMW=c(ess.genetic.no.replace.trial,ess.genetic.no.replace.extcont),            EB=c(ess.eb.trial,ess.eb.extcont),            IPW=c(ess.ipw.trial,ess.ipw.extcont),            GBM=c(ess.gbm.trial,ess.gbm.extcont))  rownames(out.ess) <- c(\"Trial\",\"External Control\") out.ess #>                  Unadjusted PSML PSMR  OM        GM GMW        EB       IPW #> Trial                   600  224  203 500 600.00000 500 600.00000 600.00000 #> External Control        500  224  203 500  43.21729 500  27.69881  43.69827 #>                        GBM #> Trial            600.00000 #> External Control  73.21273 par(mfrow=c(2,2)) hist(data_with_weights$eb_weights[data_with_weights$indicator==0],main=paste(\"EB \\n ESS=\",round(ess.eb.extcont),sep=\"\"),xlab=\"Weight\") hist(data_with_weights$invprob_weights[data_with_weights$indicator==0],main=paste(\"IPW\\n ESS=\",round(ess.ipw.extcont),sep=\"\"),xlab=\"Weight\") hist(data_with_weights$weights_gbm[data_with_weights$indicator==0],main=paste(\"GBM \\n ESS=\",round(ess.gbm.extcont),sep=\"\"),xlab=\"Weight\") hist(data_with_weights$genetic_ratio1_weights[data_with_weights$indicator==0],main=paste(\"GM \\n ESS=\",round(ess.genetic.extcont),sep=\"\"),xlab=\"Weight\")"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_01_methods.html","id":"selection-of-matchingweighting-methods","dir":"Articles","previous_headings":"","what":"Selection of matching/weighting methods","title":"1. Matching and Weighting Methods","text":"Based standardized difference mean plot, PSML, PSMR, GM can methods selection. terms ESS, PSML highest sample size \\(215\\) trial external control data.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"hazard-function","dir":"Articles","previous_headings":"","what":"Hazard function","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"hazard function \\(T\\) time \\(t\\) defined instantaneous rate event occurence still risk time \\(t\\). defined \\[\\begin{equation}   h(t)=\\lim_\\limits{\\Delta \\rightarrow 0 } P\\frac{(t\\leq T<t+\\Delta t|T\\geq t)}{\\Delta t}=\\frac{f(t)}{S(t)}, \\end{equation}\\] \\(f(t)\\) density function \\(T\\) given \\(\\theta\\), \\(S(t)=P(T>t)\\) survival function \\(T\\).","code":""},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"cox-proportional-hazards-model","dir":"Articles","previous_headings":"","what":"Cox proportional hazards model","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"start Cox proportional hazards model (Cox 1972) observation \\(\\) follows. estimate regression coefficients Bayesian framework, baseline hazard function needs specified. case Frequentist Cox regression. hazard time \\(t\\) \\[\\begin{equation} \\label{eq:coxmodel}   \\lambda(t|\\boldsymbol{X}_i,Z_i)=\\lambda_0(t|\\alpha) \\exp(\\gamma Z_i +\\beta^T \\boldsymbol{X}_i), \\end{equation}\\] \\(\\boldsymbol{X}_i\\) vector baseline covariates \\(Z_i\\) treatment indicator.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"baseline-hazard-function","dir":"Articles","previous_headings":"","what":"Baseline hazard function","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"Baseline hazard functions can modeled using common probability distributions survival analysis, exponential, Weibull, Gompertz. However, standard specifications limited flexibility capture irregular behaviors. Alternatively, flexible hazard shapes can specified using piecewise constant, piecewise exponential spline functions, allowing representation multimodal patterns accommodating diverse irregularities (Lázaro, Armero, Alvares 2021). misspecification baseline hazard can lead loss important model details can challenging accurately estimate outcomes interest, probabilities survival curves. article, consider following baseline hazard functions. \\(\\lambda_0(t|\\alpha)=exp(\\alpha)\\) \\(\\lambda_0(t|\\zeta,\\mu)=\\alpha t\\mu^{\\zeta -1} \\exp(-\\mu t^\\zeta)\\) shape parameter \\(\\zeta\\) scale parameter \\(\\mu\\). \\(\\lambda_0(t|\\alpha_1,...,\\alpha_K)=exp(\\alpha_k)\\) \\(t \\(s_{k-1},s_k],\\) \\((s_{k-1},s_k]\\) \\(k^{th}\\) interval \\(K\\) total number pre-specified intervals Murray et al. (2014). example , consider \\(s_k=(100*k/K)^{th}\\) percentile event times treated group.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"likelihood","dir":"Articles","previous_headings":"","what":"Likelihood","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"now introduce likelihood along weight \\(w_i\\) subject specific weight. purpose demonstration, considered subject specific weight inverse probability treatment weighting method estimating ATT. words, \\(w_i=1\\) subject \\(\\) RCT \\(0 \\leq w_i \\leq 1\\) subject \\(\\) RWD. Let \\({Y}_{}\\) observed time, \\({\\delta}_{}\\) event indicator, \\(\\boldsymbol{X}_{}\\) covariates, \\({Z}_{}\\) treatment indicator trial data. Similarly, let \\({Y}_{0,}\\) observed time, \\({\\delta}_{0,}\\) event indicator, \\(\\boldsymbol{X}_{0,}\\) covariates \\({Z}_{0,}\\) treatment indicator external control data. time axis partitioned \\(K\\) intervals: \\((0,\\kappa_1],(\\kappa_1,\\kappa_2],\\ldots,(\\kappa_{K-1},\\kappa_K)\\). Let \\(\\lambda_0(t|\\alpha_k)=\\exp{(\\alpha_k)}\\) piecewise exponential baseline hazard function \\(t \\I_k=(\\kappa_{k-1},\\kappa_k)\\) \\(k=1,\\ldots,K\\). Denote \\(\\boldsymbol{\\alpha}=(\\alpha_1,\\ldots,\\alpha_K)^\\intercal\\). Let \\(\\boldsymbol\\beta\\) \\(\\gamma\\) covariate treatment effects respectively trial. Similarly, let \\(\\boldsymbol{\\beta}_0\\) \\(\\boldsymbol{\\alpha}_0\\) represent parameters external control. joint likelihood trial external control right censored observations taking account weight \\(w_i\\) baseline hazard piecewise exponential function \\(K\\) intervals can written slightly extending Murray et al. (2014) \\[ \\begin{equation}         \\small         \\begin{split}              & L(\\boldsymbol{\\alpha},\\boldsymbol{\\beta},\\boldsymbol{\\gamma},\\boldsymbol{\\alpha}_0,\\boldsymbol{\\beta}_0 |\\boldsymbol{D},\\boldsymbol{D}_0 )   \\\\ & =  L(\\boldsymbol{\\alpha},\\boldsymbol{\\beta},\\boldsymbol{\\gamma}|\\boldsymbol{D},\\boldsymbol \\mu) L(\\boldsymbol{\\alpha}_0,\\boldsymbol{\\beta}_0|\\boldsymbol{D}_0) \\\\             & =\\prod_{=1}^n  \\prod_{k=1}^K \\Bigg[\\exp{\\bigg\\{\\mathcal (Y_{} \\I_k)\\mathcal S_{ik}\\bigg\\}}^{\\delta_{}}             \\exp\\bigg\\{-\\mathcal (Y_{} \\I_k) \\bigg( \\sum_{\\ell=1}^{k-1} (\\kappa_\\ell  -  \\kappa_{\\ell-1}) \\\\             & \\times \\exp{(\\mathcal S_{\\ell})}              + (Y_{} - \\kappa_{k-1}) \\exp{(\\mathcal S_{ik}) } \\bigg) \\bigg\\} \\Bigg]              \\Bigg[ \\exp{\\bigg\\{\\mathcal (Y_{0,} \\I_k)  \\mathcal S_{0,ik} \\bigg\\} }^{\\delta_{0,}} \\\\           & \\times \\exp\\bigg\\{-\\mathcal (Y_{0,} \\I_k)             \\bigg( \\sum_{\\ell=1}^{k-1} (\\kappa_\\ell - \\kappa_{\\ell-1})\\exp{(\\mathcal S_{0,\\ell})}              + (Y_{0,} - \\kappa_{k-1})\\\\              & \\times \\exp{(\\mathcal S_{0,ik}) } \\bigg)  \\bigg\\} \\Bigg],         \\end{split}     \\end{equation}     \\] \\(\\mathcal S_{0,ik}=\\alpha_{0,k} + \\boldsymbol{\\beta}_0^\\intercal \\boldsymbol{X}_{0,}\\), \\(\\mathcal S_{ik}=\\alpha_{k} + \\boldsymbol{\\beta}^\\intercal \\boldsymbol{X}_{} + {\\gamma} {Z}_{}\\), \\(n=n_T+n_E\\); \\(n_T\\) \\(n_E\\) sample size trial external control data respectively. \\(w_i=1\\), likelihood becomes traditional likelihood Cox proportional hazards model. notations similar Khanal (2022). joint likelihood can also constructed similar way baseline hazard functions.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"power-prior-model","dir":"Articles","previous_headings":"","what":"Power prior model","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"denote data randomized controlled trial (RCT) \\(D_1\\) corresponding likelihood \\(L(\\gamma,\\beta,\\alpha│D_1 )\\) external control (EC) data \\(D_0\\) corresponding likelihood \\(L(\\gamma,\\beta,\\alpha│D_0)\\). formulation power prior (Ibrahim et al. 2015) \\[p(\\gamma,\\beta,\\alpha│D_0,ν) \\propto L(\\gamma,\\beta,\\alpha│D_0 )^ν  *p(\\gamma)*p(\\beta)*p(\\alpha),\\] \\(0 \\leq ν \\leq 1\\) vector subject specific weights EC data, \\(p(\\gamma)\\), \\(p(\\beta)\\), \\(p(\\alpha)\\) priors \\(\\gamma\\), \\(\\beta\\) \\(\\alpha\\) respectively. posterior distribution \\[p(\\beta│D_1,D_0,ν) \\propto L(\\gamma,\\beta,\\alpha│D_1 )  L(\\gamma,\\beta,\\alpha│D_0 )^ν  *p(\\gamma)*p(\\beta)*p(\\alpha).\\] consider non-informative prior distributions parameters \\(\\gamma \\sim N(0,0.001)\\), \\(\\beta_j \\sim N(0,0.001)\\) \\(j=1...,P\\) \\(P\\) baseline covariates, \\(\\alpha_k \\sim N(0,0.001)\\) \\(k=1,...,K\\) intervals. Note: avoid confusion, \\(N(,b)\\) means normal distribution mean \\(\\) precision \\(b\\).","code":""},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"commensurate-prior-model","dir":"Articles","previous_headings":"","what":"Commensurate prior model","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"Let \\(\\boldsymbol{\\eta}=(\\beta_1,...,\\beta_P,\\alpha_1,...,\\alpha_K)\\) \\(\\boldsymbol{\\eta}_0=(\\beta_{10},...,\\beta_{P0},\\alpha_{10},...,\\alpha_{K0})\\) parameter vector RCT RWD respectively. consider following commensurate prior \\[\\eta_\\ell|\\eta_{0,\\ell},\\tau_\\ell \\sim N(\\eta_{\\ell 0},\\tau_\\ell) \\quad \\quad \\ell=1,\\cdots,P+K,\\] \\(\\tau_\\ell\\) precision parameter determines degree borrowing, \\(P\\) total number covariates \\(K\\) total number intervals. precision parameter, assign gamma prior \\(\\tau_\\ell \\sim Gamma(0.01,0.01)\\).","code":""},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"conducting-analysis","dir":"Articles","previous_headings":"","what":"Conducting Analysis","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"first load following libraries.","code":"#Loading the libraries library(R2jags) library(psborrow2) library(cmdstanr) library(posterior) library(bayesplot) library(kableExtra) library(survival)"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"example-data","dir":"Articles","previous_headings":"Conducting Analysis","what":"Example data","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"also load data set data_with_weights. Age (years) Weight (lbs) Height (inches) Biomarker1 Biomarker2 Smoker: Yes = 1 = 0 Sex: Male = 1 Female = 0 ECOG1: ECOG 1 = 1 ECOG 0 = 0 group: group = 1 treatment group = 0 placebo time event: event = 1 represents event occurred event = 0 indicates event censored indicator: indicator=1 RCT data indicator=0 EC data ratio1_caliper_weights_lps: Weights 1:1 Nearest Neighbor Propensity score matching caliper width 0.2 standard deviation logit propensity score ratio_caliper_weights: Weights 1:1 Nearest Neighbor Propensity score matching caliper width 0.2 standard deviation raw propensity score genetic_ratio1_weights: Weights 1:1 Genetic matching replacement genetic_ratio1_weights_no_replace: Weights 1:1 Genetic matching without replacement optimal_ratio1_weights: Weights 1:1 Optimal matching weights_gbm: Weights (ATT) using Generalized Boosted Model estimate propensity score eb_weights: Weights (ATT) Entropy Balancing invprob_weights: Weights (ATT) Inverse Probability Treatment Weighting using logistic regression first six observations data set shown .","code":"data_with_weights <- read.csv(\"data_with_weights.csv\") data_with_weights$cnsr <- 1 - data_with_weights$event data_with_weights <- data_with_weights[, sapply(data_with_weights, class) %in% c(\"numeric\", \"integer\")] data_with_weights$ext <- 1 - data_with_weights$indicator #External control flag data_with_weights$norm.weights=data_with_weights$invprob_weights data_with_weights$norm.weights[data_with_weights$ext==1]=data_with_weights$norm.weights[data_with_weights$ext==1]/max(data_with_weights$norm.weights[data_with_weights$ext==1]) data_with_weights <- as.matrix(data_with_weights) head(data_with_weights) #>           Age   Weight   Height Biomarker1 Biomarker2 Smoker Sex ECOG1 group #> [1,] 55.51419 148.5092 65.63899   33.71898   55.26178      0   1     0     1 #> [2,] 49.93326 146.9441 63.44883   35.65828   45.50928      1   1     1     1 #> [3,] 58.51588 153.5435 70.53193   35.53710   55.89283      0   1     0     0 #> [4,] 48.61226 147.2873 64.10615   31.17663   55.80523      0   1     0     1 #> [5,] 51.84943 151.0312 62.16361   33.99677   48.01981      0   1     0     0 #> [6,] 51.81743 148.1115 68.69766   33.82398   47.32652      1   1     0     0 #>           time event indicator ratio1_caliper_weights_lps #> [1,] 0.4089043     0         1                          0 #> [2,] 0.9721405     0         1                          1 #> [3,] 0.2956919     0         1                          0 #> [4,] 4.3111823     0         1                          0 #> [5,] 0.2644848     0         1                          0 #> [6,] 0.3103544     0         1                          0 #>      ratio1_caliper_weights genetic_ratio1_weights #> [1,]                      0                      1 #> [2,]                      1                      1 #> [3,]                      0                      1 #> [4,]                      1                      1 #> [5,]                      0                      1 #> [6,]                      0                      1 #>      genetic_ratio1_weights_no_replace optimal_ratio1_weights weights_gbm #> [1,]                                 1                      0           1 #> [2,]                                 0                      1           1 #> [3,]                                 1                      0           1 #> [4,]                                 1                      0           1 #> [5,]                                 1                      1           1 #> [6,]                                 1                      1           1 #>      eb_weights invprob_weights cnsr ext norm.weights #> [1,]          1               1    1   0            1 #> [2,]          1               1    1   0            1 #> [3,]          1               1    1   0            1 #> [4,]          1               1    1   0            1 #> [5,]          1               1    1   0            1 #> [6,]          1               1    1   0            1"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"exponential-distribution-with-constant-hazard-with-gamma-prior-distribution-using-psborrow2-r-package","dir":"Articles","previous_headings":"","what":"Exponential distribution with constant hazard with gamma prior distribution (Using psborrow2 R package)","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"psborrow2 package used conduct analysis. use exponential distribution outcome model follows. Non-informative normal prior used baseline parameter. data data_with_weights contain time censoring variable. demonstration purpose, choose subject level weight invprob_weights calculated using inverse probability treatment weighting (IPTW). step extract time, censoring indicator normalized weight variables denoted time, cnsr norm.weights respectively. Next, borrowing method implemented shown . consider Bayesian Dynamic Borrowing (BDB) gamma prior assigned commensurability parameter. tau_prior shown hyperparameter commensurate prior determines degree borrowing. assign gamma prior hyperparameter. Furhtermore, also need specify flag external data denoted ext. Similarly, details regarding treatment variable specified . Non-informative prior used treatment effect parameter \\(\\gamma\\). Now, pieces brought together create analysis object shown . Finally, run MCMC sample \\(10,000\\) iterations \\(3\\) chains. summary shown . histogram posterior samples hazard ratio commensurability parameter shown . plot chunk unnamed-chunk-10 plot chunk unnamed-chunk-10 \\(95\\%\\) credible interval can calculated follows. can graph plots help us evaluate convergence diagnose problems MCMC sampler, trace plot. plot chunk unnamed-chunk-12","code":"#Outcome outcome <- outcome_surv_exponential(   time_var = \"time\",   cens_var = \"cnsr\",   baseline_prior = prior_normal(0, 1000),   weight_var = \"norm.weights\" )  outcome #> Outcome object with class OutcomeSurvExponential  #>  #> Outcome variables: #>       time_var       cens_var     weight_var  #>         \"time\"         \"cnsr\" \"norm.weights\"  #>  #> Baseline prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000 #Borrowing borrowing <- borrowing_hierarchical_commensurate(   ext_flag_col = \"ext\",   tau_prior = prior_gamma(0.001, 0.001) )  borrowing #> Borrowing object using the  Bayesian dynamic borrowing with the hierarchical commensurate prior  approach #>  #> External control flag: ext  #>  #> Commensurability parameter prior: #> Gamma Distribution #> Parameters: #>  Stan  R     Value #>  alpha shape 0.001 #>  beta  rate  0.001 #> Constraints: <lower=0> #Treatment treatment <- treatment_details(   trt_flag_col = \"group\",   trt_prior = prior_normal(0, 1000) ) treatment #> Treatment object #>  #> Treatment flag column: group  #>  #> Treatment effect prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000 #Application anls_obj <- create_analysis_obj(   data_matrix = data_with_weights,   outcome = outcome,   borrowing = borrowing,   treatment = treatment ) #> Inputs look good. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`. niter = 10000 results.exp.psborrow<- mcmc_sample(anls_obj,   iter_warmup = round(niter/3),   iter_sampling = niter,   chains = 3,   seed = 123 ) #> Running MCMC with 3 sequential chains... #>  #> Chain 1 finished in 11.5 seconds. #> Chain 2 finished in 13.0 seconds. #> Chain 3 finished in 13.1 seconds. #>  #> All 3 chains finished successfully. #> Mean chain execution time: 12.5 seconds. #> Total execution time: 38.0 seconds.  draws1 <- results.exp.psborrow$draws() draws1 <- rename_draws_covariates(draws1, anls_obj) results.exp.psborrow$summary() #> # A tibble: 6 × 10 #>   variable      mean    median     sd    mad          q5      q95  rhat ess_bulk #>   <chr>        <dbl>     <dbl>  <dbl>  <dbl>       <dbl>    <dbl> <dbl>    <dbl> #> 1 lp__     -709.     -709.     1.50   1.30   -712.       -707.     1.00   10252. #> 2 beta_trt   -0.0370   -0.0373 0.117  0.117    -0.230       0.157  1.00   12902. #> 3 tau         0.0838    0.0370 0.122  0.0506    0.000343    0.326  1.00   12113. #> 4 alpha[1]   -0.945    -0.943  0.0992 0.0996   -1.11       -0.784  1.00   12636. #> 5 alpha[2]    2.56      2.58   0.316  0.314     2.01        3.05   1.00   18595. #> 6 HR_trt      0.970     0.963  0.114  0.113     0.795       1.17   1.00   12902. #> # ℹ 1 more variable: ess_tail <dbl> bayesplot::mcmc_hist(draws1, c(\"treatment HR\")) bayesplot::mcmc_hist(draws1, c(\"commensurability parameter\")) bayesplot::color_scheme_set(\"mix-blue-pink\") summarize_draws(draws1, ~ quantile(.x, probs = c(0.025, 0.975))) #> # A tibble: 6 × 3 #>   variable                                 `2.5%`  `97.5%` #>   <chr>                                     <dbl>    <dbl> #> 1 lp__                               -713.        -707.    #> 2 treatment log HR                     -0.266        0.195 #> 3 commensurability parameter            0.0000886    0.428 #> 4 baseline log hazard rate, internal   -1.14        -0.754 #> 5 baseline log hazard rate, external    1.90         3.14  #> 6 treatment HR                          0.767        1.21 bayesplot::color_scheme_set(\"mix-blue-pink\")  bayesplot::mcmc_trace(   draws1[1:(round(niter/2)), 1:2, ], # Using a subset of draws only   pars = c(\"treatment HR\", \"commensurability parameter\"),   n_warmup = niter/10 )"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"time-to-event-analysis-with-weibull-distribution-and-proportional-hazards-parametrization","dir":"Articles","previous_headings":"","what":"Time-to-event analysis with Weibull distribution and proportional hazards parametrization","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"conduct analysis using Weibull distribution outcome model using psborrow2 package follows. Non-informative normal prior used baseline parameter \\(\\mu\\). exponential prior used Weibull shape parameter \\(\\zeta\\). Next, borrowing method implemented shown . consider Bayesian Dynamic Borrowing (BDB) non-informative gamma prior assigned commensurability parameter. Similarly, details regarding treatment variable specified . Non-informative prior used treatment effect \\(\\gamma\\). Now, pieces brought together create analysis object shown . Finally, run MCMC sample \\(10,000\\) iterations \\(3\\) chains. summary shown . Histogram posterior samples hazard ratio commensurability parameter produced. plot chunk unnamed-chunk-19 plot chunk unnamed-chunk-19 \\(95\\%\\) credible interval can calculated follows. can see plots help us evaluate convergence diagnose problems MCMC sampler, trace plot. plot chunk unnamed-chunk-21","code":"#Outcome outcome <- outcome_surv_weibull_ph(   time_var = \"time\",   cens_var = \"cnsr\",   shape_prior=prior_exponential(1),   baseline_prior = prior_normal(0, 1000),   weight_var = \"norm.weights\" )  outcome #> Outcome object with class OutcomeSurvWeibullPH  #>  #> Outcome variables: #>       time_var       cens_var     weight_var  #>         \"time\"         \"cnsr\" \"norm.weights\"  #>  #> Baseline prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000  #>  #> shape_weibull prior: #> Exponential Distribution #> Parameters: #>  Stan R    Value #>  beta rate 1     #> Constraints: <lower=0> #Borrowing borrowing <- borrowing_hierarchical_commensurate(   ext_flag_col = \"ext\",   tau_prior = prior_gamma(0.001, 0.001) )  borrowing #> Borrowing object using the  Bayesian dynamic borrowing with the hierarchical commensurate prior  approach #>  #> External control flag: ext  #>  #> Commensurability parameter prior: #> Gamma Distribution #> Parameters: #>  Stan  R     Value #>  alpha shape 0.001 #>  beta  rate  0.001 #> Constraints: <lower=0> #Treatment treatment <- treatment_details(   trt_flag_col = \"group\",   trt_prior = prior_normal(0, 1000) ) treatment #> Treatment object #>  #> Treatment flag column: group  #>  #> Treatment effect prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000 #Application data_with_weights <- as.matrix(data_with_weights) anls_obj <- create_analysis_obj(   data_matrix = data_with_weights,   outcome = outcome,   borrowing = borrowing,   treatment = treatment ) #> Inputs look good. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`. results.weib.psborrow<- mcmc_sample(anls_obj,   iter_warmup = round(niter/3),   iter_sampling = niter,   chains = 3,   seed = 123 ) #> Running MCMC with 3 sequential chains... #>  #> Chain 1 finished in 29.2 seconds. #> Chain 2 finished in 33.2 seconds. #> Chain 3 finished in 29.7 seconds. #>  #> All 3 chains finished successfully. #> Mean chain execution time: 30.7 seconds. #> Total execution time: 92.5 seconds.  draws2 <- results.weib.psborrow$draws() draws2 <- rename_draws_covariates(draws2, anls_obj) results.weib.psborrow$summary() #> # A tibble: 7 × 10 #>   variable          mean   median     sd    mad       q5      q95  rhat ess_bulk #>   <chr>            <dbl>    <dbl>  <dbl>  <dbl>    <dbl>    <dbl> <dbl>    <dbl> #> 1 lp__          -6.96e+2 -6.96e+2 1.63   1.48   -6.99e+2 -694.     1.00   11832. #> 2 beta_trt      -2.84e-2 -2.87e-2 0.117  0.118  -2.20e-1    0.166  1.00   16067. #> 3 shape_weibull  8.19e-1  8.18e-1 0.0324 0.0324  7.67e-1    0.873  1.00   20840. #> 4 tau            1.23e-1  5.50e-2 0.179  0.0750  5.65e-4    0.474  1.00   15655. #> 5 alpha[1]      -7.76e-1 -7.75e-1 0.103  0.104  -9.49e-1   -0.611  1.00   16026. #> 6 alpha[2]       2.14e+0  2.15e+0 0.326  0.325   1.58e+0    2.65   1.00   21336. #> 7 HR_trt         9.79e-1  9.72e-1 0.116  0.115   8.03e-1    1.18   1.00   16067. #> # ℹ 1 more variable: ess_tail <dbl> bayesplot::mcmc_hist(draws2, c(\"treatment HR\")) bayesplot::mcmc_hist(draws2, c(\"commensurability parameter\")) bayesplot::color_scheme_set(\"mix-blue-pink\") summarize_draws(draws2, ~ quantile(.x, probs = c(0.025, 0.975))) #> # A tibble: 7 × 3 #>   variable                                `2.5%`  `97.5%` #>   <chr>                                    <dbl>    <dbl> #> 1 lp__                               -700.       -694.    #> 2 treatment log HR                     -0.254       0.203 #> 3 Weibull shape parameter               0.757       0.884 #> 4 commensurability parameter            0.000142    0.617 #> 5 baseline log hazard rate, internal   -0.981      -0.582 #> 6 baseline log hazard rate, external    1.46        2.74  #> 7 treatment HR                          0.776       1.22 bayesplot::color_scheme_set(\"mix-blue-pink\")  bayesplot::mcmc_trace(   draws2[1:(round(niter/2)), 1:2, ], # Using a subset of draws only   pars = c(\"treatment HR\", \"commensurability parameter\"),   n_warmup = round(niter/10) )"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"power-prior-with-piecewise-exponential-distribution-not-implemented-in-psborrow2-r-package","dir":"Articles","previous_headings":"","what":"Power prior with piecewise exponential distribution (not implemented in psborrow2 R package)","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"consider Bayesian power prior subject specific power parameters. weights various matching weighting methods can used subject specific power parameters external control subjects. baseline hazard function based piecewise exponential distribution. following JAGS code, adapted (Alvares et al. 2021), implements power prior piecewise exponential baseline hazard. consider subject specific power parameter weights inverse probability weighting method. subject specific weights external control patients normalized dividing weight maximum weight. now define variables input JAGS. also need pre-specify number intervals. simplicity, consider \\(K=1\\) interval. However, method also works \\(K>1\\). now put variables list data inputs JAGs. specify parameter interest follows. standard normal distribution used initial values parameter interest. Now, call jags function conduct MCMC sampling \\(3\\) chains shown . set number iterations \\(niter=10,000\\) burn \\(5000\\) thinning \\(10\\). summary can produced using following command. summary hazard ratio treatment variable shown . histogram treatment hazard ratio can also produced. plot chunk unnamed-chunk-31 traceplot can generated follows. plot chunk unnamed-chunk-32 plot chunk unnamed-chunk-32","code":"model{         #POWER PRIOR JAGS CODE   #Trial Data   for (i in 1:n){     # Pieces of the cumulative hazard function     for (k in 1:int.obs[i]) {       cond[i,k] <- step(time[i] - a[k + 1])       HH[i , k] <- cond[i,k] * (a[k + 1] - a[k]) * exp(alpha[k]) +       (1 - cond[i,k] ) * (time[i] - a[k]) * exp(alpha[k])     }     # Cumulative hazard function     H[i] <- sum(HH[i,1 : int.obs[i]] )   }   for ( i in 1:n) {     # Linear predictor     elinpred[i] <- exp(inprod(beta[],X[i,]))     # Log-hazard function     logHaz[i] <- log( exp(alpha[int.obs[i]]) * elinpred[i])     # Log-survival function     logSurv[i] <- -H[i]  * elinpred[i]     # Definition of the log-likelihood using zeros trick     phi[i] <- 100000 - status[i] * logHaz[i] - logSurv[i]     zeros[i] ~ dpois(phi[i])   }    #Real World or External Control Data    for (i in 1:nR){     # Pieces of the cumulative hazard function     for (k in 1:int.obsR[i]) {       condR[i,k] <- step(timeR[i] - a[k + 1])       HHR[i , k] <- condR[i,k] * (a[k + 1] - a[k]) * exp(alpha[k]) +       (1 - condR[i,k] ) * (timeR[i] - a[k]) * exp(alpha[k])     }     # Cumulative hazard function     HR[i] <- sum(HHR[i,1 : int.obsR[i]] )   }   for ( i in 1:nR) {     # Linear predictor     elinpredR[i] <- exp(inprod(beta[],XR[i,]))     # Log-hazard function     logHazR[i] <- log(exp(alpha[int.obsR[i]]) * elinpredR[i])     # Log-survival function     logSurvR[i] <- -HR[i] * elinpredR[i]     # Definition of the log-likelihood using zeros trick     phiR[i] <- 100000 - rho[i] * statusR[i] * logHazR[i] - rho[i] * logSurvR[i]      #rho[i] is the subject level weight as a power prior     zerosR[i] ~ dpois(phiR[i])   }   # Prior distributions   for(l in 1: Nbetas ){     beta[l] ~ dnorm(0 , 0.001)   }    for( k in 1 :m) {   alpha[k] ~ dnorm(0,0.001)   }  } data_with_weights=data.frame(data_with_weights)  #Trial Data trial.data <- data_with_weights[data_with_weights$indicator==1,]  #External Control Data ext.control.data <- data_with_weights[data_with_weights$indicator==0,]  #Input in JAGS code n <- nrow(trial.data) #Sample size in trial data nR <- nrow(ext.control.data) #Sample size in external control data  time <- trial.data$time #Survival time in trial data timeR <- ext.control.data$time #Survival time in external control data  status <- trial.data$event #Event indicator in trial data statusR <- ext.control.data$event #Event indicator in external control data  rho <- ext.control.data$invprob_weights/max(ext.control.data$invprob_weights) #Power prior weights  X <- as.matrix(trial.data[,10]) #Covariates in trial data XR <- as.matrix(ext.control.data[,10]) #Covariates in external control data  Nbetas <- ncol(X)  zeros = rep(0, n) zerosR = rep(0, nR) # Time axis partition K <- 1 # number of intervals  #Cut points (Using the event times in trial data) a=c(0,quantile(trial.data$time[trial.data$event==1],seq(0,1,by=1/K))[-c(1,K+1)],     max(c(trial.data$time,ext.control.data$time))+0.0001)  #Trial data # int.obs: vector that tells us at which interval each observation is int.obs <- matrix(data = NA, nrow = nrow(trial.data), ncol = length(a) - 1) d <- matrix(data = NA, nrow = nrow(trial.data), ncol = length(a) - 1) for(i in 1:nrow(trial.data)) {   for(k in 1:(length(a) - 1)) {     d[i, k] <- ifelse(trial.data$time[i] - a[k] > 0, 1, 0) *        ifelse(a[k + 1] - trial.data$time[i] > 0, 1,0)     int.obs[i, k] <- d[i, k] * k   } } int.obs <- rowSums(int.obs)  #External control data # int.obs: vector that tells us at which interval each observation is int.obsR <- matrix(data = NA, nrow = nrow(ext.control.data), ncol = length(a) - 1) d <- matrix(data = NA, nrow = nrow(ext.control.data), ncol = length(a) - 1) for(i in 1:nrow(ext.control.data)) {   for(k in 1:(length(a) - 1)) {     d[i, k] <- ifelse(ext.control.data$time[i] - a[k] > 0, 1, 0) *        ifelse(a[k + 1] - ext.control.data$time[i] > 0, 1,0)     int.obsR[i, k] <- d[i, k] * k   } } int.obsR <- rowSums(int.obsR) ### JAGS #### d.jags <- list(\"n\", \"nR\", \"time\", \"timeR\",                \"a\", \"X\", \"XR\",\"int.obs\",                \"int.obsR\",\"Nbetas\",                \"zeros\",\"zerosR\",\"rho\",                 \"status\", \"statusR\",\"K\") #Parameter of interest p.jags <- c(\"beta\",\"alpha\") #Initial values for each parameter i.jags <- function(){   list(beta = rnorm(ncol(X)), alpha = rnorm(K)) } set.seed(1) model1 <- jags(data = d.jags, model.file = \"powerprior.txt\", inits = i.jags, n.chains = 3,                parameters=p.jags,n.iter=niter,n.burnin = round(niter/2),n.thin = 10) #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 1100 #>    Unobserved stochastic nodes: 2 #>    Total graph size: 23016 #>  #> Initializing model model1$BUGSoutput$summary #>                   mean         sd          2.5%           25%           50% #> alpha     7.672650e-01 0.08330851  6.030597e-01  7.109502e-01  7.679483e-01 #> beta     -8.006893e-01 0.05042475 -8.986307e-01 -8.356531e-01 -8.005683e-01 #> deviance  2.200010e+08 1.86370178  2.200009e+08  2.200010e+08  2.200010e+08 #>                    75%         97.5%     Rhat n.eff #> alpha     8.249207e-01  9.219494e-01 1.000049  1500 #> beta     -7.651435e-01 -7.026286e-01 1.000307  1500 #> deviance  2.200010e+08  2.200010e+08 1.000000     1 c(summary(exp(model1$BUGSoutput$sims.list$beta[,1])),   quantile(exp(model1$BUGSoutput$sims.list$beta[,1]),probs=c(0.025,0.975))) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      2.5%     97.5%  #> 0.3871170 0.4335912 0.4490737 0.4495901 0.4652671 0.5259439 0.4071268 0.4952818 hist(exp(model1$BUGSoutput$sims.list$beta[,1]),xlab=\"treatmentHR\",main=\"\",ylab=\"\") traceplot(model1,varname=c(\"alpha\",\"beta\"))"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"commensurate-prior-with-piecewise-exponential-distribution-not-implemented-in-psborrow2-r-package","dir":"Articles","previous_headings":"","what":"Commensurate prior with piecewise exponential distribution (not implemented in psborrow2 R package)","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"consider Bayesian commensurate prior model. now define variables input JAGS. also need pre-specify number intervals. simplicity, consider \\(K=1\\) interval. However, method also works \\(K>1\\). now put variables list data inputs JAGs. Note letter \\(R\\) following corresponds RWD. example, \\(XR\\) covariate matrix RWD. specify parameter interest follows. Note alphaR baseline hazard parameter external control. generate initial values \\(\\beta\\) \\(\\alpha\\) standard normal distributions, \\(\\tau\\) non-informative Gamma distribution. Now, call jags function conduct MCMC sampling \\(3\\) chains shown . set number iterations \\(niter=10,000\\) burn \\(5000\\) thinning \\(10\\). summary can produced using following command. summary hazard ratio treatment variable shown . histogram treatment hazard ratio can also produced. plot chunk unnamed-chunk-42 histogram commensurability parameter can also produced. plot chunk unnamed-chunk-43 traceplot can created follows. plot chunk unnamed-chunk-44 plot chunk unnamed-chunk-44 plot chunk unnamed-chunk-44 plot chunk unnamed-chunk-44","code":"model{   #Trial Data   for (i in 1:n){     # Pieces of the cumulative hazard function     for (k in 1:int.obs[i]) {       cond[i,k] <- step(time[i] - a[k + 1])       HH[i , k] <- cond[i,k] * (a[k + 1] - a[k]) * exp(alpha[k]) +       (1 - cond[i,k] ) * (time[i] - a[k]) * exp(alpha[k])     }     # Cumulative hazard function     H[i] <- sum(HH[i,1 : int.obs[i]] )   }   for ( i in 1:n) {     # Linear predictor     elinpred[i] <- exp(inprod(beta[],X[i,]))     # Log-hazard function     logHaz[i] <- log(exp(alpha[int.obs[i]]) * elinpred[i])     # Log-survival function     logSurv[i] <- -H[i] * elinpred[i]     # Definition of the log-likelihood using zeros trick     phi[i] <- 100000 - wt[i]*status[i] * logHaz[i] - wt[i]*logSurv[i]     zeros[i] ~ dpois(phi[i])   }    #Real World or External Control Data    for (i in 1:nR){     # Pieces of the cumulative hazard function     for (k in 1:int.obsR[i]) {       condE[i,k] <- step(timeR[i] - a[k + 1])       HHE[i , k] <- condE[i,k] * (a[k + 1] - a[k]) * exp(alphaR[k]) +       (1 - condE[i,k] ) * (timeR[i] - a[k]) * exp(alphaR[k])     }     # Cumulative hazard function     HE[i] <- sum(HHE[i,1 : int.obsR[i]] )   }   for ( i in 1:nR) {     # Linear predictor     elinpredE[i] <- exp(inprod(beta0[],XR[i,]))     # Log-hazard function     logHazE[i] <- log(exp(alphaR[int.obsR[i]]) * elinpredE[i])     # Log-survival function     logSurvE[i] <- -HE[i] * elinpredE[i]     # Definition of the log-likelihood using zeros trick     phiE[i] <- 100000 - wtR[i]*statusR[i] * logHazE[i] - wtR[i] * logSurvE[i]     zerosR[i] ~ dpois(phiE[i])   }     # Commensurate prior on the covariate effect   for(l in 1: Nbetas ){     beta0[l] ~ dnorm(0,0.0001);     tau[l] ~ dgamma(0.01,0.01);     beta[l] ~ dnorm(beta0[l],tau[l]);   }      # Normal prior on the piecewise exponential parameters for each interval   for( m in 1 : K) {   taualpha[m] ~ dgamma(0.01,0.01);   alpha[m] ~ dnorm(alphaR[m],taualpha[m]);   alphaR[m] ~ dnorm(0,0.0001);   }  } data_with_weights=data.frame(data_with_weights)  #Trial Data trial.data <- data_with_weights[data_with_weights$indicator==1,]  #External Control Data ext.control.data <- data_with_weights[data_with_weights$indicator==0,]  #Input in JAGS code n <- nrow(trial.data) #Sample size in trial data nR <- nrow(ext.control.data) #Sample size in external control data  time <- trial.data$time #Survival time in trial data timeR <- ext.control.data$time #Survival time in external control data  status <- trial.data$event #Event indicator in trial data statusR <- ext.control.data$event #Event indicator in external control data  wt <- trial.data$norm.weights #Vector of weights in trial data wtR <- ext.control.data$norm.weights #Vector of weights in external control data  X <- as.matrix(trial.data[,10]) #Treatment indicator in trial data XR <- as.matrix(ext.control.data[,10]) #Treatment indicator in trial data  Nbetas <- ncol(X)  zeros = rep(0, n) zerosR = rep(0, nR) # Time axis partition K <- 1 # number of intervals  #Cut points (Using the event times in trial data) a=c(0,quantile(trial.data$time[trial.data$event==1],seq(0,1,by=1/K))[-c(1,K+1)],     max(c(trial.data$time,ext.control.data$time))+0.0001)  #Trial data # int.obs: vector that tells us at which interval each observation is int.obs <- matrix(data = NA, nrow = nrow(trial.data), ncol = length(a) - 1) d <- matrix(data = NA, nrow = nrow(trial.data), ncol = length(a) - 1) for(i in 1:nrow(trial.data)) {   for(k in 1:(length(a) - 1)) {     d[i, k] <- ifelse(trial.data$time[i] - a[k] > 0, 1, 0) *        ifelse(a[k + 1] - trial.data$time[i] > 0, 1, 0)     int.obs[i, k] <- d[i, k] * k   } } int.obs <- rowSums(int.obs)  #External control data # int.obs: vector that tells us at which interval each observation is int.obsR <- matrix(data = NA, nrow = nrow(ext.control.data), ncol = length(a) - 1) d <- matrix(data = NA, nrow = nrow(ext.control.data), ncol = length(a) - 1) for(i in 1:nrow(ext.control.data)) {   for(k in 1:(length(a) - 1)) {     d[i, k] <- ifelse(ext.control.data$time[i] - a[k] > 0, 1, 0) *        ifelse(a[k + 1] - ext.control.data$time[i] > 0, 1,0)     int.obsR[i, k] <- d[i, k] * k   } } int.obsR <- rowSums(int.obsR) ### JAGS #### d.jags <- list(\"n\", \"nR\", \"time\", \"timeR\",                \"a\", \"X\", \"XR\",\"int.obs\",                \"int.obsR\",\"Nbetas\",                \"zeros\",\"zerosR\",\"wt\", \"wtR\",                \"status\", \"statusR\",\"K\") #Parameter of interest p.jags <- c(\"beta\",\"alpha\",\"alphaR\",\"tau\") #Initial values for each parameter i.jags <- function(){   list(beta = rnorm(ncol(X)), beta0 = rnorm(ncol(X)),        alpha = rnorm(K),alphaR = rnorm(K),tau = rgamma(ncol(X),shape = 0.01,scale=0.01)) } set.seed(1) model2 <- jags(data = d.jags, model.file = \"commensurateprior.txt\", inits = i.jags, n.chains = 3,                parameters=p.jags,n.iter=niter,n.burnin = round(niter/2),n.thin = 10) #> Compiling model graph #>    Resolving undeclared variables #>    Allocating nodes #> Graph information: #>    Observed stochastic nodes: 1100 #>    Unobserved stochastic nodes: 5 #>    Total graph size: 24222 #>  #> Initializing model model2$BUGSoutput$summary #>                   mean         sd          2.5%           25%           50% #> alpha     7.012442e-01 0.08417559  5.422684e-01  6.433417e-01  6.995345e-01 #> alphaR    3.775493e+00 0.53271370  2.651884e+00  3.434386e+00  3.808735e+00 #> beta     -7.699118e-01 0.04937989 -8.653964e-01 -8.023713e-01 -7.688038e-01 #> deviance  2.200009e+08 3.59110530  2.200009e+08  2.200009e+08  2.200009e+08 #> tau       4.990748e-02 0.19141621  2.688540e-04  3.312027e-03  1.147687e-02 #>                    75%         97.5%     Rhat n.eff #> alpha     7.626370e-01  8.639186e-01 1.002131   940 #> alphaR    4.142427e+00  4.781330e+00 1.002836   840 #> beta     -7.368342e-01 -6.755448e-01 1.000972  1500 #> deviance  2.200009e+08  2.200009e+08 1.000000     1 #> tau       3.066659e-02  2.970125e-01 1.001709  1200 c(summary(exp(model2$BUGSoutput$sims.list$beta[,1])),   quantile(exp(model2$BUGSoutput$sims.list$beta[,1]),probs=c(0.025,0.975))) #>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      2.5%     97.5%  #> 0.3924743 0.4482647 0.4635673 0.4636176 0.4786268 0.5455878 0.4208848 0.5088791 hist(exp(model2$BUGSoutput$sims.list$beta[,1]),xlab=\"treatmentHR\",main=\"\",ylab=\"\") hist(exp(model2$BUGSoutput$sims.list$tau[,1]),xlab=\"Commensurability Parameter\",main=\"\",ylab=\"\") traceplot(model2,varname=c(\"alpha\",\"alphaR\",\"beta\",\"tau\"))"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"exponential-distribution-constant-hazard-and-no-borrowing-using-psborrow2-r-package","dir":"Articles","previous_headings":"","what":"Exponential distribution (constant hazard) and no borrowing: Using psborrow2 R package","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"addition specifying exponential distribution using Bayesian dynamic borrowing, naive -borrowing full-borrowing analysis can conducted using exponential distribution following similar steps . ype analysis used sensitivity exploratory analysis. psborrow2 package used conduct analysis. Following steps. use exponential distribution outcome model follows. Non-informative normal prior used baseline parameter. Next, borrowing method implemented shown . consider borrowing shown . Similarly, details regarding treatment variable specified . Non-informative prior used prior treatment effect. Now, pieces brought together create analysis object shown . Finally, run MCMC sample \\(3\\) chains. summary shown . histogram posterior samples hazard ratio commensurability parameter shown . plot chunk unnamed-chunk-51 \\(95\\%\\) credible interval can calculated follows. can see plots help us understand diagnose problems MCMC sampler, trace plot. plot chunk unnamed-chunk-53","code":"#Outcome outcome <- outcome_surv_exponential(   time_var = \"time\",   cens_var = \"cnsr\",   baseline_prior = prior_normal(0, 1000) )  outcome #> Outcome object with class OutcomeSurvExponential  #>  #> Outcome variables: #> time_var cens_var  #>   \"time\"   \"cnsr\"  #>  #> Baseline prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000 #Borrowing borrowing <- borrowing_none(   ext_flag_col = \"ext\" )  borrowing #> Borrowing object using the  No borrowing  approach #>  #> External control flag: ext #Treatment treatment <- treatment_details(   trt_flag_col = \"group\",   trt_prior = prior_normal(0, 1000) ) treatment #> Treatment object #>  #> Treatment flag column: group  #>  #> Treatment effect prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000 data_with_weights <- as.matrix(data_with_weights) #Application anls_obj <- create_analysis_obj(   data_matrix = data_with_weights,   outcome = outcome,   borrowing = borrowing,   treatment = treatment ) #> Inputs look good. #> NOTE: excluding `ext` == `1`/`TRUE` for no borrowing. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`. results.no.psborrow<- mcmc_sample(anls_obj,   iter_warmup = round(niter/3),   iter_sampling = niter,   chains = 3,   seed = 123 ) #> Running MCMC with 3 sequential chains... #>  #> Chain 1 finished in 4.1 seconds. #> Chain 2 finished in 4.1 seconds. #> Chain 3 finished in 4.0 seconds. #>  #> All 3 chains finished successfully. #> Mean chain execution time: 4.1 seconds. #> Total execution time: 12.6 seconds.  draws3 <- results.no.psborrow$draws() draws3 <- rename_draws_covariates(draws3, anls_obj) results.no.psborrow$summary() #> # A tibble: 4 × 10 #>   variable      mean    median     sd    mad       q5      q95  rhat ess_bulk #>   <chr>        <dbl>     <dbl>  <dbl>  <dbl>    <dbl>    <dbl> <dbl>    <dbl> #> 1 lp__     -724.     -724.     0.995  0.718  -726.    -723.     1.00   10028. #> 2 beta_trt   -0.0343   -0.0352 0.117  0.116    -0.224    0.159  1.00    7950. #> 3 alpha      -0.948    -0.947  0.0989 0.0989   -1.11    -0.787  1.00    7991. #> 4 HR_trt      0.973     0.965  0.114  0.112     0.799    1.17   1.00    7950. #> # ℹ 1 more variable: ess_tail <dbl> bayesplot::mcmc_hist(draws3, c(\"treatment HR\")) bayesplot::color_scheme_set(\"mix-blue-pink\") summarize_draws(draws3, ~ quantile(.x, probs = c(0.025, 0.975))) #> # A tibble: 4 × 3 #>   variable                   `2.5%`  `97.5%` #>   <chr>                       <dbl>    <dbl> #> 1 lp__                     -727.    -723.    #> 2 treatment log HR           -0.264    0.195 #> 3 baseline log hazard rate   -1.14    -0.757 #> 4 treatment HR                0.768    1.22 bayesplot::color_scheme_set(\"mix-blue-pink\")  bayesplot::mcmc_trace(   draws3[1:(round(niter/2)), 1:2, ], # Using a subset of draws only   pars = c(\"treatment HR\"),   n_warmup = round(niter/10) )"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"exponential-distribution-constant-hazard-and-full-borrowing-using-psborrow2-r-package","dir":"Articles","previous_headings":"","what":"Exponential distribution (constant hazard) and full borrowing: Using psborrow2 R package","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"psborrow2 package used conduct analysis. Following steps. use exponential distribution outcome model follows. Non-informative normal prior used baseline parameter. Next, borrowing method implemented shown . consider full borrowing shown . Similarly, details regarding treatment variable specified . Non-informative prior used prior treatment effect. Now, pieces brought together create analysis object shown . Finally, run MCMC sample \\(3\\) chains. summary shown . histogram posterior samples hazard ratio commensurability parameter shown . plot chunk unnamed-chunk-60 \\(95\\%\\) credible interval can calculated follows. can see plots help us understand diagnose problems MCMC sampler, trace plot. plot chunk unnamed-chunk-62","code":"#Outcome outcome <- outcome_surv_exponential(   time_var = \"time\",   cens_var = \"cnsr\",   baseline_prior = prior_normal(0, 1000) )  outcome #> Outcome object with class OutcomeSurvExponential  #>  #> Outcome variables: #> time_var cens_var  #>   \"time\"   \"cnsr\"  #>  #> Baseline prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000 #Borrowing borrowing <- borrowing_full(ext_flag_col = \"ext\")  borrowing #> Borrowing object using the  Full borrowing  approach #>  #> External control flag: ext #Treatment treatment <- treatment_details(   trt_flag_col = \"group\",   trt_prior = prior_normal(0, 1000) ) treatment #> Treatment object #>  #> Treatment flag column: group  #>  #> Treatment effect prior: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean    0  #>  sigma sd   1000 #Application anls_obj <- create_analysis_obj(   data_matrix = data_with_weights,   outcome = outcome,   borrowing = borrowing,   treatment = treatment ) #> Inputs look good. #> NOTE: dropping column `ext` for full borrowing. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`. results.full.psborrow<- mcmc_sample(anls_obj,   iter_warmup = round(niter/3),   iter_sampling = niter,   chains = 3,   seed = 123 ) #> Running MCMC with 3 sequential chains... #>  #> Chain 1 finished in 5.7 seconds. #> Chain 2 finished in 5.6 seconds. #> Chain 3 finished in 5.6 seconds. #>  #> All 3 chains finished successfully. #> Mean chain execution time: 5.7 seconds. #> Total execution time: 17.4 seconds.  draws4 <- results.full.psborrow$draws() draws4 <- rename_draws_covariates(draws4, anls_obj) results.full.psborrow$summary() #> # A tibble: 4 × 10 #>   variable     mean   median     sd    mad       q5      q95  rhat ess_bulk #>   <chr>       <dbl>    <dbl>  <dbl>  <dbl>    <dbl>    <dbl> <dbl>    <dbl> #> 1 lp__     -815.    -814.    1.01   0.710  -817.    -814.     1.00   14094. #> 2 beta_trt   -1.32    -1.32  0.0781 0.0775   -1.45    -1.19   1.00   11317. #> 3 alpha       0.339    0.339 0.0476 0.0480    0.260    0.416  1.00   11709. #> 4 HR_trt      0.268    0.267 0.0209 0.0207    0.235    0.303  1.00   11317. #> # ℹ 1 more variable: ess_tail <dbl> bayesplot::mcmc_hist(draws4, c(\"treatment HR\")) bayesplot::color_scheme_set(\"mix-blue-pink\") summarize_draws(draws4, ~ quantile(.x, probs = c(0.025, 0.975))) #> # A tibble: 4 × 3 #>   variable                   `2.5%`  `97.5%` #>   <chr>                       <dbl>    <dbl> #> 1 lp__                     -817.    -814.    #> 2 treatment log HR           -1.47    -1.17  #> 3 baseline log hazard rate    0.245    0.430 #> 4 treatment HR                0.229    0.311 bayesplot::color_scheme_set(\"mix-blue-pink\")  bayesplot::mcmc_trace(   draws4[1:(round(niter/2)), 1:2, ], # Using a subset of draws only   pars = c(\"treatment HR\"),   n_warmup = round(niter/10) )"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"cox-proportional-hazards-model-using-frequentist-approach-no-borrowing","dir":"Articles","previous_headings":"","what":"Cox proportional hazards model using frequentist approach (No borrowing)","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"Now, also demonstrate researchers fit frequentist Cox model. first model, borrow information external controls use trial data .","code":"data_with_weights = data.frame(data_with_weights) f1 <- coxph(Surv(time,event)~group, data=data_with_weights[data_with_weights$ext==0,]) summary(f1) #> Call: #> coxph(formula = Surv(time, event) ~ group, data = data_with_weights[data_with_weights$ext ==  #>     0, ]) #>  #>   n= 600, number of events= 367  #>  #>           coef exp(coef) se(coef)      z Pr(>|z|) #> group -0.02944   0.97099  0.11673 -0.252    0.801 #>  #>       exp(coef) exp(-coef) lower .95 upper .95 #> group     0.971       1.03    0.7724     1.221 #>  #> Concordance= 0.512  (se = 0.014 ) #> Likelihood ratio test= 0.06  on 1 df,   p=0.8 #> Wald test            = 0.06  on 1 df,   p=0.8 #> Score (logrank) test = 0.06  on 1 df,   p=0.8"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"cox-proportional-hazards-model-using-frequentist-approach-full-borrowing-from-external-control","dir":"Articles","previous_headings":"","what":"Cox proportional hazards model using frequentist approach (Full borrowing from external control)","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"frequentist Cox model can also fitted using external control data via full borrowing.","code":"f2 <- coxph(Surv(time,event)~group, data=data_with_weights) summary(f2) #> Call: #> coxph(formula = Surv(time, event) ~ group, data = data_with_weights) #>  #>   n= 1100, number of events= 703  #>  #>           coef exp(coef) se(coef)      z Pr(>|z|)     #> group -0.98910   0.37191  0.08018 -12.34   <2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #>  #>       exp(coef) exp(-coef) lower .95 upper .95 #> group    0.3719      2.689    0.3178    0.4352 #>  #> Concordance= 0.662  (se = 0.007 ) #> Likelihood ratio test= 158.1  on 1 df,   p=<2e-16 #> Wald test            = 152.2  on 1 df,   p=<2e-16 #> Score (logrank) test = 162.7  on 1 df,   p=<2e-16"},{"path":"https://genentech.github.io/psborrow2/articles/match_weight_02_application.html","id":"summarizing-all-the-results-together","dir":"Articles","previous_headings":"","what":"Summarizing all the results together","title":"2. Matching and Weighting Application with Dynamic Borrowing","text":"Now, concatenate results Bayesian frequentist analysis approaches together.","code":"hr1=results.exp.psborrow$summary()[6,c(2)] hr1conf = summarize_draws(draws1, ~ quantile(.x, probs = c(0.025, 0.975)))[6,c(2,3)] hr1.conf=c(hr1$mean,hr1conf$`2.5%`,hr1conf$`97.5%`)  hr2=c(mean(exp(model1$BUGSoutput$sims.list$beta[,1])),   quantile(exp(model1$BUGSoutput$sims.list$beta[,1]),probs=c(0.025,0.975))) hr2.conf=c(hr2)  hr3=results.weib.psborrow$summary()[7,c(2)] hr3conf = summarize_draws(draws2, ~ quantile(.x, probs = c(0.025, 0.975)))[7,c(2,3)] hr3.conf=c(hr3$mean,hr3conf$`2.5%`,hr3conf$`97.5%`)  hr4=c(mean(exp(model2$BUGSoutput$sims.list$beta[,1])),   quantile(exp(model2$BUGSoutput$sims.list$beta[,1]),probs=c(0.025,0.975))) hr4.conf=c(hr4)  hr5=results.no.psborrow$summary()[4,c(2)] hr5conf = summarize_draws(draws3, ~ quantile(.x, probs = c(0.025, 0.975)))[4,c(2,3)] hr5.conf=c(hr5$mean,hr5conf$`2.5%`,hr5conf$`97.5%`)  hr6=results.full.psborrow$summary()[4,c(2)] hr6conf = summarize_draws(draws4, ~ quantile(.x, probs = c(0.025, 0.975)))[4,c(2,3)] hr6.conf=c(hr6$mean,hr6conf$`2.5%`,hr6conf$`97.5%`)  hr7.conf=c(exp(coef(f1)),exp(confint(f1)))  hr8.conf=c(exp(coef(f2)),exp(confint(f2)))  out = round(rbind(hr1.conf,hr2.conf,hr3.conf,hr4.conf,hr5.conf,hr6.conf,hr7.conf,hr8.conf),4)  rownames(out)= NULL out = data.frame(Method=c(\"Exponential distribution (constant hazard) and gamma prior\",                           \"Piecewise exponential distribution (proportional hazard) and power prior\",                           \"Weibull distribution (proportional hazard) and gamma prior\",                           \"Piecewise exponential distribution (proportional hazard) and commensurate prior\",                           \"Exponential distribution (constant hazard): No borrowing\",                           \"Exponential distribution (constant hazard): Full borrowing\",                           \"Cox model (Frequentist approach): No borrowing\",                           \"Cox model (Frequentist approach): Full borrowing\"),out) colnames(out)[2:4] = c(\"Hazard Ratio\",\"Lower 95% CI\",\"Upper 95% CI\")"},{"path":[]},{"path":"https://genentech.github.io/psborrow2/articles/prior_distributions.html","id":"specifying-prior-distributions","dir":"Articles","previous_headings":"","what":"Specifying prior distributions","title":"3. Specifying prior distributions","text":"psborrow2 creates fully-parametrized Bayesian models, proper prior distributions parameters must specified. Prior distributions needed several parameters, depending analysis: beta coefficients (e.g. log hazard ratios log odds ratios) coefficients, passed add_covariates() ancillary parameters outcome distributions, shape parameter Weibull survival distribution, passed outcome_surv_weibull_ph() log effect estimates (e.g. hazard ratios odds ratios) primary contrast treatments, passed treatment_details() baseline outcome rates odds, passed outcome functions hyperprior commensurability parameter Bayesian dynamic borrowing (BDB), passed borrowing_hierarchical_commensurate() See documentation functions information.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/prior_distributions.html","id":"types-of-prior-distributions","dir":"Articles","previous_headings":"","what":"Types of prior distributions","title":"3. Specifying prior distributions","text":"currently supported prior distributions created prior_ constructors : prior_bernoulli() prior_beta() prior_cauchy() prior_exponential() prior_gamma() prior_half_cauchy() prior_half_normal() prior_normal() prior_poisson() example, can create uninformative normal distribution specifying normal prior centered around 0 large standard deviation: See documentation respective functions additional information.","code":"uninformative_normal <- prior_normal(0, 10000) uninformative_normal # Normal Distribution # Parameters: #  Stan  R    Value #  mu    mean     0 #  sigma sd   10000"},{"path":"https://genentech.github.io/psborrow2/articles/prior_distributions.html","id":"visualizing-prior-distributions","dir":"Articles","previous_headings":"","what":"Visualizing prior distributions","title":"3. Specifying prior distributions","text":"may sometimes find useful visualize prior distributions. scenarios, can call plot() prior object visualize distribution: plot chunk unnamed-chunk-3 plot() chooses default axes , can change make differences obvious. Let’s compare conservative gamma(0.001, 0.001) hyperprior distribution commensurability parameter tau aggressive gamma(1, 0.001) distribution greater density higher values tau (lead borrowing BDB analysis): plot chunk unnamed-chunk-4","code":"plot(uninformative_normal) conservative_tau <- prior_gamma(0.001, 0.001) aggressive_tau <- prior_gamma(1, 0.001) plot(aggressive_tau, xlim = c(0, 2000), col = \"blue\", ylim = c(0, 1e-03)) plot(conservative_tau, xlim = c(0, 2000), col = \"red\", add = TRUE)"},{"path":"https://genentech.github.io/psborrow2/articles/propensity_scores.html","id":"alternative-ps-weights-with-weightit","dir":"Articles","previous_headings":"","what":"Alternative PS Weights with WeightIt","title":"5. Incorporating propensity scores analysis in psborrow2","text":"WeightIt package can calculate PS balancing weights number different methods, generalized boosted modeling (method = \"gbm\"). addition, weights can calculated differently different estimands. , specifying estimand = \"ATT\", calculate weights estimating average treatment effect among treated (ATT). Another useful package cobalt, provides tools assessing balance groups weighting matching. compatible many matching weighting packages. See vignette details. can use cobalt package assess balance bal.plot(). plot chunk balplot “Love plots” can also generated compare populations weighting: plot chunk loveplot PS values can copied data set analysis object can constructed .","code":"library(WeightIt)  example_dataframe <- as.data.frame(example_matrix) example_dataframe$int <- 1 - example_dataframe$ext  weightit_model <- weightit(   int ~ cov1 + cov2 + cov3 + cov4,   data = example_dataframe,   method = \"gbm\",   estimand = \"ATT\" ) #> Warning: No `criterion` was provided. Using \"smd.mean\"FALSETRUE. summary(weightit_model) #>                  Summary of weights #>  #> - Weight ranges: #>  #>            Min                                  Max #> treated 1.0000      ||                       1.0000 #> control 0.0826 |---------------------------| 5.8966 #>  #> - Units with the 5 most extreme weights by group: #>                                             #>               5      4      3      2      1 #>  treated      1      1      1      1      1 #>             195    158    465    438    371 #>  control 2.7924 2.7924 5.8966 5.8966 5.8966 #>  #> - Weight statistics: #>  #>         Coef of Var  MAD Entropy # Zeros #> treated       0.000 0.00     0.0       0 #> control       1.582 0.82     0.6       0 #>  #> - Effective Sample Sizes: #>  #>            Control Treated #> Unweighted  350.       150 #> Weighted    100.09     150 library(cobalt) bal.plot(weightit_model) love.plot(weightit_model, stars = \"std\") example_dataframe$att <- weightit_model$weights  example_matrix_att <- create_data_matrix(   example_dataframe,   ext_flag_col = \"ext\",   outcome = c(\"time\", \"cnsr\"),   trt_flag_col = \"trt\",   weight_var = \"att\" )  analysis_att <- create_analysis_obj(   data_matrix = example_matrix_att,   outcome = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000), weight_var = \"att\"),   borrowing = borrowing_full(\"ext\"),   treatment = treatment_details(\"trt\", prior_normal(0, 10000)),   quiet = TRUE )  result_att <- mcmc_sample(analysis_att, seed = 123)"},{"path":"https://genentech.github.io/psborrow2/articles/propensity_scores.html","id":"matching-with-matchit","dir":"Articles","previous_headings":"","what":"Matching with MatchIt","title":"5. Incorporating propensity scores analysis in psborrow2","text":"variety matching methods, including PS matching implemented MatchIt package. described Getting Started vignette, can useful check imbalance matching. matching treated untreated select comparable control group, regardless whether internal external. simplicity let’s try 1:1 nearest matching approach. plot chunk matchit_jitter Determining whether balance matching appropriate beyond scope vignette. can read MatchIt Assessing Balance vignette. cobalt package can useful . However, happy results matching procedure, can extract data use psborrow2.","code":"library(MatchIt) #>  #> Attaching package: 'MatchIt' #> The following object is masked from 'package:cobalt': #>  #>     lalonde # No matching; constructing a pre-match matchit object no_match <- matchit(trt ~ cov1 + cov2 + cov3 + cov4,   data = example_dataframe,   method = NULL, distance = \"glm\" ) summary(no_match) #>  #> Call: #> matchit(formula = trt ~ cov1 + cov2 + cov3 + cov4, data = example_dataframe,  #>     method = NULL, distance = \"glm\") #>  #> Summary of Balance for All Data: #>          Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance        0.2898        0.1776          0.7585     1.5831    0.2328 #> cov1            0.6300        0.7150         -0.1761          .    0.0850 #> cov2            0.3700        0.4625         -0.1916          .    0.0925 #> cov3            0.7600        0.4475          0.7317          .    0.3125 #> cov4            0.4600        0.2250          0.4715          .    0.2350 #>          eCDF Max #> distance   0.3375 #> cov1       0.0850 #> cov2       0.0925 #> cov3       0.3125 #> cov4       0.2350 #>  #> Sample Sizes: #>           Control Treated #> All           400     100 #> Matched       400     100 #> Unmatched       0       0 #> Discarded       0       0 match_11 <- matchit(trt ~ cov1 + cov2 + cov3 + cov4,   data = example_dataframe,   method = \"nearest\", distance = \"glm\" ) summary(match_11) #>  #> Call: #> matchit(formula = trt ~ cov1 + cov2 + cov3 + cov4, data = example_dataframe,  #>     method = \"nearest\", distance = \"glm\") #>  #> Summary of Balance for All Data: #>          Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance        0.2898        0.1776          0.7585     1.5831    0.2328 #> cov1            0.6300        0.7150         -0.1761          .    0.0850 #> cov2            0.3700        0.4625         -0.1916          .    0.0925 #> cov3            0.7600        0.4475          0.7317          .    0.3125 #> cov4            0.4600        0.2250          0.4715          .    0.2350 #>          eCDF Max #> distance   0.3375 #> cov1       0.0850 #> cov2       0.0925 #> cov3       0.3125 #> cov4       0.2350 #>  #> Summary of Balance for Matched Data: #>          Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean #> distance        0.2898        0.2845          0.0355     1.1082    0.0075 #> cov1            0.6300        0.6800         -0.1036          .    0.0500 #> cov2            0.3700        0.3900         -0.0414          .    0.0200 #> cov3            0.7600        0.7600          0.0000          .    0.0000 #> cov4            0.4600        0.4600          0.0000          .    0.0000 #>          eCDF Max Std. Pair Dist. #> distance     0.07          0.0355 #> cov1         0.05          0.1036 #> cov2         0.02          0.1243 #> cov3         0.00          0.0000 #> cov4         0.00          0.0000 #>  #> Sample Sizes: #>           Control Treated #> All           400     100 #> Matched       100     100 #> Unmatched     300       0 #> Discarded       0       0 set.seed(123) plot(match_11, type = \"jitter\", interactive = FALSE) example_matrix_match <- create_data_matrix(   data = example_dataframe[match_11$weights == 1, ],   ext_flag_col = \"ext\",   outcome = c(\"time\", \"cnsr\"),   trt_flag_col = \"trt\" ) analysis_match <- create_analysis_obj(   data_matrix = example_matrix_match,   outcome = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000)),   borrowing = borrowing_full(\"ext\"),   treatment = treatment_details(\"trt\", prior_normal(0, 10000)),   quiet = TRUE )  result_match <- mcmc_sample(analysis_match, seed = 123)"},{"path":"https://genentech.github.io/psborrow2/articles/propensity_scores.html","id":"combined-weighting-and-dynamic-borrowing","dir":"Articles","previous_headings":"","what":"Combined Weighting and Dynamic Borrowing","title":"5. Incorporating propensity scores analysis in psborrow2","text":"models also support fixed weights likelihood contributions observation. equivalent fixed power prior weights. allows combination models, IPTW + commensurate prior approach.","code":"analysis_iptw_bdb <- create_analysis_obj(   data_matrix = example_matrix_att,   outcome = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000), weight_var = \"att\"),   borrowing = borrowing_hierarchical_commensurate(\"ext\", prior_gamma(0.01, 0.01)),   treatment = treatment_details(\"trt\", prior_normal(0, 10000)),   quiet = TRUE )  result_iptw_bdb <- mcmc_sample(analysis_iptw_bdb, seed = 123)"},{"path":"https://genentech.github.io/psborrow2/articles/propensity_scores.html","id":"fixed-weights","dir":"Articles","previous_headings":"","what":"Fixed Weights","title":"5. Incorporating propensity scores analysis in psborrow2","text":"can also use weights specify fixed power prior model. set power parameter \\(\\alpha = 0.1\\) external controls.","code":"example_matrix_pp01 <- cbind(example_matrix, pp_alpha = ifelse(example_matrix[, \"ext\"] == 1, 0.1, 1))  analysis_pp01 <- create_analysis_obj(   data_matrix = example_matrix_pp01,   outcome = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000), weight_var = \"pp_alpha\"),   borrowing = borrowing_full(\"ext\"),   treatment = treatment_details(\"trt\", prior_normal(0, 10000)),   quiet = TRUE )  result_pp01 <- mcmc_sample(analysis_pp01, seed = 123)"},{"path":"https://genentech.github.io/psborrow2/articles/propensity_scores.html","id":"reference-models","dir":"Articles","previous_headings":"","what":"Reference Models","title":"5. Incorporating propensity scores analysis in psborrow2","text":"comparison, also fit full borrowing, borrowing, BDB model without weights.","code":"result_full <- mcmc_sample(   create_analysis_obj(     data_matrix = example_matrix,     outcome = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000)),     borrowing = borrowing_full(\"ext\"),     treatment = treatment_details(\"trt\", prior_normal(0, 10000)),     quiet = TRUE   ),   seed = 123 )  result_none <- mcmc_sample(   create_analysis_obj(     data_matrix = example_matrix,     outcome = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000)),     borrowing = borrowing_none(\"ext\"),     treatment = treatment_details(\"trt\", prior_normal(0, 10000)),     quiet = TRUE   ),   seed = 123 )  result_bdb <- mcmc_sample(   create_analysis_obj(     data_matrix = example_matrix_att,     outcome = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000)),     borrowing = borrowing_hierarchical_commensurate(\"ext\", prior_gamma(0.01, 0.01)),     treatment = treatment_details(\"trt\", prior_normal(0, 10000)),     quiet = TRUE   ),   seed = 123 )"},{"path":"https://genentech.github.io/psborrow2/articles/propensity_scores.html","id":"comparison-of-results","dir":"Articles","previous_headings":"","what":"Comparison of Results","title":"5. Incorporating propensity scores analysis in psborrow2","text":"can use summary() extract variable interest specify summary statistics. can extract draws object model plot posterior distribution treatment hazard ratio. plot chunk plots see borrowing full borrowing extremes methods .","code":"models <- list(   \"No borrowing\" = result_none,   \"Full borrowing\" = result_full,   \"Power Prior 01\" = result_pp01,   \"ATT Weights\" = result_att,   \"IPTW + BDB\" = result_iptw_bdb,   \"Matching 1:1\" = result_match,   \"BDB\" = result_bdb ) results_table <- do.call(rbind, lapply(   models,   function(i) i$summary(\"HR_trt\", c(\"mean\", \"median\", \"sd\", \"quantile2\")) )) knitr::kable(cbind(models = names(models), results_table), digits = 3) plot(density(models[[1]]$draws(\"HR_trt\")),   col = 1, xlim = c(0, 2), ylim = c(0, 9), lwd = 2,   xlab = \"HR_trt\",   main = \"Posterior Hazard Ratio\" ) for (i in 2:7) {   lines(density(models[[i]]$draws(\"HR_trt\")), col = i, lty = i, lwd = 2) } legend(\"topright\", col = seq_along(models), lty = seq_along(models), legend = names(models))"},{"path":[]},{"path":"https://genentech.github.io/psborrow2/articles/psborrow2.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"1. Getting started with psborrow2","text":"randomized controlled trial (RCT) comparing experimental control arms remains gold standard evaluating efficacy novel therapy, one may want leverage relevant existing external control data inform study outcome. External control data can help increase study power thereby shorten trial duration reduce number subjects needed. However, analysis external control data can also introduce bias. One method incorporating external control data mitigate bias Bayesian dynamic borrowing (BDB), external control data borrowed extent external RCT control arms similar outcomes. See @viele2014use summary. Implementing BDB computationally involved requires Markov chain Monte Carlo (MCMC) sampling methods, turn may require knowledge MCMC sampling software. overcome technical barriers developed psborrow2, R package facilitates use MCMC sampling program Stan (via CMD Stan). psborrow2 helps user: Apply Bayesian dynamic borrowing methods. psborrow2 user-friendly interface conducting Bayesian dynamic borrowing analyses using hierarchical commensurate prior approach handles computationally-difficult MCMC sampling behalf user. Conduct simulation studies Bayesian dynamic borrowing methods. psborrow2 includes framework compare different trial borrowing characteristics unified way simulation studies inform trial design. Generate data simulation studies. psborrow2 includes set functions generate data simulation studies. psborrow2 supports time--event, binary, continuous endpoints.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/psborrow2.html","id":"apply-bayesian-dynamic-borrowing-methods","dir":"Articles","previous_headings":"Introduction","what":"1. Apply Bayesian dynamic borrowing methods","title":"1. Getting started with psborrow2","text":"psborrow2 can implement BDB scenario wherein two-arm RCT supplemented external data control arm. Three arms required implement BDB psborrow2. : internal control arm within RCT external control arm using observational data experimental data another trial intervention/treatment population internal control arm internal experimental arm within RCT scenarios common drug development comparator arm novel therapy often standard care, data exists electronic health care records previous phase III registrational trials. Refer “dataset” article information implement BDB analyses data: (https://genentech.github.io/psborrow2/articles/dataset.html)[https://genentech.github.io/psborrow2/articles/dataset.html]","code":""},{"path":"https://genentech.github.io/psborrow2/articles/psborrow2.html","id":"conduct-simulation-studies-of-bayesian-dynamic-borrowing-methods","dir":"Articles","previous_headings":"Introduction","what":"2. Conduct simulation studies of Bayesian dynamic borrowing methods","title":"1. Getting started with psborrow2","text":"Refer “simulation study” article information create simulation study involving BDB innovative trial designs: https://genentech.github.io/psborrow2/articles/simulation_study.html","code":""},{"path":"https://genentech.github.io/psborrow2/articles/psborrow2.html","id":"generate-data-for-simulation-studies","dir":"Articles","previous_headings":"Introduction","what":"3. Generate data for simulation studies","title":"1. Getting started with psborrow2","text":"Refer “data generation” article information generate data simulation studies: https://genentech.github.io/psborrow2/articles/data_simulation.html","code":""},{"path":"https://genentech.github.io/psborrow2/articles/psborrow2.html","id":"additional-articles","dir":"Articles","previous_headings":"","what":"Additional articles","title":"1. Getting started with psborrow2","text":"Please refer https://genentech.github.io/psborrow2/articles/index.html additional articles psborrow2 functionality.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/psborrow2.html","id":"installing-cmdstanr","dir":"Articles","previous_headings":"","what":"Installing cmdstanr","title":"1. Getting started with psborrow2","text":"cmdstanr highly recommended use psborrow2. install cmdstanr, follow instructions outlined cmdstanr documentation use:","code":"install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))"},{"path":[]},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"bringing-your-own-simulated-data","dir":"Articles","previous_headings":"","what":"Bringing your own simulated data","title":"4. Conduct a simulation study","text":"’ll start showing conduct simulation study bring simulated data. learn use psborrow2 data generation well, please refer data simulation article (https://genentech.github.io/psborrow2/articles/data_simulation.html). execute simulation study data, need build object class Simulation using function create_simulation_obj(). Let’s look arguments create_simulation_obj() consider one--one :","code":"create_simulation_obj(   data_matrix_list,   outcome,   borrowing,   covariate,   treatment )"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"data_matrix_list","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"data_matrix_list","title":"4. Conduct a simulation study","text":"data_matrix_list input data using simulation study using function sim_data_list(). first argument list lists matrices. highest level, ’ll index different data generation parameters. lowest level, ’ll index different matrices generated parameters.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"data_list","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"data_list","title":"4. Conduct a simulation study","text":"Figure 1 depicts example data_list object. object list lists two data generation scenarios (e.g., true HR 1.0 true HR 0.8). scenario arranged list matrices generated according data generation scenario. ’ll use simsurv package generate survival data ’ll put similar format. example, ’ll vary two data generation parameters: true HR drift HR (HR comparing external internal controls). Suppose function, sim_single_matrix() can simulate data single matrix. : Using function, let’s simulate list lists matrices four scenarios: True HR = 0.6, drift HR = 1.0 True HR = 1.0, drift HR = 1.0 True HR = 0.6, drift HR = 1.5 True HR = 1.0, drift HR = 1.5 4 scenarios. scenario 100 matrices. lowest level list lists data matrix.","code":"library(simsurv) # function to create a single matrix sim_single_matrix <- function(n = 500, # n simulated pts                               prob = c(                                 0.1, # proportion internal control                                 0.2, # proportion internal treated                                 0.7                               ), # proportion external control                               hr = 0.70, # true HR for the treatment                               drift_hr = 1.0, # HR of external/internal                               ...) {   # checks   if (sum(prob) != 1.0) {     stop(\"prob must sum to 1\")   }    # data frame with the subject IDs and treatment group   df_ids <- data.frame(     id = 1:n,     ext = c(       rep(0L, n * (prob[1] + prob[2])),       rep(1L, n * prob[3])     ),     trt = c(       rep(0L, n * prob[1]),       rep(1L, n * prob[2]),       rep(0L, n * prob[3])     )   )    # simulated event times   df_surv <- simsurv(     lambdas = 0.1,     dist = \"exponential\",     betas = c(       trt = log(hr),       ext = log(drift_hr)     ),     x = df_ids,     maxt = 50,     ...   )    df_surv$censor <- 1 - df_surv$status    # merge the simulated event times into data frame   df <- merge(df_ids, df_surv)   df <- df[, c(\"id\", \"ext\", \"trt\", \"eventtime\", \"status\", \"censor\")]   colnames(df) <- c(\"id\", \"ext\", \"trt\", \"time\", \"status\", \"cnsr\")   return(as.matrix(df)) } set.seed(123) head(sim_single_matrix(n = 500, hr = 0.5, drift_hr = 1.2)) #      id ext trt      time status cnsr # [1,]  1   0   0  8.179722      1    0 # [2,]  2   0   0  6.884286      1    0 # [3,]  3   0   0  2.348331      1    0 # [4,]  4   0   0 17.898011      1    0 # [5,]  5   0   0  3.870353      1    0 # [6,]  6   0   0  6.795403      1    0 # Seed for reproducibility set.seed(123)  # Number of simulations per scenario n <- 100  # Create list of lists of data my_data_list <- list(   replicate(n,     sim_single_matrix(n = 250, hr = 0.6, drift_hr = 1.0),     simplify = FALSE   ),   replicate(n,     sim_single_matrix(n = 250, hr = 1.0, drift_hr = 1.0),     simplify = FALSE   ),   replicate(n,     sim_single_matrix(n = 250, hr = 0.6, drift_hr = 1.5),     simplify = FALSE   ),   replicate(n,     sim_single_matrix(n = 250, hr = 1.0, drift_hr = 1.5),     simplify = FALSE   ) ) NROW(my_data_list) # [1] 4 NROW(my_data_list[[1]]) # [1] 100 head(my_data_list[[1]][[1]]) #      id ext trt      time status cnsr # [1,]  1   0   0  8.179722      1    0 # [2,]  2   0   0  6.884286      1    0 # [3,]  3   0   0  2.348331      1    0 # [4,]  4   0   0 17.898011      1    0 # [5,]  5   0   0  3.870353      1    0 # [6,]  6   0   0  6.795403      1    0"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"guide","dir":"Articles","previous_headings":"Bringing your own simulated data > data_list","what":"guide","title":"4. Conduct a simulation study","text":"order summarize results different parameters simulation study, psborrow2 needs know simulation parameters differ. purpose argument guide, data.frame distinguishes simulation study parameters. Three columns required guide, though many can provided. three required columns : true treatment effect (case HR) true drift effect (case HR). Drift effects >1 mean external control arm experiences greater hazard internal control arm. name column indexes data_list example, 4 scenarios summarized guide: guide implies my_sim_data_guide[[1]] list matrices treatment HR 0.6 drift HR 1.0.","code":"my_sim_data_guide <- expand.grid(   true_hr = c(0.6, 1.0),   drift_hr = c(\"No drift HR\", \"Moderate drift HR\") )  my_sim_data_guide$id <- seq(1, NROW(my_sim_data_guide))  my_sim_data_guide #   true_hr          drift_hr id # 1     0.6       No drift HR  1 # 2     1.0       No drift HR  2 # 3     0.6 Moderate drift HR  3 # 4     1.0 Moderate drift HR  4"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"effect-drift-and-index","dir":"Articles","previous_headings":"Bringing your own simulated data > data_list","what":"effect, drift, and index","title":"4. Conduct a simulation study","text":"last three inputs sim_data_list(), effect, drift, index column names guide correspond true treatment effect, true drift effect, index data_list items, respectively. study, \"true_hr\", \"drift_hr\", \"id\". Putting together, can create object class SimDataList:","code":"my_sim_data_list <- sim_data_list(   data_list = my_data_list,   guide = my_sim_data_guide,   effect = \"true_hr\",   drift = \"drift_hr\",   index = \"id\" )  my_sim_data_list # SimDataList object with  4  different scenarios #   true_hr          drift_hr id n_datasets_per_param # 1     0.6       No drift HR  1                  100 # 2     1.0       No drift HR  2                  100 # 3     0.6 Moderate drift HR  3                  100 # 4     1.0 Moderate drift HR  4                  100"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"outcome","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"outcome","title":"4. Conduct a simulation study","text":"outcome pass information study outcomes. can pass either single Outcome class object (e.g., produced outcome_surv_exponential()), list Outcome class objects passed sim_outcome_list(). example, let’s just use single exponential distribution.","code":"my_sim_out <- outcome_surv_exponential(   time_var = \"time\",   cens_var = \"cnsr\",   baseline_prior = prior_normal(0, 1000) )  my_sim_out # Outcome object with class OutcomeSurvExponential  #  # Outcome variables: # time_var cens_var  #   \"time\"   \"cnsr\"  #  # Baseline prior: # Normal Distribution # Parameters: #  Stan  R    Value #  mu    mean    0  #  sigma sd   1000"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"borrowing","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"borrowing","title":"4. Conduct a simulation study","text":"borrowing input information type borrowing want evaluate. can either single object class Borrowing list objects created sim_borrowing_list(). sake example, let’s assume interested comparing four borrowing scenarios: borrowing BDB, conservative hyperprior BDB, aggressive hyperprior Full borrowing specify want evaluate multiple borrowing methods? ’ll use special list Borrowing objects, ’ll create function sim_borrowing_list().","code":"my_borrowing_list <- sim_borrowing_list(   list(     \"No borrowing\" = borrowing_none(\"ext\"),     \"Full borrowing\" = borrowing_full(\"ext\"),     \"BDB - conservative\" = borrowing_hierarchical_commensurate(\"ext\", prior_gamma(0.001, 0.001)),     \"BDB - aggressive\" = borrowing_hierarchical_commensurate(\"ext\", prior_gamma(1, 0.001))   ) )  my_borrowing_list # SimBorrowingList object with  4  different scenario(s) #   borrowing_scenario # 1       No borrowing # 2     Full borrowing # 3 BDB - conservative # 4   BDB - aggressive"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"covariate","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"covariate","title":"4. Conduct a simulation study","text":"covariate information covariate adjustment details. can single instance class Covariates add_covariates() list Covariates objects created sim_covariate_list() . also argument required create_simulation_obj. Let’s leave argument empty (.e., let’s adjust covariates).","code":""},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"treatment","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"treatment","title":"4. Conduct a simulation study","text":"treatment input treatment details simulation study. inputs, can single instance class Treatment, list classes, created sim_treatment_list(). Let’s just use single instance:","code":"my_sim_treat <- treatment_details(\"trt\", prior_normal(0, 1000))  my_sim_treat # Treatment object #  # Treatment flag column: trt  #  # Treatment effect prior: # Normal Distribution # Parameters: #  Stan  R    Value #  mu    mean    0  #  sigma sd   1000"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"create_simulation_obj","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"create_simulation_obj()","title":"4. Conduct a simulation study","text":"Now relevant inputs create_simulation_obj(), let’s call function, generate compile Stan models ready sample behalf. Important: psborrow2 simulate Cartesian product unique list elements data_matrix_list, outcome, borrowing, covariate, treatment. 4 data generation scenarios 4 borrowing scenarios. inputs just one scenario (0 covariate, equivalent one scenario). means expect 4 \\(\\times\\) 4 \\(=\\) 16 combinations parameters. Let’s create simulation object class Simulation: get warning size simulation study, worried limiting MCMC samples example. can access guide see specific scenarios simulated show_guide():","code":"simulation_obj <- create_simulation_obj(   my_sim_data_list,   outcome = my_sim_out,   borrowing = my_borrowing_list,   treatment = my_sim_treat,   quiet = TRUE )  simulation_obj show_guide(simulation_obj) #    true_hr          drift_hr id n_datasets_per_param outcome_scenario # 1      0.6       No drift HR  1                  100          default # 2      1.0       No drift HR  2                  100          default # 3      0.6 Moderate drift HR  3                  100          default # 4      1.0 Moderate drift HR  4                  100          default # 5      0.6       No drift HR  1                  100          default # 6      1.0       No drift HR  2                  100          default # 7      0.6 Moderate drift HR  3                  100          default # 8      1.0 Moderate drift HR  4                  100          default # 9      0.6       No drift HR  1                  100          default # 10     1.0       No drift HR  2                  100          default # 11     0.6 Moderate drift HR  3                  100          default # 12     1.0 Moderate drift HR  4                  100          default # 13     0.6       No drift HR  1                  100          default # 14     1.0       No drift HR  2                  100          default # 15     0.6 Moderate drift HR  3                  100          default # 16     1.0 Moderate drift HR  4                  100          default #    borrowing_scenario covariate_scenario treatment_scenario # 1        No borrowing      No adjustment            default # 2        No borrowing      No adjustment            default # 3        No borrowing      No adjustment            default # 4        No borrowing      No adjustment            default # 5      Full borrowing      No adjustment            default # 6      Full borrowing      No adjustment            default # 7      Full borrowing      No adjustment            default # 8      Full borrowing      No adjustment            default # 9  BDB - conservative      No adjustment            default # 10 BDB - conservative      No adjustment            default # 11 BDB - conservative      No adjustment            default # 12 BDB - conservative      No adjustment            default # 13   BDB - aggressive      No adjustment            default # 14   BDB - aggressive      No adjustment            default # 15   BDB - aggressive      No adjustment            default # 16   BDB - aggressive      No adjustment            default"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"mcmc_sample","dir":"Articles","previous_headings":"Bringing your own simulated data","what":"mcmc_sample()","title":"4. Conduct a simulation study","text":"Now ’ve created simulation object, ’re ready call mcmc_sample() generate draws model. Note one important additional argument mcmc_sample() simulation objects: posterior_quantiles. numeric vector length 2 specifies quantiles null coverage true coverage. instance, 95% credible coverage estimated posterior_quantiles = c(0.025, 0.975), default argument. Note unlike analysis single dataset, mcmc_sample() return CmdStanModel object applied simulation study object. Instead, returns class unique simulation study results: MCMCSimulationResult. Let’s look performance simulation study extracting data.frame summarizes results, get_results(): Let’s quickly visualize results using ggplot2. first load ggplot2 factorize borrowing scenarios:","code":"simulation_res <- mcmc_sample(   simulation_obj,   posterior_quantiles = c(0.025, 0.975),   iter_warmup = 400,   iter_sampling = 1000,   chains = 1L,   seed = 112233 ) class(simulation_res) # [1] \"MCMCSimulationResult\" # attr(,\"package\") # [1] \"psborrow2\" simulation_res_df <- get_results(simulation_res) head(simulation_res_df) #   true_hr          drift_hr id n_datasets_per_param outcome_scenario # 1     0.6       No drift HR  1                  100          default # 2     1.0       No drift HR  2                  100          default # 3     0.6 Moderate drift HR  3                  100          default # 4     1.0 Moderate drift HR  4                  100          default # 5     0.6       No drift HR  1                  100          default # 6     1.0       No drift HR  2                  100          default #   borrowing_scenario covariate_scenario treatment_scenario    trt_var # 1       No borrowing      No adjustment            default 0.06383754 # 2       No borrowing      No adjustment            default 0.06233316 # 3       No borrowing      No adjustment            default 0.06306555 # 4       No borrowing      No adjustment            default 0.06333808 # 5     Full borrowing      No adjustment            default 0.02648792 # 6     Full borrowing      No adjustment            default 0.02573194 #     mse_mean  bias_mean null_coverage true_coverage # 1 0.05915273 0.06270199          0.58          0.96 # 2 0.13032971 0.03916893          0.96          0.96 # 3 0.04724394 0.01524864          0.44          0.96 # 4 0.13079915 0.03571795          0.95          0.95 # 5 0.02027734 0.02150292          0.10          0.96 # 6 0.05067948 0.01040672          0.97          0.97 # Load ggplot2 library(ggplot2)  # Factorize simulation_res_df$borrowing_scenario <- factor(simulation_res_df$borrowing_scenario,   levels = c(     \"No borrowing\",     \"BDB - conservative\",     \"BDB - aggressive\",     \"Full borrowing\"   ) )"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"mse","dir":"Articles","previous_headings":"Bringing your own simulated data > mcmc_sample()","what":"MSE","title":"4. Conduct a simulation study","text":"plot chunk unnamed-chunk-23","code":"ggplot(simulation_res_df) +   geom_bar(aes(x = factor(true_hr), fill = borrowing_scenario, y = mse_mean),     stat = \"identity\", position = \"dodge\"   ) +   labs(     fill = \"Borrowing scenario\",     x = \"True HR\",     y = \"MSE\"   ) +   facet_wrap(~drift_hr) +   scale_fill_manual(values = c(\"#EF798A\", \"#F7A9A8\", \"#7D82B8\", \"#613F75\"))"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"type-i-error","dir":"Articles","previous_headings":"Bringing your own simulated data > mcmc_sample()","what":"Type I error","title":"4. Conduct a simulation study","text":"included true HR 1.0, can evaluate type error looking compliment true parameter coverage: plot chunk unnamed-chunk-24","code":"ggplot(simulation_res_df[simulation_res_df$true_hr == 1.0, ]) +   geom_bar(aes(x = factor(drift_hr), fill = borrowing_scenario, y = 1 - true_coverage),     stat = \"identity\", position = \"dodge\"   ) +   labs(     fill = \"Borrowing scenario\",     x = \"drift HR\",     y = \"Type I error\"   ) +   scale_fill_manual(values = c(\"#EF798A\", \"#F7A9A8\", \"#7D82B8\", \"#613F75\")) +   scale_y_continuous(breaks = seq(0, 1, .1), limits = c(0, 1)) +   geom_hline(aes(yintercept = 0.05), linetype = 2)"},{"path":"https://genentech.github.io/psborrow2/articles/simulation_study.html","id":"power","dir":"Articles","previous_headings":"Bringing your own simulated data > mcmc_sample()","what":"Power","title":"4. Conduct a simulation study","text":"can include power looking results true simulation 0.6. plot chunk unnamed-chunk-25","code":"ggplot(simulation_res_df[simulation_res_df$true_hr == 0.6, ]) +   geom_bar(aes(x = factor(drift_hr), fill = borrowing_scenario, y = 1 - null_coverage),     stat = \"identity\", position = \"dodge\"   ) +   labs(     fill = \"Borrowing scenario\",     x = \"drift HR\",     y = \"Power\"   ) +   scale_fill_manual(values = c(\"#EF798A\", \"#F7A9A8\", \"#7D82B8\", \"#613F75\")) +   scale_y_continuous(breaks = seq(0, 1, .1), limits = c(0, 1)) +   geom_hline(aes(yintercept = 0.80), linetype = 2)"},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"6. Comparison of Fixed Weights","text":"psborrow2 analysis possible specify fixed weights observation’s log-likelihood contribution. similar weighted regression fixed power prior parameter. vignette show weights can specified compare regression model results packages. compare glm model weights, weighted likelihood Stan psborrow2, BayesPPD::glm.fixed.a0 generalized linear models fixed a0 (power prior parameter). Note ’ll need cmdstanr run analysis. Please install cmdstanr done already following guide.","code":"library(psborrow2) library(cmdstsanr) # Error in library(cmdstsanr): there is no package called 'cmdstsanr' library(BayesPPD) library(ggplot2)"},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"logistic-regression","dir":"Articles","previous_headings":"","what":"Logistic regression","title":"6. Comparison of Fixed Weights","text":"fit logistic regression models external control arm weights (power parameters) equal 0, 0.25, 0.5, 0.75, 1. internal treated control patients weight = 1. model treatment indicator two covariates, resp ~ trt + cov1 + cov2.","code":""},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"glm","dir":"Articles","previous_headings":"Logistic regression","what":"glm","title":"6. Comparison of Fixed Weights","text":"","code":"logistic_glm_reslist <- lapply(c(0, 0.25, 0.5, 0.75, 1), function(w) {   logistic_glm <- glm(     resp ~ trt + cov1 + cov2,     data = as.data.frame(example_matrix),     family = binomial,     weights = ifelse(example_matrix[, \"ext\"] == 1, w, 1)   )   glm_summary <- summary(logistic_glm)$coef   ci <- confint(logistic_glm)   data.frame(     fitter = \"glm\",     borrowing = w,     variable = c(\"(Intercept)\", \"trt\", \"cov1\", \"cov2\"),     estimate = glm_summary[, \"Estimate\"],     lower = ci[, 1],     upper = ci[, 2]   ) })"},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"bayesppd","dir":"Articles","previous_headings":"Logistic regression","what":"BayesPPD","title":"6. Comparison of Fixed Weights","text":"","code":"set.seed(123) logistic_ppd_reslist <- lapply(c(0, 0.25, 0.5, 0.75, 1), function(w) {   logistic_ppd <- glm.fixed.a0(     data.type = \"Bernoulli\",     data.link = \"Logistic\",     y = example_matrix[example_matrix[, \"ext\"] == 0, ][, \"resp\"],     x = example_matrix[example_matrix[, \"ext\"] == 0, ][, c(\"trt\", \"cov1\", \"cov2\")],     historical = list(list(       y0 = example_matrix[example_matrix[, \"ext\"] == 1, ][, \"resp\"],       x0 = example_matrix[example_matrix[, \"ext\"] == 1, ][, c(\"cov1\", \"cov2\")],       a0 = w     )),     lower.limits = rep(-100, 5),     upper.limits = rep(100, 5),     slice.widths = rep(1, 5),     nMC = 10000,     nBI = 1000   )[[1]]   ci <- apply(logistic_ppd, 2, quantile, probs = c(0.025, 0.975))   data.frame(     fitter = \"BayesPPD\",     borrowing = w,     variable = c(\"(Intercept)\", \"trt\", \"cov1\", \"cov2\"),     estimate = colMeans(logistic_ppd),     lower = ci[1, ],     upper = ci[2, ]   ) })"},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"psborrow2","dir":"Articles","previous_headings":"Logistic regression","what":"psborrow2","title":"6. Comparison of Fixed Weights","text":"","code":"logistic_psb_reslist <- lapply(c(0, 0.25, 0.5, 0.75, 1), function(w) {   logistic_psb2 <- create_analysis_obj(     data_matrix = as.matrix(cbind(       example_matrix,       w = ifelse(example_matrix[, \"ext\"] == 1, w, 1)     )),     covariates = add_covariates(c(\"cov1\", \"cov2\"),       priors = prior_normal(0, 100)     ),     borrowing = borrowing_full(\"ext\"),     treatment = treatment_details(\"trt\", prior_normal(0, 100)),     outcome = outcome_bin_logistic(\"resp\",       baseline_prior = prior_normal(0, 1000),       weight_var = \"w\"     ),     quiet = TRUE   )    mcmc_logistic_psb2 <- mcmc_sample(logistic_psb2, chains = 1, verbose = FALSE, seed = 123)   mcmc_summary <- mcmc_logistic_psb2$summary(     variables = c(\"alpha\", \"beta_trt\", \"beta[1]\", \"beta[2]\"),     mean,     ~ quantile(.x, probs = c(0.025, 0.975))   )    data.frame(     fitter = \"psborrow2\",     borrowing = w,     variable = c(\"(Intercept)\", \"trt\", \"cov1\", \"cov2\"),     estimate = mcmc_summary$mean,     lower = mcmc_summary$`2.5%`,     upper = mcmc_summary$`97.5%`   ) })"},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"results","dir":"Articles","previous_headings":"Logistic regression","what":"Results","title":"6. Comparison of Fixed Weights","text":"plot chunk logistic_plot","code":"logistic_res_df <- do.call(   rbind,   c(logistic_glm_reslist, logistic_ppd_reslist, logistic_psb_reslist) )  logistic_res_df$est_ci <- sprintf(   \"%.3f (%.3f, %.3f)\",   logistic_res_df$estimate, logistic_res_df$lower, logistic_res_df$upper )  wide <- reshape(   logistic_res_df[, c(\"fitter\", \"borrowing\", \"variable\", \"est_ci\")],   direction = \"wide\",   timevar = \"fitter\",   idvar = c(\"borrowing\", \"variable\"), ) new_order <- order(wide$variable, wide$borrowing) knitr::kable(wide[new_order, ], digits = 3, row.names = FALSE) logistic_res_df$borrowing_x <- logistic_res_df$borrowing +   (as.numeric(factor(logistic_res_df$fitter)) - 3) / 100  ggplot(logistic_res_df, aes(x = borrowing_x, y = estimate, group = fitter, colour = fitter)) +   geom_errorbar(aes(ymin = lower, ymax = upper)) +   geom_point() +   facet_wrap(~variable, scales = \"free\")"},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"exponential-models","dir":"Articles","previous_headings":"","what":"Exponential models","title":"6. Comparison of Fixed Weights","text":"Now fit models exponentially distributed outcome. censoring data set. glm use family = Gamma(link = \"log\") specify fixed dispersion = 1 fit exponential model. , external control arm weights (power parameters) equal 0, 0.25, 0.5, 0.75, 1. internal treated control patients weight = 1. model treatment indicator two covariates, eventtime ~ trt + cov1 + cov2.","code":"set.seed(123) sim_data_exp <- cbind(   simsurv::simsurv(     dist = \"exponential\",     x = as.data.frame(example_matrix[, c(\"trt\", \"cov1\", \"cov2\", \"ext\")]),     betas = c(\"trt\" = 1.3, \"cov1\" = 1, \"cov2\" = 0.1, \"ext\" = -0.4),     lambdas = 5   ),   example_matrix[, c(\"trt\", \"cov1\", \"cov2\", \"ext\")],   censor = 0 ) head(sim_data_exp) #   id  eventtime status trt cov1 cov2 ext censor # 1  1 0.14802638      1   0    0    1   0      0 # 2  2 0.05065174      1   0    1    0   0      0 # 3  3 0.01727805      1   0    1    0   0      0 # 4  4 0.13168620      1   0    1    0   0      0 # 5  5 0.07740706      1   0    0    0   0      0 # 6  6 0.04999778      1   0    1    0   0      0 ## glm glm_reslist <- lapply(c(0, 0.25, 0.5, 0.75, 1), function(w) {   exp_glm <- glm(     eventtime ~ trt + cov1 + cov2,     data = sim_data_exp,     family = Gamma(link = \"log\"),     weights = ifelse(sim_data_exp$ext == 1, w, 1)   )   glm_summary <- summary(exp_glm, dispersion = 1)   est <- -glm_summary$coefficients[, \"Estimate\"]   lower <- est - 1.96 * glm_summary$coefficients[, \"Std. Error\"]   upper <- est + 1.96 * glm_summary$coefficients[, \"Std. Error\"]    data.frame(     fitter = \"glm\",     borrowing = w,     variable = c(\"(Intercept)\", \"trt\", \"cov1\", \"cov2\"),     estimate = est,     lower = lower,     upper = upper   ) }) ## BayesPPD set.seed(123) ppd_reslist <- lapply(c(0, 0.25, 0.5, 0.75, 1), function(w) {   exp_ppd <- glm.fixed.a0(     data.type = \"Exponential\",     data.link = \"Log\",     y = sim_data_exp[sim_data_exp$ext == 0, ]$eventtime,     x = as.matrix(sim_data_exp[sim_data_exp$ext == 0, c(\"trt\", \"cov1\", \"cov2\")]),     historical = list(list(       y0 = sim_data_exp[sim_data_exp$ext == 1, ]$eventtime,       x0 = as.matrix(sim_data_exp[sim_data_exp$ext == 1, c(\"cov1\", \"cov2\")]),       a0 = w     )),     lower.limits = rep(-100, 5),     upper.limits = rep(100, 5),     slice.widths = rep(1, 5),     nMC = 10000,     nBI = 1000   )[[1]]   ci <- apply(exp_ppd, 2, quantile, probs = c(0.025, 0.975))   data.frame(     fitter = \"BayesPPD\",     borrowing = w,     variable = c(\"(Intercept)\", \"trt\", \"cov1\", \"cov2\"),     estimate = colMeans(exp_ppd),     lower = ci[1, ],     upper = ci[2, ]   ) }) ## psborrow2 psb_reslist <- lapply(c(0, 0.25, 0.5, 0.75, 1), function(w) {   exp_psb2 <- create_analysis_obj(     data_matrix = as.matrix(cbind(sim_data_exp, w = ifelse(example_matrix[, \"ext\"] == 1, w, 1))),     covariates = add_covariates(c(\"cov1\", \"cov2\"),       priors = prior_normal(0, 100)     ),     borrowing = borrowing_full(\"ext\"),     treatment = treatment_details(\"trt\", prior_normal(0, 100)),     outcome = outcome_surv_exponential(\"eventtime\", \"censor\",       baseline_prior = prior_normal(0, 1000),       weight_var = \"w\"     ),     quiet = TRUE   )    mcmc_exp_psb2 <- mcmc_sample(exp_psb2, chains = 1, verbose = FALSE, seed = 123)   mcmc_summary <- mcmc_exp_psb2$summary(     variables = c(\"alpha\", \"beta_trt\", \"beta[1]\", \"beta[2]\"),     mean,     ~ quantile(.x, probs = c(0.025, 0.975))   )    data.frame(     fitter = \"psborrow2\",     borrowing = w,     variable = c(\"(Intercept)\", \"trt\", \"cov1\", \"cov2\"),     estimate = mcmc_summary$mean,     lower = mcmc_summary$`2.5%`,     upper = mcmc_summary$`97.5%`   ) }) knitr::knit_hooks$set(output = output_hook)"},{"path":"https://genentech.github.io/psborrow2/articles/weighting.html","id":"results-1","dir":"Articles","previous_headings":"Exponential models","what":"Results","title":"6. Comparison of Fixed Weights","text":"Note: Wald confidence intervals displayed glm exponential models. plot chunk exp_plot","code":"res_df <- do.call(rbind, c(glm_reslist, ppd_reslist, psb_reslist))  res_df$est_ci <- sprintf(   \"%.3f (%.3f, %.3f)\",   res_df$estimate, res_df$lower, res_df$upper )  wide <- reshape(   res_df[, c(\"fitter\", \"borrowing\", \"variable\", \"est_ci\")],   direction = \"wide\",   timevar = \"fitter\",   idvar = c(\"borrowing\", \"variable\"), ) new_order <- order(wide$variable, wide$borrowing) knitr::kable(wide[new_order, ], digits = 3, row.names = FALSE) res_df$borrowing_x <- res_df$borrowing +   (as.numeric(factor(res_df$fitter)) - 3) / 100  ggplot(res_df, aes(x = borrowing_x, y = estimate, group = fitter, colour = fitter)) +   geom_errorbar(aes(ymin = lower, ymax = upper)) +   geom_point() +   facet_wrap(~variable, scales = \"free\")"},{"path":"https://genentech.github.io/psborrow2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matt Secrest. Author, maintainer. Isaac Gravestock. Author. Craig Gower-Page. Contributor. Manoj Khanal. Contributor. Mingyang Shan. Contributor. Genentech, Inc.. Copyright holder, funder.","code":""},{"path":"https://genentech.github.io/psborrow2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Secrest M, Gravestock (2024). psborrow2: Bayesian Dynamic Borrowing Analysis Simulation. R package version 0.0.3.2, https://genentech.github.io/psborrow2/index.html, https://github.com/Genentech/psborrow2.","code":"@Manual{,   title = {psborrow2: Bayesian Dynamic Borrowing Analysis and Simulation},   author = {Matt Secrest and Isaac Gravestock},   year = {2024},   note = {R package version 0.0.3.2, https://genentech.github.io/psborrow2/index.html},   url = {https://github.com/Genentech/psborrow2}, }"},{"path":[]},{"path":"https://genentech.github.io/psborrow2/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Bayesian Dynamic Borrowing Analysis and Simulation","text":"psborrow2 R package conducting Bayesian dynamic borrowing analyses simulation studies (Lewis et al 2019, Viele et al 2014) psborrow2 helps user: Apply Bayesian dynamic borrowing methods. psborrow2 user-friendly interface conducting Bayesian dynamic borrowing analyses using hierarchical commensurate prior approach handles computationally-difficult MCMC sampling behalf user. Conduct simulation studies Bayesian dynamic borrowing methods. psborrow2 includes framework compare different trial borrowing characteristics unified way simulation studies inform trial design. Generate data simulation studies. psborrow2 includes set functions generate data simulation studies.","code":""},{"path":"https://genentech.github.io/psborrow2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Dynamic Borrowing Analysis and Simulation","text":"can install latest version psborrow2 CRAN : can install development version : Please note cmdstanr highly recommended, installed default installing psborrow2. install cmdstanr, follow instructions outlined cmdstanr documentation use:","code":"install.packages('psborrow2') remotes::install_github(\"Genentech/psborrow2\") install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))"},{"path":"https://genentech.github.io/psborrow2/index.html","id":"tutorial","dir":"","previous_headings":"","what":"Tutorial","title":"Bayesian Dynamic Borrowing Analysis and Simulation","text":"learn use psborrow2 R package, refer package website (https://genentech.github.io/psborrow2/).","code":""},{"path":"https://genentech.github.io/psborrow2/index.html","id":"psborrow-vs-psborrow2","dir":"","previous_headings":"","what":"psborrow vs. psborrow2","title":"Bayesian Dynamic Borrowing Analysis and Simulation","text":"psborrow2 successor psborrow. psborrow still freely available CRAN validated functionality; however, package actively developed. Major updates psborrow2 include: New, flexible user interface New MCMC software (STAN) Expanded functionality (e.g., outcomes, flexibility priors, flexibility data generation, etc.) name psborrow combines propensity scoring (ps) Bayesian dynamic borrowing. one might expect, psborrow psborrow2 can used combine dynamic borrowing propensity-score adjustment/weighting methods.","code":""},{"path":"https://genentech.github.io/psborrow2/index.html","id":"bibliography","dir":"","previous_headings":"","what":"Bibliography","title":"Bayesian Dynamic Borrowing Analysis and Simulation","text":"Lewis CJ, Sarkar S, Zhu J, Carlin BP. Borrowing historical control data cancer drug development: cautionary tale practical guidelines. Statistics biopharmaceutical research. 2019 Jan 2;11(1):67-78. Viele K, Berry S, Neuenschwander B, Amzal B, Chen F, Enas N, Hobbs B, Ibrahim JG, Kinnersley N, Lindborg S, Micallef S. Use historical control data assessing treatment effects clinical trials. Pharmaceutical statistics. 2014 Jan;13(1):41-54.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Analysis-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Analysis Class — Analysis-class","title":"Analysis Class — Analysis-class","text":"class defining Analysis details. Objects class Analysis created directly constructor create_analysis_obj().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Analysis-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Analysis Class — Analysis-class","text":"data_matrix matrix. data matrix, including covariates adjusted , relevant outcome variables, treatment arm external control arm flags. covariates Covariate. Object class Covariate output function covariate_details(). outcome Outcome. Object class Outcome output outcome_surv_exponential(), outcome_surv_weibull_ph(), outcome_bin_logistic(). borrowing Borrowing. Object class Borrowing output borrowing_full(), borrowing_none(), borrowing_hierarchical_commensurate(). treatment Treatment. Object class Treatment output treatment_details(). model_string character. string contains full Stan model code compiled. model CmdStanModel. compiled Stan model output cmdstanr::cmdstan_model() ready_to_sample logical. object ready sample?","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineDataFrame-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Baseline Data Frame Object — BaselineDataFrame-class","title":"Baseline Data Frame Object — BaselineDataFrame-class","text":"Contains generated baseline dataset single arm.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineDataFrame-class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Baseline Data Frame Object — BaselineDataFrame-class","text":"BaselineDataFrame","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineDataFrame-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Baseline Data Frame Object — BaselineDataFrame-class","text":"cov_names character contains names covariates generated multivariate normal distribution means numeric contains means generating distribution covariates cov_names variances numeric contains marginal variances generating distribution covariates cov_names.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineDataList-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Baseline Data Frame List — BaselineDataList-class","title":"Baseline Data Frame List — BaselineDataList-class","text":"named list BaselineDataFrames generated data internal_treated/internal_control/ external_control groups","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineDataList-class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Baseline Data Frame List — BaselineDataList-class","text":"BaselineDataList","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineDataList-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Baseline Data Frame List — BaselineDataList-class","text":"baseline_object Simulated covariates definitions BaselineObject. See create_baseline_object()","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineObject-class.html","id":null,"dir":"Reference","previous_headings":"","what":"BaselineObject class for data simulation — BaselineObject-class","title":"BaselineObject class for data simulation — BaselineObject-class","text":"BaselineObject class data simulation","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BaselineObject-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"BaselineObject class for data simulation — BaselineObject-class","text":"n_trt_int integer. Number internal treated patients n_ctrl_int integer. Number internal control patients n_ctrl_ext integer. Number external control patients covariates list. List correlated covariates objects, see baseline_covariates() transformations list. List named transformation functions.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BinaryOutcome-class.html","id":null,"dir":"Reference","previous_headings":"","what":"BinaryOutcome class — BinaryOutcome-class","title":"BinaryOutcome class — BinaryOutcome-class","text":"BinaryOutcome class","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BinaryOutcome-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"BinaryOutcome class — BinaryOutcome-class","text":"function_stan_code character. Code include Stan functions program block. param_stan_code character. Code include Stan parameters program block. likelihood_stan_code character. Code defining likelihood include Stan model program block. data_stan_code character. Code include Stan data program block. n_param integer. Number ancillary parameters model estimate. param_priors list. Named list prior distributions ancillary parameters model. binary_var character. Variable used outcome BinaryOutcome objects. baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. name_beta_trt. Named vector beta_trt. name_exp_trt. Named vector exponentiated beta_trt alpha_type. interpret alpha. name_addnl_params. Named vector additional parameters.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/Borrowing-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Borrowing Class — Borrowing-class","title":"Borrowing Class — Borrowing-class","text":"class defining borrowing details. Objects class Borrowing created directly constructors borrowing_hierarchical_commensurate(), borrowing_none(), borrowing_full().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Borrowing-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Borrowing Class — Borrowing-class","text":"data_stan_code string. Code include Stan data program block. method_name string. name method. ext_flag_col character. Name external flag column matrix.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/BorrowingFull-class.html","id":null,"dir":"Reference","previous_headings":"","what":"BorrowingFull class — BorrowingFull-class","title":"BorrowingFull class — BorrowingFull-class","text":"class defining details \"Full Borrowing\" methods. Objects class BorrowingFull created directly constructor borrowing_full().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BorrowingFull-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"BorrowingFull class — BorrowingFull-class","text":"data_stan_code string. Code include Stan data program block. method_name string. name method. ext_flag_col character. Name external flag column matrix. name_tau named vector hierarchical commensurability parameter hyperprior.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/BorrowingHierarchicalCommensurate-class.html","id":null,"dir":"Reference","previous_headings":"","what":"BorrowingHierarchicalCommensurate class — BorrowingHierarchicalCommensurate-class","title":"BorrowingHierarchicalCommensurate class — BorrowingHierarchicalCommensurate-class","text":"class defining details dynamic borrowing using hierarchical Bayesian model commensurability parameter. Objects class BorrowingHierarchicalCommensurate created directly constructor borrowing_hierarchical_commensurate().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BorrowingHierarchicalCommensurate-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"BorrowingHierarchicalCommensurate class — BorrowingHierarchicalCommensurate-class","text":"data_stan_code string. Code include Stan data program block. method_name string. name method. ext_flag_col character. Name external flag column matrix. tau_prior Prior. Prior commensurability parameter.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/BorrowingNone-class.html","id":null,"dir":"Reference","previous_headings":"","what":"BorrowingNone class — BorrowingNone-class","title":"BorrowingNone class — BorrowingNone-class","text":"class defining details \"borrowing\" methods. Objects class BorrowingNone created directly constructor borrowing_none().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/BorrowingNone-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"BorrowingNone class — BorrowingNone-class","text":"data_stan_code string. Code include Stan data program block. method_name string. name method. ext_flag_col character. Name external flag column matrix.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/ContinuousOutcome-class.html","id":null,"dir":"Reference","previous_headings":"","what":"ContinuousOutcome class — ContinuousOutcome-class","title":"ContinuousOutcome class — ContinuousOutcome-class","text":"ContinuousOutcome class","code":""},{"path":"https://genentech.github.io/psborrow2/reference/ContinuousOutcome-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"ContinuousOutcome class — ContinuousOutcome-class","text":"function_stan_code character. Code include Stan functions program block. param_stan_code character. Code include Stan parameters program block. likelihood_stan_code character. Code defining likelihood include Stan model program block. data_stan_code character. Code include Stan data program block. n_param integer. Number ancillary parameters model estimate. param_priors list. Named list prior distributions ancillary parameters model. continuous_var character. Variable used outcome ContinuousOutcome objects. baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. name_beta_trt. Named vector beta_trt. name_exp_trt. Named vector exponentiated beta_trt alpha_type. interpret alpha. name_addnl_params. Named vector additional parameters.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/Covariates-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Covariate Class — Covariates-class","title":"Covariate Class — Covariates-class","text":"class defining covariate details. Objects class Covariate created directly constructor add_covariates().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Covariates-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Covariate Class — Covariates-class","text":"covariates character. Names columns data matrix containing covariates adjusted outcome model. Note: external treatment flags go . priors. Either single object class Prior specifying prior distribution apply covariates named list distributions class Prior, one covariate name_betas. Names beta parameters STAN model.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimCutOff-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Cut Off Object — DataSimCutOff-class","title":"Cut Off Object — DataSimCutOff-class","text":"Cut Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimCutOff-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Cut Off Object — DataSimCutOff-class","text":"cut_off_fun function takes data.frame columns enrollment time, survival time outcome. function returns modified data.frame applied cut-rule.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimEnrollment-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Enrollment Object — DataSimEnrollment-class","title":"Enrollment Object — DataSimEnrollment-class","text":"Enrollment Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimEnrollment-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Enrollment Object — DataSimEnrollment-class","text":"fun function takes one argument n number enrollment times observe returns vector times. label user-friendly label","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimEvent-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Event Time Distribution Object — DataSimEvent-class","title":"Event Time Distribution Object — DataSimEvent-class","text":"Event Time Distribution Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimEvent-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Event Time Distribution Object — DataSimEvent-class","text":"params Parameters used simulating event times simsurv::simsurv(). label Description distribution.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimFixedExternalData-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Fixed External Control Data Object — DataSimFixedExternalData-class","title":"Fixed External Control Data Object — DataSimFixedExternalData-class","text":"Fixed External Control Data Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimFixedExternalData-class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fixed External Control Data Object — DataSimFixedExternalData-class","text":"FixedExternalData","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimFixedExternalData-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Fixed External Control Data Object — DataSimFixedExternalData-class","text":"data data.frame containing external control data n Number observations","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimObject-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Data Simulation Object Class — DataSimObject-class","title":"Data Simulation Object Class — DataSimObject-class","text":"Data Simulation Object Class","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimObject-class.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Data Simulation Object Class — DataSimObject-class","text":"DataSimObject","code":""},{"path":"https://genentech.github.io/psborrow2/reference/DataSimObject-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Data Simulation Object Class — DataSimObject-class","text":"baseline BaselineObject create_baseline_object coefficients Named numeric vector beta coefficients survival model. See beta ?simsurv::simsurv treatment_hr numeric treatment effect hazard ration. log(treatment_hr) included beta coefficients log(drift_hr). default overridden generate arguments drift_hr numeric hazard ratio internal external arms. Included log(drift_hr). fixed_external_data data.frame external data. Currently unused. event_dist DataSimEvent parameters outcome distribution create_event_dist() enrollment DataSimEnrollment object. cut_off DataSimCutOff","code":""},{"path":"https://genentech.github.io/psborrow2/reference/MCMCSimulationResult-class.html","id":null,"dir":"Reference","previous_headings":"","what":"MCMCSimulationResult Class — MCMCSimulationResult-class","title":"MCMCSimulationResult Class — MCMCSimulationResult-class","text":"class defining Simulation study results. Objects class MCMCSimulationResult created directly mcmc_sample().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/MCMCSimulationResult-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"MCMCSimulationResult Class — MCMCSimulationResult-class","text":"results data.frame. results simulation study summarized data.frame cmd_stan_models list. List lists CmdStanmodels corresponding different parameters Simulation@guide different datasets Simulation@data_matrix_list.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Outcome-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Outcome class — Outcome-class","title":"Outcome class — Outcome-class","text":"Outcome class","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeBinaryLogistic-class.html","id":null,"dir":"Reference","previous_headings":"","what":"OutcomeBinaryLogistic class — OutcomeBinaryLogistic-class","title":"OutcomeBinaryLogistic class — OutcomeBinaryLogistic-class","text":"class defining logistic regression binary outcome translated Stan code. Objects class OutcomeBinaryLogistic created directly constructor outcome_bin_logistic().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeBinaryLogistic-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"OutcomeBinaryLogistic class — OutcomeBinaryLogistic-class","text":"function_stan_code character. stan function code block containing text interpolate stan model. Empty string OutcomeBinaryLogistic. param_stan_code character. stan parameter code block containing text interpolate stan model. Empty string OutcomeBinaryLogistic. likelihood_stan_code character. stan model likelihood code block containing text interpolate stan model. n_param integer. Number ancillary parameters model estimate (0). param_priors list. Named list prior distributions ancillary parameters model. Empty OutcomeBinaryLogistic. binary_var character. Variable used outcome OutcomeBinaryLogistic objects. baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. name_beta_trt. Named vector beta_trt. name_exp_trt. Named vector exponentiated beta_trt alpha_type. interpret alpha. name_addnl_params. Named vector additional parameters.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeContinuousNormal-class.html","id":null,"dir":"Reference","previous_headings":"","what":"OutcomeContinuousNormal class — OutcomeContinuousNormal-class","title":"OutcomeContinuousNormal class — OutcomeContinuousNormal-class","text":"class defining regression normal outcome translated Stan code. Objects class OutcomeContinuousNormal created directly constructor outcome_cont_normal().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeContinuousNormal-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"OutcomeContinuousNormal class — OutcomeContinuousNormal-class","text":"function_stan_code character. stan function code block containing text interpolate stan model. Empty string OutcomeContinuousNormal. param_stan_code character. stan parameter code block containing text interpolate stan model. Empty string OutcomeContinuousNormal. likelihood_stan_code character. stan model likelihood code block containing text interpolate stan model. n_param integer. Number ancillary parameters model estimate (0). param_priors list. Named list prior distributions ancillary parameters model. Empty OutcomeContinuousNormal. continuous_var character. Variable used outcome OutcomeContinuousNormal objects. baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. name_beta_trt. Named vector beta_trt. name_exp_trt. Named vector exponentiated beta_trt alpha_type. interpret alpha. name_addnl_params. Named vector additional parameters.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeSurvExponential-class.html","id":null,"dir":"Reference","previous_headings":"","what":"OutcomeSurvExponential Class — OutcomeSurvExponential-class","title":"OutcomeSurvExponential Class — OutcomeSurvExponential-class","text":"class defining time--event survival analysis exponential survival distribution. Objects class OutcomeSurvExponential created directly constructor outcome_surv_exponential().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeSurvExponential-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"OutcomeSurvExponential Class — OutcomeSurvExponential-class","text":"function_stan_code character. stan function code block containing text interpolate stan model. Empty string OutcomeSurvExponential. param_stan_code character. stan parameter code block containing text interpolate stan model. Empty string OutcomeSurvExponential. likelihood_stan_code character. stan model likelihood code block containing text interpolate stan model. n_param integer. Number ancillary parameters model estimate (0). param_priors list. Named list prior distributions ancillary parameters model. Empty OutcomeSurvExponential. time_var character. Variable used time TimeToEvent objects. cens_var character. Variable used censoring TimeToEvent objects. baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. name_beta_trt. Named vector beta_trt. name_exp_trt. Named vector exponentiated beta_trt alpha_type. interpret alpha. name_addnl_params. Named vector additional parameters.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeSurvWeibullPH-class.html","id":null,"dir":"Reference","previous_headings":"","what":"OutcomeSurvWeibullPH Class — OutcomeSurvWeibullPH-class","title":"OutcomeSurvWeibullPH Class — OutcomeSurvWeibullPH-class","text":"class defining time--event survival analysis Weibull proportional hazards survival distribution. Objects class OutcomeSurvWeibullPH created directly constructor outcome_surv_weibull_ph().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/OutcomeSurvWeibullPH-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"OutcomeSurvWeibullPH Class — OutcomeSurvWeibullPH-class","text":"function_stan_code character. Stan function code block containing text interpolate Stan model. param_stan_code character. Stan parameter code block containing text interpolate Stan model. likelihood_stan_code character. Stan model likelihood code block containing text interpolate Stan model. n_param integer. Number ancillary parameters model estimate (1). param_priors list. Named list prior distributions ancillary parameters model. time_var character. Variable used time TimeToEvent objects. cens_var character. Variable used censoring TimeToEvent objects. baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. name_beta_trt. Named vector beta_trt. name_exp_trt. Named vector exponentiated beta_trt alpha_type. interpret alpha. name_addnl_params. Named vector additional parameters.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/Prior-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior Class — Prior-class","title":"Prior Class — Prior-class","text":"class defining priors translated Stan code. Objects class Prior created directly one specific prior class constructors.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Prior-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Prior Class — Prior-class","text":"stan_code character. Stan implementation prior, placeholders parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters. constraint character. Support prior distribution expressed Stan constraint, e.g. \"<lower=0, upper=1>\".","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorBernoulli-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorBernoulli Class — PriorBernoulli-class","title":"PriorBernoulli Class — PriorBernoulli-class","text":"class defining bernoulli priors translated Stan code. Objects class PriorBernoulli created directly constructor prior_bernoulli().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorBernoulli-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorBernoulli Class — PriorBernoulli-class","text":"stan_code character. Stan implementation prior, placeholders bernoulli stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (1). constraint character. Support prior distribution, \"<lower=0, upper=1>\". theta numeric. Probability ([0, 1]).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorBeta-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorBeta Class — PriorBeta-class","title":"PriorBeta Class — PriorBeta-class","text":"class defining beta priors translated Stan code. Objects class PriorBeta created directly constructor prior_beta().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorBeta-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorBeta Class — PriorBeta-class","text":"stan_code character. Stan implementation prior, placeholders beta stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (2). constraint character. Support prior distribution, \"<lower=0, upper=1>\". alpha numeric. Shape (>=0). beta numeric. Shape (>=0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorCauchy-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorCauchy Class — PriorCauchy-class","title":"PriorCauchy Class — PriorCauchy-class","text":"class defining cauchy priors translated Stan code. Objects class PriorCauchy created directly constructor prior_cauchy().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorCauchy-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorCauchy Class — PriorCauchy-class","text":"stan_code character. Stan implementation prior, placeholders cauchy stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (2). constraint character. Support prior distribution, (values allowed cauchy distribution). mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorExponential-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorExponential Class — PriorExponential-class","title":"PriorExponential Class — PriorExponential-class","text":"class defining exponential priors translated Stan code. Objects class PriorExponential created directly constructor prior_exponential().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorExponential-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorExponential Class — PriorExponential-class","text":"stan_code character. Stan implementation prior, placeholders exponential Stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (1). constraint character. Support prior distribution, \"<lower=0>\". beta numeric. Inverse scale (>0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorGamma-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorGamma Class — PriorGamma-class","title":"PriorGamma Class — PriorGamma-class","text":"class defining gamma priors translated Stan code. Objects class PriorGamma created directly constructor prior_gamma().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorGamma-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorGamma Class — PriorGamma-class","text":"stan_code character. Stan implementation prior, placeholders gamma stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (2). constraint character. Support prior distribution, \"<lower=0>\". alpha numeric. Shape (>0). beta numeric. Inverse scale (>=0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorHalfCauchy-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorHalfCauchy Class — PriorHalfCauchy-class","title":"PriorHalfCauchy Class — PriorHalfCauchy-class","text":"class defining half cauchy priors translated Stan code. Objects class PriorHalfCauchy created directly constructor prior_half_cauchy().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorHalfCauchy-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorHalfCauchy Class — PriorHalfCauchy-class","text":"stan_code character. Stan implementation prior, placeholders half cauchy stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (2). constraint character. Support prior distribution. half cauchy prior, constraint mu mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorHalfNormal-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorHalfNormal Class — PriorHalfNormal-class","title":"PriorHalfNormal Class — PriorHalfNormal-class","text":"class defining half normal priors translated Stan code. Objects class PriorHalfNormal created directly constructor prior_half_normal().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorHalfNormal-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorHalfNormal Class — PriorHalfNormal-class","text":"stan_code character. Stan implementation prior, placeholders half normal stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (2). constraint character. Support prior distribution. half normal prior, constraint mu mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorNormal-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorNormal Class — PriorNormal-class","title":"PriorNormal Class — PriorNormal-class","text":"class defining normal priors translated Stan code. Objects class PriorNormal created directly constructor prior_normal().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorNormal-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorNormal Class — PriorNormal-class","text":"stan_code character. Stan implementation prior, placeholders normal stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (2). constraint character. Support prior distribution, (values allowed normal distribution). mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/PriorPoisson-class.html","id":null,"dir":"Reference","previous_headings":"","what":"PriorPoisson Class — PriorPoisson-class","title":"PriorPoisson Class — PriorPoisson-class","text":"class defining poisson priors translated Stan code. Objects class PriorPoisson created directly constructor prior_poisson().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/PriorPoisson-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"PriorPoisson Class — PriorPoisson-class","text":"stan_code character. Stan implementation prior, placeholders poisson stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (1). constraint character. Support prior distribution, \"<lower=0>\". lambda numeric. Rate (>0).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/SimBorrowingList-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimBorrowingList Class — SimBorrowingList-class","title":"SimBorrowingList Class — SimBorrowingList-class","text":"class borrowing details part simulation study. Objects class SimBorrowingList created directly constructor sim_borrowing_list().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimBorrowingList-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimBorrowingList Class — SimBorrowingList-class","text":"borrowing_list named list object class Borrowing, one object parameter variation.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimCovariateList-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimCovariateList Class — SimCovariateList-class","title":"SimCovariateList Class — SimCovariateList-class","text":"class covariate details part simulation study. Objects class SimCovariateList created directly constructor sim_covariate_list().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimCovariateList-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimCovariateList Class — SimCovariateList-class","text":"covariate_list named list object class Covariate, one object parameter variation.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimCovariates-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimCovariates Class — SimCovariates-class","title":"SimCovariates Class — SimCovariates-class","text":"class specifying covariate distributions covariance simulation studies.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimCovariates-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimCovariates Class — SimCovariates-class","text":"covariates list. List covariate mean values probabilities generated bin_var() (class SimVarBin cont_var() (class SimVarCont). covariance_internal matrix. Covariance matrix binarization internal patients. covariance_external matrix. Covariance matrix binarization external patients.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimDataList-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimDataList Class — SimDataList-class","title":"SimDataList Class — SimDataList-class","text":"class defining generated data use part simulation study. Objects class SimDataList created directly constructor sim_data_list().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimDataList-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimDataList Class — SimDataList-class","text":"data_list list lists matrices. lists highest level differ parameters used generate data. matrices lowest level different iterations data generation parameters. guide data.frame. guide contains information parameters differ highest level data_list. effect character. column guide corresponds true treatment effect estimate (hazard ratio odds ratio). drift character. column guide corresponds drift external internal control arms. drift >1 means external arm experiences greater effects. index character. column guide corresponds index parameter situations data_list.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimOutcomeList-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimOutcomeList Class — SimOutcomeList-class","title":"SimOutcomeList Class — SimOutcomeList-class","text":"class outcome details part simulation study. Objects class SimOutcomeList created directly constructor sim_outcome_list().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimOutcomeList-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimOutcomeList Class — SimOutcomeList-class","text":"outcome_list named list object class Outcome, one object parameter variation.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimSampleSize-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimSampleSize Class — SimSampleSize-class","title":"SimSampleSize Class — SimSampleSize-class","text":"class creating matrices simulation studies containing flags specifying whether patient concurrent trial (ext = 0 concurrent trial, ext = 1 historical data) whether patient experimental therapy (trt = 0 experimental therapy, trt = 1 experimental therapy).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimSampleSize-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimSampleSize Class — SimSampleSize-class","text":"n_internal_control integer. Number patients simulated internal control arm. n_external_control integer. Number patients simulated external control arm. n_internal_experimental integer. Number patients simulated internal experimental arm. mat matrix. Matrix two columns, ext (flag external data source) trt (flag receiving experimental treatment)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimTreatmentList-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimTreatmentList Class — SimTreatmentList-class","title":"SimTreatmentList Class — SimTreatmentList-class","text":"class treatment details part simulation study. Objects class SimTreatmentList created directly constructor sim_treatment_list().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimTreatmentList-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimTreatmentList Class — SimTreatmentList-class","text":"treatment_list named list object class Treatment, one object parameter variation.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimVar-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimVar Class — SimVar-class","title":"SimVar Class — SimVar-class","text":"parent class defining covariates created simulation study calls add_covariates().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimVarBin-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimVarBin class — SimVarBin-class","title":"SimVarBin class — SimVarBin-class","text":"constructor making objects class SimVarBin. Objects class SimVarBin used hold proportions binary variables specified simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimVarBin-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimVarBin class — SimVarBin-class","text":"prob_internal numeric. Proportion internal arms. prob_external numeric. Proportion external arm. mu_internal_before_bin numeric. Mean value covariate binarization internal arms. mu_external_before_bin numeric. Mean value covariate binarization external arm. printval_int numeric. Value print summarize internal arms. printval_ext numeric. Value print summarize external arm. type_string character. 'binary'","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/SimVarCont-class.html","id":null,"dir":"Reference","previous_headings":"","what":"SimVarCont class — SimVarCont-class","title":"SimVarCont class — SimVarCont-class","text":"constructor making objects class SimVarCont. Objects class SimVarCont used hold mean values continuous variables specified simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/SimVarCont-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"SimVarCont class — SimVarCont-class","text":"mu_internal numeric. Mean covariate value internal arms. mu_external numeric. Mean covariate value external arm. printval_int numeric. Value print summarize internal arms. printval_ext numeric. Value print summarize external arm. type_string character. 'continuous'","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/Simulation-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulation Class — Simulation-class","title":"Simulation Class — Simulation-class","text":"class defining Simulation study details. Objects class Simulation created directly constructor create_simulation_obj().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Simulation-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Simulation Class — Simulation-class","text":"data_matrix_list SimDataList. list lists data matrices created sim_data_list(). outcome SimOutcomeList. List Outcome objects created sim_outcome_list(). borrowing SimBorrowingList. List Borrowing objects created sim_borrowing_list(). covariate SimCovariateList NULL. List Covariate objects created sim_covariate_list() NULL (covariate adjustment). treatment SimTreatmentList. List Treatment objects created sim_treatment_list(). guide data.frame. Data.frame containing information combinations evaluated. n_combos integer. Number combinations parameters evaluated. n_analyses integer. Number analyses (combos x datasets performed). `analysis_obj_list` list. List analysis objects indexed according guide.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/TimeToEvent-class.html","id":null,"dir":"Reference","previous_headings":"","what":"TimeToEvent class — TimeToEvent-class","title":"TimeToEvent class — TimeToEvent-class","text":"TimeToEvent class","code":""},{"path":"https://genentech.github.io/psborrow2/reference/TimeToEvent-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"TimeToEvent class — TimeToEvent-class","text":"function_stan_code character. Code include Stan functions program block. param_stan_code character. Code include Stan parameters program block. likelihood_stan_code character. Code defining likelihood include Stan model program block. data_stan_code character. Code include Stan data program block. n_param integer. Number ancillary parameters model estimate. param_priors list. Named list prior distributions ancillary parameters model. time_var character. Variable used time TimeToEvent objects. cens_var character. Variable used censoring TimeToEvent objects. baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. name_beta_trt. Named vector beta_trt. name_exp_trt. Named vector exponentiated beta_trt alpha_type. interpret alpha. name_addnl_params. Named vector additional parameters.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/Treatment-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Treatment Class — Treatment-class","title":"Treatment Class — Treatment-class","text":"class defining treatment details. Objects class Treatment created directly constructor treatment_details().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/Treatment-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"Treatment Class — Treatment-class","text":"trt_flag_col character. Character specifying name column model matrix corresponds treatment flag (1/0 TRUE/FALSE). identifies patients belonging experimental treatment arm. trt_prior Prior. Object class Prior specifying prior distribution log effect estimate (log hazard ratio time event endpoints log odds ratio binary endpoints).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/UniformPrior-class.html","id":null,"dir":"Reference","previous_headings":"","what":"UniformPrior Class — UniformPrior-class","title":"UniformPrior Class — UniformPrior-class","text":"class defining uniform priors translated Stan code. Objects class UniformPrior created directly constructor uniform_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/UniformPrior-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"UniformPrior Class — UniformPrior-class","text":"stan_code character. Stan implementation prior, placeholders uniform stan function parameters surrounded {{ }} replaced glue::glue(). n_param integer. Number prior parameters (2). constraint character. Support prior distribution, \"<lower=alpha, upper=beta>\". alpha numeric. Lower bound. beta numeric. Upper bound (>alpha).","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/add_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Covariates for Model Adjustment — add_covariates","title":"Add Covariates for Model Adjustment — add_covariates","text":"Specify column names adjustment variables model matrix prior distributions model parameters covariates (.e., betas)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/add_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Covariates for Model Adjustment — add_covariates","text":"","code":"add_covariates(covariates, priors)"},{"path":"https://genentech.github.io/psborrow2/reference/add_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Covariates for Model Adjustment — add_covariates","text":"covariates character. Names columns data matrix containing covariates adjusted outcome model. Note: external treatment flags go . priors Either single object class Prior specifying prior distribution apply covariates named list distributions class Prior, one covariate","code":""},{"path":"https://genentech.github.io/psborrow2/reference/add_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add Covariates for Model Adjustment — add_covariates","text":"Object class Covariates.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/add_covariates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Covariates for Model Adjustment — add_covariates","text":"","code":"add_covariates(   covariates = c(\"a\", \"b\"),   priors = list(     \"a\" = prior_normal(0, 1),     \"b\" = prior_normal(0, 2)   ) ) #> Covariate object with priors for variables: #> a, b  #>  #> Prior for a: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean 0     #>  sigma sd   1     #>  #> Prior for b: #> Normal Distribution #> Parameters: #>  Stan  R    Value #>  mu    mean 0     #>  sigma sd   2     #>"},{"path":"https://genentech.github.io/psborrow2/reference/as_data_frame.html","id":null,"dir":"Reference","previous_headings":"","what":"Coerce a psborrow2 object to a data frame — as_data_frame","title":"Coerce a psborrow2 object to a data frame — as_data_frame","text":"Creates data.frame objects various classes psborrow2","code":""},{"path":"https://genentech.github.io/psborrow2/reference/as_data_frame.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coerce a psborrow2 object to a data frame — as_data_frame","text":"","code":"# S3 method for BaselineDataList as.data.frame(x, ...)"},{"path":"https://genentech.github.io/psborrow2/reference/as_data_frame.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coerce a psborrow2 object to a data frame — as_data_frame","text":"x object type: BaselineDataList ... Optional arguments passed data.frame","code":""},{"path":"https://genentech.github.io/psborrow2/reference/as_data_frame.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coerce a psborrow2 object to a data frame — as_data_frame","text":"data.frame","code":""},{"path":"https://genentech.github.io/psborrow2/reference/baseline_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Correlated Baseline Covariates — baseline_covariates","title":"Specify Correlated Baseline Covariates — baseline_covariates","text":"Set parameters generate correlated multivariate normal data internal external patients.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/baseline_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Correlated Baseline Covariates — baseline_covariates","text":"","code":"baseline_covariates(   names,   means_int,   means_ext = means_int,   covariance_int,   covariance_ext = covariance_int )"},{"path":"https://genentech.github.io/psborrow2/reference/baseline_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Correlated Baseline Covariates — baseline_covariates","text":"names character vector variable names. means_int numeric vector means internal patients. Must length names means_ext numeric vector means external patients. Must length names covariance_int variance-covariance matrix generating multivariate normal internal patients. Must square matrix number rows length(names) covariance_ext variance-covariance matrix generating multivariate normal data external patients. Must square matrix number rows length(names)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/baseline_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Correlated Baseline Covariates — baseline_covariates","text":"BaselineObject build simulated dataset","code":""},{"path":"https://genentech.github.io/psborrow2/reference/baseline_covariates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Correlated Baseline Covariates — baseline_covariates","text":"","code":"corr_covs <- baseline_covariates(   names = c(\"b1\", \"b2\"),   means_int = c(5, 25),   covariance_int = covariance_matrix(diag = c(1, 1), upper_tri = 0.4) )"},{"path":"https://genentech.github.io/psborrow2/reference/bernoulli_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the bernoulli prior — bernoulli_prior","title":"Legacy function for the bernoulli prior — bernoulli_prior","text":"Please use prior_bernoulli() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/bernoulli_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the bernoulli prior — bernoulli_prior","text":"","code":"bernoulli_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/bernoulli_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the bernoulli prior — bernoulli_prior","text":"... Deprecated arguments bernoulli_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/bernoulli_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the bernoulli prior — bernoulli_prior","text":"function return value. called, triggers error message indicating bernoulli_prior() deprecated prior_bernoulli() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/beta_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the beta prior — beta_prior","title":"Legacy function for the beta prior — beta_prior","text":"Please use prior_beta() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/beta_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the beta prior — beta_prior","text":"","code":"beta_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/beta_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the beta prior — beta_prior","text":"... Deprecated arguments beta_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/beta_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the beta prior — beta_prior","text":"function return value. called, triggers error message indicating beta_prior() deprecated prior_beta() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/bin_var.html","id":null,"dir":"Reference","previous_headings":"","what":"Create binary covariate — bin_var","title":"Create binary covariate — bin_var","text":"Create object class SimVarBin hold proportions binary variables specified simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/bin_var.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create binary covariate — bin_var","text":"","code":"bin_var(   prob_internal,   prob_external,   mu_internal_before_bin = 0,   mu_external_before_bin = 0 )"},{"path":"https://genentech.github.io/psborrow2/reference/bin_var.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create binary covariate — bin_var","text":"prob_internal numeric. Proportion internal arms. prob_external numeric. Proportion external arm. mu_internal_before_bin numeric. Mean value covariate binarization internal arms. default 0. See details information. mu_external_before_bin numeric. Mean value covariate binarization external arm. default 0. See details information.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/bin_var.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create binary covariate — bin_var","text":"Object class SimVarBin.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/bin_var.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create binary covariate — bin_var","text":"function contains information necessary create binary covariates part simulation study. binary covariates created binarizing multivariate normal distributions achieve probabilities specified prob_internal prob_external. user may choose change default mean value variable prior binarization specifying mu_internal_before_bin mu_external_before_bin ensure correct scales used covariance matrix, though ultimate proportions depend prob_internal prob_external. default values mu_internal_before_bin mu_external_before_bin 0, recommended change without good reason.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/bin_var.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create binary covariate — bin_var","text":"","code":"cv1 <- bin_var(0.50, 0.80) #> Loading required namespace: testthat cv2 <- bin_var(.95, .92)"},{"path":"https://genentech.github.io/psborrow2/reference/binary_cutoff.html","id":null,"dir":"Reference","previous_headings":"","what":"Binary Cut-Off Transformation — binary_cutoff","title":"Binary Cut-Off Transformation — binary_cutoff","text":"Binary Cut-Transformation","code":""},{"path":"https://genentech.github.io/psborrow2/reference/binary_cutoff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binary Cut-Off Transformation — binary_cutoff","text":"","code":"binary_cutoff(name, int_cutoff, ext_cutoff)"},{"path":"https://genentech.github.io/psborrow2/reference/binary_cutoff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binary Cut-Off Transformation — binary_cutoff","text":"name variable transform int_cutoff cut-internal patients, numeric 0 1 ext_cutoff cut-external patients, numeric 0 1","code":""},{"path":"https://genentech.github.io/psborrow2/reference/binary_cutoff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Binary Cut-Off Transformation — binary_cutoff","text":"Transformation function used create_baseline_object(). Sets quantile values larger cut-value TRUE otherwise FALSE.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/binary_cutoff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Binary Cut-Off Transformation — binary_cutoff","text":"","code":"# Creates a simple function, where `data` is a `BaselineDataFrame`: function(data) {   ext <- data$ext == 0   q <- get_quantiles(data, name)   ifelse(ext, q > int_cutoff, q > ext_cutoff) } #> function(data) { #>   ext <- data$ext == 0 #>   q <- get_quantiles(data, name) #>   ifelse(ext, q > int_cutoff, q > ext_cutoff) #> } #> <environment: 0x5622c6d5b4a0>"},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_details.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for specifying borrowing details — borrowing_details","title":"Legacy function for specifying borrowing details — borrowing_details","text":"Please use one borrowing_hierarchical_commensurate(), borrowing_none(), borrowing_full() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_details.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for specifying borrowing details — borrowing_details","text":"","code":"borrowing_details(...)"},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_details.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for specifying borrowing details — borrowing_details","text":"... Deprecated arguments borrowing_details.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_details.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for specifying borrowing details — borrowing_details","text":"function return value. called, triggers error message indicating borrowing_details() deprecated one borrowing_hierarchical_commensurate(), borrowing_none(), borrowing_full() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_full.html","id":null,"dir":"Reference","previous_headings":"","what":"Full borrowing — borrowing_full","title":"Full borrowing — borrowing_full","text":"Full borrowing","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_full.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Full borrowing — borrowing_full","text":"","code":"borrowing_full(ext_flag_col)"},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_full.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Full borrowing — borrowing_full","text":"ext_flag_col character. Name external flag column matrix.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_full.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Full borrowing — borrowing_full","text":"Object class BorrowingFull.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_full.html","id":"method","dir":"Reference","previous_headings":"","what":"Method","title":"Full borrowing — borrowing_full","text":"method distinguish internal external arms, effectively pooling patients.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_full.html","id":"external-control","dir":"Reference","previous_headings":"","what":"External Control","title":"Full borrowing — borrowing_full","text":"ext_flag_col argument refers column data matrix contains flag indicating patient external control cohort.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_full.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Full borrowing — borrowing_full","text":"","code":"fb <- borrowing_full(\"ext\")"},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":null,"dir":"Reference","previous_headings":"","what":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"Hierarchical commensurate borrowing","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"","code":"borrowing_hierarchical_commensurate(ext_flag_col, tau_prior)"},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"ext_flag_col character. Name external flag column matrix. tau_prior Prior. Prior commensurability parameter.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"Object class BorrowingHierarchicalCommensurate.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"method","dir":"Reference","previous_headings":"","what":"Method","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"Bayesian dynamic borrowing using hierarchical commensurate prior approach, external control information borrowed extent outcomes (.e., log hazard rates log odds) similar external internal control populations. See Viele 2014 doi:10.1002/pst.1589  Hobbs 2011 doi:10.1111/j.1541-0420.2011.01564.x  details.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"external-control","dir":"Reference","previous_headings":"","what":"External Control","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"ext_flag_col argument refers column data matrix contains flag indicating patient external control cohort.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"tau-prior","dir":"Reference","previous_headings":"","what":"Tau Prior","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"tau_prior argument specifies hyperprior precision parameter commonly referred commensurability parameter. See Viele 2014 doi:10.1002/pst.1589  details. hyperprior determines (along comparability outcomes internal external controls) much borrowing external control group performed. Example hyperpriors include largely uninformative inverse gamma distributions [e.g., prior_gamma(alpha = .001, beta = .001)] well informative distributions [e.g., prior_gamma(alpha = 1, beta = .001)], though distribution \\(x \\(0, \\infty)\\) can used. Distributions density higher values \\(x\\) (.e., higher precision) lead borrowing.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"Viele, K., Berry, S., Neuenschwander, B., Amzal, B., Chen, F., Enas, N., Hobbs, B., Ibrahim, J.G., Kinnersley, N., Lindborg, S., Micallef, S., Roychoudhury, S. Thompson, L. (2014), Use historical control data assessing treatment effects clinical trials. Pharmaceut. Statist., 13: 41--54. doi:10.1002/pst.1589 Hobbes, B.P., Carlin, B.P., Mandrekar, S.J. Sargent, D.J. (2011), Hierarchical commensurate power prior models adaptive incorporation historical information clinical trials. Biometrics, 67: 1047--1056. doi:10.1111/j.1541-0420.2011.01564.x","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_hierarchical_commensurate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hierarchical commensurate borrowing — borrowing_hierarchical_commensurate","text":"","code":"db <- borrowing_hierarchical_commensurate(   ext_flag_col = \"ext\",   tau_prior = prior_gamma(0.0001, 0.0001) )"},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_none.html","id":null,"dir":"Reference","previous_headings":"","what":"No borrowing — borrowing_none","title":"No borrowing — borrowing_none","text":"borrowing","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_none.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"No borrowing — borrowing_none","text":"","code":"borrowing_none(ext_flag_col)"},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_none.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"No borrowing — borrowing_none","text":"ext_flag_col character. Name external flag column matrix.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_none.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"No borrowing — borrowing_none","text":"Object class BorrowingNone.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_none.html","id":"method","dir":"Reference","previous_headings":"","what":"Method","title":"No borrowing — borrowing_none","text":"method evaluates internal comparison, ignoring historical controls. Note method filter model matrix based values ext_flag_col.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_none.html","id":"external-control","dir":"Reference","previous_headings":"","what":"External Control","title":"No borrowing — borrowing_none","text":"ext_flag_col argument refers column data matrix contains flag indicating patient external control cohort.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/borrowing_none.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"No borrowing — borrowing_none","text":"","code":"db <- borrowing_none(   ext_flag_col = \"ext\" )"},{"path":"https://genentech.github.io/psborrow2/reference/c.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine objects in psborrow2 — c","title":"Combine objects in psborrow2 — c","text":"Creates data.frame objects various classes psborrow2","code":""},{"path":"https://genentech.github.io/psborrow2/reference/c.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine objects in psborrow2 — c","text":"","code":"# S4 method for SimDataList c(x, ...)"},{"path":"https://genentech.github.io/psborrow2/reference/c.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine objects in psborrow2 — c","text":"x object type: SimDataList ... additional objects combine","code":""},{"path":"https://genentech.github.io/psborrow2/reference/c.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine objects in psborrow2 — c","text":"combined object list SimDataList objects.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cauchy_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the cauchy prior — cauchy_prior","title":"Legacy function for the cauchy prior — cauchy_prior","text":"Please use prior_cauchy() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cauchy_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the cauchy prior — cauchy_prior","text":"","code":"cauchy_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/cauchy_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the cauchy prior — cauchy_prior","text":"... Deprecated arguments cauchy_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cauchy_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the cauchy prior — cauchy_prior","text":"function return value. called, triggers error message indicating cauchy_prior() deprecated prior_cauchy() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_cmdstanr.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Stan — check_cmdstanr","title":"Check Stan — check_cmdstanr","text":"Check whether cmdstanr available prints version logistic example.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_cmdstanr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Stan — check_cmdstanr","text":"","code":"check_cmdstanr(check_sampling = FALSE)  check_cmdstan()"},{"path":"https://genentech.github.io/psborrow2/reference/check_cmdstanr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Stan — check_cmdstanr","text":"check_sampling Compile sample \"logistic\" example model.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_cmdstanr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Stan — check_cmdstanr","text":"check_cmdstanr() prints results checks. check_cmdstan() returns TRUE CmdStan seems installed, otherwise FALSE","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_cmdstanr.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Check Stan — check_cmdstanr","text":"check_cmdstan(): Check CmdStan command line tools available.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_cmdstanr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Stan — check_cmdstanr","text":"","code":"check_cmdstanr() #> cmdstanr is installed. #> cmdstanr version:  #> 0.7.1  #> cmdstan version:  #> 2.34.1  #> Example program: #> data { #>   int<lower=0> N; #>   int<lower=0> K; #>   array[N] int<lower=0, upper=1> y; #>   matrix[N, K] X; #> } #> parameters { #>   real alpha; #>   vector[K] beta; #> } #> model { #>   target += normal_lpdf(alpha | 0, 1); #>   target += normal_lpdf(beta | 0, 1); #>   target += bernoulli_logit_glm_lpmf(y | X, alpha, beta); #> } #> generated quantities { #>   vector[N] log_lik; #>   for (n in 1 : N) { #>     log_lik[n] = bernoulli_logit_lpmf(y[n] | alpha + X[n] * beta); #>   } #> }"},{"path":"https://genentech.github.io/psborrow2/reference/check_data_matrix_has_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Data Matrix for Required Columns — check_data_matrix_has_columns","title":"Check Data Matrix for Required Columns — check_data_matrix_has_columns","text":"Check Analysis object's data_matrix required variables.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_data_matrix_has_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Data Matrix for Required Columns — check_data_matrix_has_columns","text":"","code":"check_data_matrix_has_columns(object)"},{"path":"https://genentech.github.io/psborrow2/reference/check_data_matrix_has_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Data Matrix for Required Columns — check_data_matrix_has_columns","text":"object Analysis. Object check.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_data_matrix_has_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Data Matrix for Required Columns — check_data_matrix_has_columns","text":"stop() columns missing.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_data_matrix_has_columns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Data Matrix for Required Columns — check_data_matrix_has_columns","text":"","code":"anls <- create_analysis_obj(   data_matrix = example_matrix,   covariates = add_covariates(     covariates = c(\"cov1\", \"cov2\"),     priors = prior_normal(0, 1000)   ),   outcome = outcome_surv_exponential(     \"time\",     \"cnsr\",     baseline_prior = prior_normal(0, 1000)   ),   borrowing = borrowing_hierarchical_commensurate(     \"ext\",     prior_exponential(.001)   ),   treatment = treatment_details(     \"trt\",     prior_normal(0, 1000)   ) ) #> Inputs look good. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`.  check_data_matrix_has_columns(anls)"},{"path":"https://genentech.github.io/psborrow2/reference/check_fixed_external_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Fixed External Data Object — check_fixed_external_data","title":"Create a Fixed External Data Object — check_fixed_external_data","text":"Create Fixed External Data Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_fixed_external_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Fixed External Data Object — check_fixed_external_data","text":"","code":"check_fixed_external_data(data, req_cols)"},{"path":"https://genentech.github.io/psborrow2/reference/check_fixed_external_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Fixed External Data Object — check_fixed_external_data","text":"data data.frame containing external control data req_cols character vector required covariate columns","code":""},{"path":"https://genentech.github.io/psborrow2/reference/check_fixed_external_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Fixed External Data Object — check_fixed_external_data","text":"DataSimObject updated enrollment_internal enrollment_external slots.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cont_var.html","id":null,"dir":"Reference","previous_headings":"","what":"Create continuous covariate — cont_var","title":"Create continuous covariate — cont_var","text":"Create object class SimVarCont hold mean values continuous variables specified simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cont_var.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create continuous covariate — cont_var","text":"","code":"cont_var(mu_internal, mu_external)"},{"path":"https://genentech.github.io/psborrow2/reference/cont_var.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create continuous covariate — cont_var","text":"mu_internal numeric. Mean covariate value internal arms. mu_external numeric. Mean covariate value external arm.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cont_var.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create continuous covariate — cont_var","text":"Object class SimVarCont.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/cont_var.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create continuous covariate — cont_var","text":"","code":"cv1 <- cont_var(0.5, 1) cv2 <- cont_var(10, 10)"},{"path":"https://genentech.github.io/psborrow2/reference/covariance_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Covariance Matrix — covariance_matrix","title":"Create Covariance Matrix — covariance_matrix","text":"Create Covariance Matrix","code":""},{"path":"https://genentech.github.io/psborrow2/reference/covariance_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Covariance Matrix — covariance_matrix","text":"","code":"covariance_matrix(diag, upper_tri)"},{"path":"https://genentech.github.io/psborrow2/reference/covariance_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Covariance Matrix — covariance_matrix","text":"diag Diagonal entries covariance matrix upper_tri Upper triangle entries matrix, specified column wise.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/covariance_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Covariance Matrix — covariance_matrix","text":"symmetric matrix diag values main diagonal upper_tri values lower upper triangles.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/covariance_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Covariance Matrix — covariance_matrix","text":"","code":"m1 <- covariance_matrix(c(1, 1, 1, 1), c(.8, .3, .8, 0, 0, 0)) m1 #>      [,1] [,2] [,3] [,4] #> [1,]  1.0  0.8  0.3    0 #> [2,]  0.8  1.0  0.8    0 #> [3,]  0.3  0.8  1.0    0 #> [4,]  0.0  0.0  0.0    1 mvtnorm::rmvnorm(5, mean = c(0, 0, 0, 0), sigma = m1) #>            [,1]        [,2]       [,3]        [,4] #> [1,] -0.1550966  0.01793093  0.2588510  2.75541758 #> [2,]  0.3314665  0.49230253  0.3914245 -1.91172049 #> [3,]  0.6199512  0.15379277 -0.2737470  0.01917759 #> [4,]  0.2308265 -0.72680109 -1.6965668  2.68255718 #> [5,] -0.1745365  0.50651305  1.0265451 -0.66508825  # No correlation covariance_matrix(c(1, 2, 3)) #>      [,1] [,2] [,3] #> [1,]    1    0    0 #> [2,]    0    2    0 #> [3,]    0    0    3"},{"path":"https://genentech.github.io/psborrow2/reference/create_alpha_string.html","id":null,"dir":"Reference","previous_headings":"","what":"Create alpha string — create_alpha_string","title":"Create alpha string — create_alpha_string","text":"Create alpha string","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_alpha_string.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create alpha string — create_alpha_string","text":"","code":"create_alpha_string(borrowing_object, outcome_object)  # S4 method for Borrowing create_alpha_string(borrowing_object, outcome_object)  # S4 method for BorrowingHierarchicalCommensurate create_alpha_string(borrowing_object, outcome_object)"},{"path":"https://genentech.github.io/psborrow2/reference/create_alpha_string.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create alpha string — create_alpha_string","text":"borrowing_object borrowing object outcome_object outcome object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_analysis_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Compile MCMC sampler using STAN and create analysis object — create_analysis_obj","title":"Compile MCMC sampler using STAN and create analysis object — create_analysis_obj","text":"Compile MCMC sampler using STAN create analysis object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_analysis_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compile MCMC sampler using STAN and create analysis object — create_analysis_obj","text":"","code":"create_analysis_obj(   data_matrix,   outcome,   borrowing,   treatment,   covariates = NULL,   quiet = FALSE )"},{"path":"https://genentech.github.io/psborrow2/reference/create_analysis_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compile MCMC sampler using STAN and create analysis object — create_analysis_obj","text":"data_matrix matrix. data matrix, including covariates adjusted , relevant outcome variables, treatment arm external control arm flags. outcome Outcome. Object class Outcome output outcome_surv_exponential(), outcome_surv_weibull_ph(), outcome_bin_logistic(). borrowing Borrowing. Object class Borrowing output borrowing_full(), borrowing_none(), borrowing_hierarchical_commensurate(). treatment Treatment. Object class Treatment output treatment_details(). covariates Covariates. Object class Covariates output function add_covariates(). quiet logical. Whether suppress messages (TRUE) (FALSE, default)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_analysis_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compile MCMC sampler using STAN and create analysis object — create_analysis_obj","text":"Object class Analysis.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_analysis_obj.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compile MCMC sampler using STAN and create analysis object — create_analysis_obj","text":"","code":"if (check_cmdstan()) {   anls <- create_analysis_obj(     data_matrix = example_matrix,     outcome = outcome_surv_exponential(       \"time\",       \"cnsr\",       baseline_prior = prior_normal(0, 1000)     ),     borrowing = borrowing_hierarchical_commensurate(       \"ext\",       prior_exponential(.001)     ),     treatment = treatment_details(       \"trt\",       prior_normal(0, 1000)     ),     covariates = add_covariates(       covariates = c(\"cov1\", \"cov2\"),       priors = prior_normal(0, 1000)     )   ) } #> Inputs look good. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`."},{"path":"https://genentech.github.io/psborrow2/reference/create_baseline_object.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Baseline Data Simulation Object — create_baseline_object","title":"Create Baseline Data Simulation Object — create_baseline_object","text":"Create Baseline Data Simulation Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_baseline_object.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Baseline Data Simulation Object — create_baseline_object","text":"","code":"create_baseline_object(   n_trt_int,   n_ctrl_int,   n_ctrl_ext,   covariates,   transformations )"},{"path":"https://genentech.github.io/psborrow2/reference/create_baseline_object.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Baseline Data Simulation Object — create_baseline_object","text":"n_trt_int Number internal treated patients n_ctrl_int Number internal control patients n_ctrl_ext Number external control patients covariates List correlated covariates objects, see baseline_covariates() transformations List named transformation functions.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_baseline_object.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Baseline Data Simulation Object — create_baseline_object","text":"BaselineObject","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_baseline_object.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Baseline Data Simulation Object — create_baseline_object","text":"Transformation functions evaluated order create overwrite column data.frame name. function take data.frame (specifically BaselineDataFrame object generate(BaselineObject)) return vector length identical total number patients. @BaselineObject slot may accessed directly get_quantiles() create transformations. See binary_cutoff()","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_baseline_object.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Baseline Data Simulation Object — create_baseline_object","text":"","code":"bl_no_covs <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 100 )   bl_biomarkers <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 100,   covariates = baseline_covariates(     c(\"b1\", \"b2\", \"b3\"),     means_int = c(0, 0, 0),     covariance_int = covariance_matrix(c(1, 1, 1), c(.8, .3, .8))   ),   transformations = list(     exp_b1 = function(data) exp(data$b1),     b2 = binary_cutoff(\"b2\", int_cutoff = 0.7, ext_cutoff = 0.5)   ) )"},{"path":"https://genentech.github.io/psborrow2/reference/create_data_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Data Matrix — create_data_matrix","title":"Create Data Matrix — create_data_matrix","text":"Creates matrix suitable create_analysis_obj(). Creates dummy variables factors allows transformations covariates specified formula.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_data_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Data Matrix — create_data_matrix","text":"","code":"create_data_matrix(   data,   outcome,   trt_flag_col,   ext_flag_col,   covariates = NULL,   weight_var = NULL )"},{"path":"https://genentech.github.io/psborrow2/reference/create_data_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Data Matrix — create_data_matrix","text":"data data.frame. Data containing variables outcome character. outcome variable binary outcomes time censoring variables. trt_flag_col character. treatment indicator variable. ext_flag_col character. external cohort indicator. covariates character formula. covariates model adjustment. weight_var character. optional weight variable.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_data_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Data Matrix — create_data_matrix","text":"Invisibly returns matrix containing variables pass create_analysis_obj(). Prints names covariates columns use add_covariates().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_data_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Data Matrix — create_data_matrix","text":"","code":"dat <- survival::diabetic dat$ext <- dat$trt == 0 & dat$id > 1000 data_mat <- create_data_matrix(   dat,   outcome = c(\"time\", \"status\"),   trt_flag_col = \"trt\",   ext_flag_col = \"ext\",   covariates = ~ age + laser + log(risk) ) #> Call `add_covariates()` with `covariates =  c(\"age\", \"laserargon\", \"log(risk)\") ` data_mat #>      time status trt extTRUE age laserargon log(risk) #> 1   46.23      0   0       0  28          1  2.197225 #> 2   46.23      0   1       0  28          1  2.197225 #> 3   42.50      0   1       0  12          0  2.079442 #> 4   31.30      1   0       0  12          0  1.791759 #> 5   42.27      0   1       0   9          0  2.397895 #> 6   42.27      0   0       0   9          0  2.397895 #> 7   20.60      0   0       0   9          0  2.397895 #> 8   20.60      0   1       0   9          0  2.397895 #> 9    0.30      1   0       0  13          0  2.302585 #> 10  38.77      0   1       0  13          0  2.197225 #> 11  65.23      0   1       0  12          0  2.197225 #> 12  54.27      1   0       0  12          0  2.197225 #> 13  63.50      0   1       0   8          0  2.079442 #> 14  10.80      1   0       0   8          0  1.791759 #> 15  23.17      0   1       0  12          0  2.079442 #> 16  23.17      0   0       0  12          0  2.197225 #> 17   1.47      0   1       0  16          0  2.197225 #> 18   1.47      0   0       0  16          0  2.302585 #> 19  58.07      0   1       0  21          1  2.197225 #> 20  13.83      1   0       0  21          1  2.197225 #> 21  48.53      0   0       0  23          1  2.197225 #> 22  46.43      1   1       0  23          1  2.197225 #> 23  44.40      0   1       0  44          1  2.397895 #> 24   7.90      1   0       0  44          1  2.484907 #> 25  39.57      0   0       0  47          1  1.791759 #> 26  39.57      0   1       0  47          1  2.397895 #> 27  30.83      1   1       0  48          1  1.791759 #> 28  38.57      1   0       0  48          1  2.302585 #> 29  66.27      0   1       0  26          1  2.302585 #> 30  14.10      1   0       0  26          1  2.197225 #> 31   6.90      1   0       0  10          0  2.302585 #> 32  20.17      1   1       0  10          0  2.197225 #> 33  41.40      1   0       0  23          1  2.197225 #> 34  58.43      0   1       0  23          1  2.484907 #> 35  58.20      0   1       0   5          0  2.197225 #> 36  58.20      0   0       0   5          0  2.197225 #> 37  57.43      0   1       0  46          1  1.791759 #> 38  57.43      0   0       0  46          1  2.079442 #> 39  56.03      0   1       0   5          0  2.397895 #> 40  56.03      0   0       0   5          0  2.484907 #> 41  67.53      0   0       0  13          0  2.197225 #> 42  67.53      0   1       0  13          0  2.197225 #> 43  61.40      0   1       0  45          1  2.197225 #> 44   0.60      1   0       0  45          1  2.484907 #> 45  10.27      1   1       0  11          0  2.302585 #> 46   1.63      1   0       0  11          0  2.302585 #> 47  66.20      0   0       0   1          0  2.397895 #> 48  66.20      0   1       0   1          0  2.484907 #> 49  13.83      1   0       0  10          0  2.197225 #> 50   5.67      1   1       0  10          0  2.484907 #> 51  58.83      0   1       0  12          0  2.197225 #> 52  29.97      1   0       0  12          0  2.397895 #> 53  60.27      0   1       0  36          1  2.197225 #> 54  26.37      1   0       0  36          1  2.397895 #> 55   1.33      1   0       0  53          1  2.484907 #> 56   5.77      1   1       0  53          1  2.302585 #> 57  35.53      1   0       0  10          0  2.397895 #> 58   5.90      1   1       0  10          0  2.397895 #> 59  21.90      1   0       0  25          1  2.197225 #> 60  25.63      1   1       0  25          1  2.302585 #> 61  14.80      1   0       0  14          0  2.197225 #> 62  33.90      1   1       0  14          0  2.197225 #> 63   6.20      1   0       0  16          0  2.079442 #> 64   1.73      1   1       0  16          0  2.302585 #> 65  22.00      1   0       0  38          1  2.079442 #> 66  46.90      0   1       0  38          1  2.197225 #> 67  31.13      0   0       0  14          0  2.197225 #> 68  31.13      0   1       0  14          0  2.197225 #> 69  22.00      1   0       0  10          0  2.397895 #> 70  30.20      1   1       0  10          0  2.197225 #> 71  70.90      0   0       0  17          0  2.484907 #> 72  70.90      0   1       0  17          0  2.397895 #> 73  25.80      1   1       0  44          1  2.397895 #> 74  13.87      1   0       0  44          1  2.079442 #> 75  48.30      1   0       0  21          1  2.197225 #> 76   5.73      1   1       0  21          1  2.197225 #> 77  53.43      0   0       0  19          0  2.197225 #> 78  53.43      0   1       0  19          0  2.197225 #> 79   1.90      1   1       0  13          0  2.302585 #> 80  51.10      0   0       0  13          0  2.484907 #> 81   9.90      1   0       0  40          1  2.197225 #> 82   9.90      1   1       0  40          1  2.302585 #> 83  34.20      0   1       0   9          0  2.079442 #> 84  34.20      0   0       0   9          0  2.484907 #> 85   2.67      1   0       0  48          1  2.484907 #> 86  46.73      0   1       0  48          1  2.302585 #> 87  18.73      0   1       0  42          1  2.302585 #> 88  13.83      1   0       0  42          1  2.302585 #> 89  32.03      0   1       0  24          1  2.397895 #> 90   4.27      1   0       0  24          1  2.302585 #> 91  13.90      1   0       0  55          1  2.302585 #> 92  69.87      0   1       0  55          1  2.302585 #> 93  66.80      0   0       0  17          0  2.197225 #> 94  66.80      0   1       0  17          0  2.397895 #> 95  64.73      0   1       0   5          0  2.197225 #> 96  64.73      0   0       0   5          0  2.079442 #> 97   1.70      1   1       0   6          0  2.302585 #> 98   1.70      1   0       0   6          0  1.791759 #> 99   1.77      1   1       0  19          0  2.197225 #> 100 43.03      1   0       0  19          0  2.484907 #> 101 29.03      0   1       0  12          0  2.079442 #> 102 29.03      0   0       0  12          0  2.079442 #> 103 56.57      0   0       0  45          1  2.197225 #> 104 56.57      0   1       0  45          1  2.197225 #> 105  8.30      1   0       0  27          1  2.302585 #> 106  8.30      1   1       0  27          1  2.197225 #> 107 21.57      0   1       0  43          1  2.079442 #> 108 18.43      1   0       0  43          1  2.197225 #> 109 31.57      0   0       0   4          0  2.079442 #> 110 31.57      0   1       0   4          0  2.197225 #> 111 31.63      1   0       0  45          1  2.197225 #> 112 31.63      0   1       0  45          1  2.302585 #> 113 39.77      0   1       0  32          1  2.397895 #> 114 39.77      0   0       0  32          1  2.302585 #> 115  6.53      1   0       0   3          0  2.397895 #> 116 18.70      1   1       0   3          0  2.302585 #> 117 18.90      0   1       0  14          0  2.079442 #> 118 18.90      0   0       0  14          0  2.197225 #> 119 56.80      0   1       0  13          0  2.302585 #> 120 22.23      1   0       0  13          0  2.079442 #> 121 55.60      0   1       0  15          0  2.302585 #> 122 14.00      1   0       0  15          0  2.197225 #> 123 42.17      1   0       0  10          0  2.302585 #> 124 42.17      1   1       0  10          0  2.197225 #> 125  5.33      1   0       0   6          0  2.197225 #> 126 10.70      0   1       0   6          0  2.197225 #> 127 59.80      1   0       0  17          0  2.302585 #> 128 66.33      0   1       0  17          0  2.197225 #> 129  5.83      1   0       0  37          1  2.397895 #> 130 52.33      0   1       0  37          1  2.484907 #> 131 58.17      0   1       0  18          0  2.197225 #> 132  2.17      1   0       0  18          0  2.484907 #> 133 48.43      1   0       0  13          0  2.079442 #> 134 14.30      1   1       0  13          0  2.197225 #> 135 25.83      0   0       0  14          0  2.302585 #> 136 25.83      0   1       0  14          0  2.484907 #> 137 45.40      0   1       0  12          0  2.302585 #> 138 45.40      0   0       0  12          0  2.197225 #> 139 47.60      0   1       0   9          0  1.791759 #> 140 47.60      0   0       0   9          0  2.197225 #> 141  9.60      1   0       0  11          0  2.302585 #> 142 13.33      1   1       0  11          0  2.484907 #> 143 42.10      0   0       0  10          0  2.397895 #> 144 42.10      0   1       0  10          0  2.397895 #> 145 39.93      0   1       0   5          0  2.197225 #> 146 39.93      0   0       0   5          0  1.791759 #> 147  7.60      1   0       0  15          0  2.484907 #> 148 14.27      1   1       0  15          0  2.197225 #> 149  1.80      1   0       0   7          0  2.484907 #> 150 34.57      1   1       0   7          0  2.484907 #> 151  4.30      1   0       0   2          0  2.484907 #> 152 65.80      0   1       0   2          0  2.197225 #> 153 12.20      1   0       0  22          1  1.791759 #> 154  4.10      1   1       0  22          1  2.079442 #> 155 60.93      0   0       0   5          0  2.484907 #> 156 60.93      0   1       0   5          0  2.397895 #> 157 57.20      0   0       0   4          0  2.197225 #> 158 57.20      0   1       0   4          0  2.302585 #> 159 38.07      0   1       0  27          1  2.079442 #> 160 12.73      1   0       0  27          1  2.302585 #> 161 54.10      0   1       0  53          1  2.397895 #> 162 54.10      1   0       0  53          1  2.397895 #> 163 59.27      0   1       0  10          0  2.197225 #> 164  9.40      1   0       0  10          0  2.484907 #> 165  9.90      1   0       0  13          0  2.302585 #> 166 21.57      1   1       0  13          0  2.484907 #> 167 54.10      0   0       0  12          0  2.079442 #> 168 54.10      0   1       0  12          0  2.079442 #> 169 50.47      0   0       0  24          1  2.397895 #> 170 50.47      0   1       0  24          1  2.197225 #> 171 46.17      0   0       0  17          0  2.484907 #> 172 46.17      0   1       0  17          0  2.197225 #> 173 46.30      0   0       0   8          0  2.397895 #> 174 46.30      0   1       0   8          0  2.397895 #> 175 38.83      0   1       0  58          1  2.484907 #> 176 38.83      0   0       0  58          1  2.197225 #> 177 44.60      0   0       0  17          0  2.197225 #> 178 44.60      0   1       0  17          0  2.197225 #> 179 43.07      0   0       0  12          0  2.197225 #> 180 43.07      0   1       0  12          0  2.484907 #> 181 40.03      0   0       0  25          1  2.079442 #> 182 26.23      1   1       0  25          1  2.079442 #> 183 41.60      0   1       0  15          0  2.197225 #> 184 18.03      1   0       0  15          0  2.397895 #> 185 38.07      0   0       0  21          1  2.397895 #> 186 38.07      0   1       0  21          1  2.397895 #> 187 65.23      0   1       0  20          1  2.197225 #> 188 65.23      0   0       0  20          1  2.197225 #> 189  7.07      1   1       0  23          1  2.302585 #> 190 66.77      0   0       0  23          1  2.484907 #> 191 13.77      1   0       0  13          0  2.484907 #> 192 13.77      1   1       0  13          0  2.302585 #> 193  9.63      1   0       0  45          1  2.484907 #> 194  9.63      0   1       0  45          1  2.302585 #> 195 46.23      0   1       0   5          0  2.484907 #> 196 46.23      0   0       0   5          0  2.484907 #> 197  1.50      1   0       0   8          0  2.484907 #> 198 45.73      0   1       0   8          0  2.197225 #> 199 33.63      1   0       0  30          1  2.197225 #> 200 33.63      1   1       0  30          1  2.197225 #> 201 40.17      0   0       0   7          0  1.791759 #> 202 40.17      0   1       0   7          0  2.079442 #> 203 27.60      1   0       0  39          1  2.302585 #> 204 63.33      1   1       0  39          1  2.397895 #> 205 38.47      1   1       0  26          1  2.302585 #> 206  1.63      1   0       0  26          1  2.302585 #> 207 55.23      0   1       0  50          1  1.791759 #> 208 55.23      0   0       0  50          1  2.079442 #> 209 25.30      1   0       0  34          1  2.302585 #> 210 52.77      0   1       0  34          1  1.791759 #> 211 46.20      1   0       0  10          0  2.079442 #> 212 57.17      0   1       0  10          0  1.791759 #> 213  9.87      0   1       0  40          1  2.302585 #> 214  1.70      1   0       0  40          1  2.302585 #> 215 57.90      0   0       0  13          0  2.397895 #> 216 57.90      0   1       0  13          0  2.484907 #> 217  5.90      0   0       0   7          0  2.484907 #> 218  5.90      0   1       0   7          0  2.302585 #> 219 32.20      0   0       0  11          0  2.484907 #> 220 32.20      0   1       0  11          0  2.484907 #> 221 10.33      1   1       0  13          0  2.197225 #> 222  0.83      1   0       0  13          0  2.302585 #> 223 50.90      0   0       0   9          0  2.197225 #> 224  6.13      1   1       0   9          0  2.484907 #> 225 25.93      1   0       0   5          0  2.197225 #> 226 43.67      0   1       0   5          0  2.197225 #> 227 38.30      0   0       0  10          0  2.197225 #> 228 38.30      0   1       0  10          0  2.197225 #> 229 38.77      0   1       0  23          1  2.197225 #> 230 19.40      1   0       0  23          1  2.302585 #> 231 21.97      1   0       0   2          0  2.302585 #> 232 38.07      0   1       0   2          0  2.484907 #> 233 38.30      0   1       0  12          0  2.397895 #> 234 38.30      0   0       0  12          0  2.397895 #> 235 70.03      0   0       0   7          0  2.197225 #> 236 26.20      1   1       0   7          0  2.302585 #> 237 18.03      1   0       1  13          0  2.397895 #> 238 62.57      0   1       0  13          0  2.197225 #> 239  1.57      1   0       1  50          1  2.197225 #> 240 13.83      1   1       0  50          1  2.079442 #> 241 46.50      0   1       0  20          1  2.484907 #> 242 13.37      1   0       1  20          1  2.484907 #> 243  1.97      1   0       1  15          0  2.197225 #> 244 11.07      1   1       0  15          0  2.397895 #> 245 42.47      0   1       0  30          1  2.197225 #> 246 22.20      1   0       1  30          1  2.197225 #> 247 38.73      0   0       1  32          1  2.197225 #> 248 38.73      0   1       0  32          1  2.197225 #> 249 51.13      0   0       1  39          1  2.397895 #> 250 51.13      0   1       0  39          1  2.397895 #> 251 46.50      0   0       1   4          0  2.397895 #> 252  6.10      1   1       0   4          0  2.302585 #> 253 11.30      1   0       1   3          0  2.397895 #> 254  2.10      1   1       0   3          0  2.302585 #> 255 17.73      1   1       0  10          0  2.302585 #> 256 42.30      0   0       1  10          0  2.197225 #> 257 26.47      0   0       1   6          0  2.302585 #> 258 26.47      0   1       0   6          0  2.197225 #> 259 10.77      0   1       0  15          0  2.397895 #> 260 10.77      0   0       1  15          0  2.397895 #> 261 55.33      0   1       0  33          1  2.484907 #> 262 55.33      0   0       1  33          1  2.302585 #> 263 58.67      0   1       0  15          0  2.197225 #> 264 58.67      0   0       1  15          0  2.197225 #> 265  4.97      1   0       1  44          1  2.197225 #> 266 12.93      1   1       0  44          1  2.302585 #> 267 26.47      1   0       1  48          1  2.484907 #> 268 54.20      0   1       0  48          1  2.197225 #> 269 49.57      0   0       1   4          0  2.197225 #> 270 49.57      0   1       0   4          0  2.302585 #> 271  9.87      1   0       1  46          1  2.397895 #> 272 24.43      1   1       0  46          1  2.484907 #> 273 50.23      0   0       1  25          1  2.197225 #> 274 50.23      0   1       0  25          1  2.197225 #> 275 30.40      1   0       1  12          0  2.484907 #> 276 13.97      1   1       0  12          0  2.397895 #> 277 43.33      0   1       0  12          0  1.791759 #> 278 43.33      1   0       1  12          0  2.302585 #> 279 42.23      0   1       0  26          1  2.079442 #> 280 42.23      0   0       1  26          1  2.079442 #> 281 74.93      0   0       1  11          0  2.197225 #> 282 74.93      0   1       0  11          0  2.197225 #> 283 66.93      0   1       0  36          1  2.197225 #> 284 66.93      0   0       1  36          1  2.197225 #> 285 73.43      0   1       0  12          0  2.197225 #> 286 73.43      0   0       1  12          0  2.197225 #> 287 67.47      0   1       0  50          1  2.484907 #> 288 38.57      1   0       1  50          1  2.397895 #> 289  3.67      0   1       0  44          1  2.197225 #> 290  3.67      1   0       1  44          1  2.302585 #> 291 67.03      0   0       1   8          0  2.197225 #> 292 48.87      1   1       0   8          0  2.302585 #> 293 65.60      0   1       0  14          0  2.197225 #> 294 65.60      0   0       1  14          0  2.197225 #> 295 15.83      1   0       1  18          0  2.302585 #> 296 15.83      0   1       0  18          0  2.302585 #> 297 20.07      0   1       0  56          1  2.397895 #> 298  8.83      1   0       1  56          1  2.079442 #> 299 67.43      0   0       1   9          0  2.197225 #> 300 67.43      0   1       0   9          0  2.302585 #> 301  1.47      0   1       0  15          0  2.197225 #> 302  1.47      0   0       1  15          0  1.791759 #> 303 62.93      0   1       0   5          0  2.397895 #> 304 22.13      1   0       1   5          0  2.197225 #> 305  6.30      1   1       0   1          0  2.197225 #> 306 56.97      0   0       1   1          0  2.397895 #> 307 59.70      0   1       0   1          0  2.302585 #> 308 18.93      1   0       1   1          0  2.302585 #> 309 19.00      1   0       1  14          0  2.197225 #> 310 13.80      1   1       0  14          0  2.302585 #> 311 55.13      0   1       0  57          1  1.791759 #> 312 55.13      0   0       1  57          1  1.791759 #> 313  5.43      1   0       1   8          0  2.397895 #> 314 13.57      1   1       0   8          0  2.397895 #> 315 42.20      0   1       0  33          1  2.397895 #> 316 42.20      0   0       1  33          1  2.397895 #> 317 38.27      0   0       1  46          1  2.197225 #> 318 38.27      0   1       0  46          1  2.302585 #> 319  7.10      0   1       0   3          0  2.079442 #> 320  7.10      1   0       1   3          0  2.484907 #> 321 26.17      1   0       1  35          1  2.397895 #> 322 63.63      0   1       0  35          1  2.397895 #> 323 24.73      1   0       1   8          0  2.397895 #> 324 59.00      0   1       0   8          0  2.397895 #> 325 54.37      0   1       0  30          1  2.197225 #> 326 54.37      0   0       1  30          1  2.302585 #> 327 54.60      0   1       0  51          1  2.079442 #> 328 10.97      1   0       1  51          1  2.484907 #> 329 21.10      1   0       1  42          1  2.197225 #> 330 63.87      0   1       0  42          1  2.197225 #> 331 62.37      0   1       0  20          1  2.197225 #> 332 43.70      1   0       1  20          1  2.079442 #> 333 62.80      0   0       1  23          1  2.197225 #> 334 62.80      0   1       0  23          1  2.397895 #> 335 63.33      0   1       0  22          1  2.397895 #> 336 14.37      1   0       1  22          1  2.197225 #> 337 58.53      0   0       1  25          1  2.197225 #> 338 58.53      0   1       0  25          1  2.197225 #> 339 58.07      0   0       1  45          1  2.397895 #> 340 58.07      0   1       0  45          1  2.484907 #> 341 58.50      0   0       1  20          1  2.197225 #> 342 58.50      0   1       0  20          1  2.302585 #> 343 14.37      0   0       1  41          1  2.197225 #> 344  1.50      1   1       0  41          1  2.197225 #> 345 54.73      0   1       0  19          0  2.484907 #> 346 38.40      1   0       1  19          0  2.302585 #> 347 50.63      0   1       0   4          0  2.484907 #> 348  2.83      1   0       1   4          0  2.397895 #> 349 51.10      0   0       1  36          1  2.197225 #> 350 51.10      0   1       0  36          1  2.302585 #> 351 49.93      0   1       0  20          1  2.197225 #> 352  6.57      1   0       1  20          1  2.197225 #> 353 46.27      0   1       0  24          1  2.197225 #> 354 46.27      1   0       1  24          1  2.197225 #> 355 10.60      0   1       0  28          1  2.197225 #> 356 10.60      0   0       1  28          1  2.302585 #> 357 42.77      0   1       0  51          1  2.079442 #> 358 42.77      0   0       1  51          1  2.484907 #> 359 34.37      1   1       0  16          0  2.197225 #> 360 42.27      0   0       1  16          0  2.302585 #> 361 42.07      0   1       0  16          0  2.302585 #> 362 42.07      0   0       1  16          0  2.302585 #> 363 38.77      0   0       1  10          0  2.197225 #> 364 38.77      0   1       0  10          0  2.197225 #> 365 61.83      1   0       1  20          1  2.484907 #> 366 74.97      0   1       0  20          1  2.197225 #> 367 66.97      0   0       1  10          0  2.484907 #> 368  6.57      1   1       0  10          0  2.302585 #> 369 38.87      1   1       0  16          0  1.791759 #> 370 68.30      0   0       1  16          0  1.791759 #> 371 46.63      1   0       1  10          0  2.197225 #> 372 42.43      1   1       0  10          0  2.397895 #> 373 67.07      0   1       0  11          0  2.197225 #> 374 67.07      0   0       1  11          0  2.197225 #> 375  2.70      1   1       0   1          0  2.302585 #> 376  2.70      0   0       1   1          0  2.484907 #> 377 63.80      0   0       1  17          0  2.079442 #> 378 63.80      0   1       0  17          0  1.791759 #> 379 32.63      0   0       1   7          0  2.197225 #> 380 32.63      0   1       0   7          0  2.197225 #> 381 62.00      0   1       0  29          1  2.302585 #> 382 62.00      0   0       1  29          1  2.079442 #> 383 54.80      0   0       1   5          0  2.302585 #> 384 13.10      1   1       0   5          0  2.397895 #> 385  8.00      0   0       1   1          0  2.079442 #> 386  8.00      0   1       0   1          0  2.079442 #> 387 42.33      1   0       1  22          1  2.397895 #> 388 51.60      0   1       0  22          1  2.484907 #> 389 49.97      0   1       0  33          1  2.197225 #> 390  2.90      1   0       1  33          1  2.302585 #> 391 45.90      0   1       0   3          0  2.302585 #> 392  1.43      1   0       1   3          0  2.302585 #> 393 41.93      0   1       0  32          1  2.197225 #> 394 41.93      0   0       1  32          1  2.197225"},{"path":"https://genentech.github.io/psborrow2/reference/create_data_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Data Simulation — create_data_simulation","title":"Data Simulation — create_data_simulation","text":"Data Simulation","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_data_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data Simulation — create_data_simulation","text":"","code":"create_data_simulation(   baseline,   coefficients = numeric(),   treatment_hr = 1,   drift_hr = 1,   event_dist,   fixed_external_data )"},{"path":"https://genentech.github.io/psborrow2/reference/create_data_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Data Simulation — create_data_simulation","text":"baseline BaselineObject create_baseline_object() coefficients Named vector coefficients linear predictor. Must correspond variables baseline object treatment_hr Default treatment hazard ratio simulations. Alternative simulation settings can specified generate. drift_hr Default drift hazard ratio internal external arms. Alternative simulation settings can specified generate. event_dist Specify time event distribution SimDataEvent object create_event_dist() fixed_external_data data.frame containing external control data. must contain columns eventtime, status variables named coefficients. present, trt must 0 ext must 1 rows.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_data_simulation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Data Simulation — create_data_simulation","text":"DataSimObject","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_data_simulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Data Simulation — create_data_simulation","text":"","code":"baseline_obj <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 10,   covariates = baseline_covariates(     names = c(\"age\", \"score\"),     means_int = c(55, 5),     means_ext = c(60, 5),     covariance_int = covariance_matrix(c(5, 1))   ) ) sim_obj <- create_data_simulation(   baseline_obj,   coefficients = c(age = 0.001, score = 1.5),   event_dist = create_event_dist(dist = \"exponential\", lambdas = 1 / 36) ) data_sim_list <- generate(sim_obj, treatment_hr = c(0.5, 1), drift_hr = 0.5)"},{"path":"https://genentech.github.io/psborrow2/reference/create_event_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Time to Event Distribution — create_event_dist","title":"Specify a Time to Event Distribution — create_event_dist","text":"Uses simsurv::simsurv generate time event data. See simsurv help details.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_event_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Time to Event Distribution — create_event_dist","text":"","code":"create_event_dist(   dist = NULL,   lambdas = NULL,   gammas = NULL,   mixture = FALSE,   pmix = 0.5,   hazard = NULL,   loghazard = NULL,   cumhazard = NULL,   logcumhazard = NULL,   ... )  null_event_dist()"},{"path":"https://genentech.github.io/psborrow2/reference/create_event_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Time to Event Distribution — create_event_dist","text":"dist Specify distribution \"exponential\" lambdas Scale parameter gammas Second parameter needed Weibull Gompertz distributions mixture Use mixture model? pmix Proportion mixtures hazard user defined hazard function loghazard Alternatively, user defined log hazard function cumhazard Alternatively, user defined cumulative hazard function logcumhazard Alternatively, user defined log cumulative hazard function ... simsurv parameters","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_event_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Time to Event Distribution — create_event_dist","text":"SimDataEvent object null_event_dist returns object parameters specified simulate event times.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_event_dist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Time to Event Distribution — create_event_dist","text":"","code":"weibull_surv <- create_event_dist(dist = \"weibull\", lambdas = 1 / 200, gammas = 1) exp_event_dist <- create_event_dist(dist = \"exponential\", lambdas = 1 / 36) null_event_dist() #> An object of class \"DataSimEvent\" #> Slot \"params\": #> list() #>  #> Slot \"label\": #> [1] \"No distribution specified\" #>"},{"path":"https://genentech.github.io/psborrow2/reference/create_simulation_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Compile MCMC sampler using STAN and create simulation object — create_simulation_obj","title":"Compile MCMC sampler using STAN and create simulation object — create_simulation_obj","text":"Compile MCMC sampler using STAN create simulation object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_simulation_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compile MCMC sampler using STAN and create simulation object — create_simulation_obj","text":"","code":"create_simulation_obj(   data_matrix_list,   covariate = NULL,   outcome,   borrowing,   treatment,   quiet = TRUE )"},{"path":"https://genentech.github.io/psborrow2/reference/create_simulation_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compile MCMC sampler using STAN and create simulation object — create_simulation_obj","text":"data_matrix_list SimDataList. list lists data matrices created sim_data_list(). covariate SimCovariateList Covariate NULL. List Covariate objects created sim_covariate(), single Covariate object created add_covariates(), NULL (covariate adjustment). outcome SimOutcomeList Outcome. List Outcome objects created sim_outcome(), single Outcome object (e.g., created outcome_surv_exponential()). borrowing SimBorrowingList Borrowing. List Borrowing objects created sim_borrowing(), single Borrowing object created borrowing_full(), borrowing_none(), borrowing_hierarchical_commensurate(). treatment SimTreatmentList Treatment. List Treatment objects created sim_treatment() single Treatment object created treatment_details(). quiet logical. Whether print messages (quiet = FALSE) (quiet = TRUE, default)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_simulation_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compile MCMC sampler using STAN and create simulation object — create_simulation_obj","text":"Object class Simulation.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_simulation_obj.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compile MCMC sampler using STAN and create simulation object — create_simulation_obj","text":"","code":"base_mat <- matrix(   c(     rep(0, 200), rep(0, 200), rep(1, 200),     rep(1, 200), rep(0, 200), rep(0, 200),     rep(0, 600)   ),   ncol = 3,   dimnames = list(NULL, c(\"ext\", \"trt\", \"driftOR\")) )  add_binary_endpoint <- function(odds_ratio,                                 base_matrix = base_mat) {   linear_predictor <- base_matrix[, \"trt\"] * log(odds_ratio)   prob <- 1 / (1 + exp(-linear_predictor))    bin_endpoint <- rbinom(     NROW(base_matrix),     1,     prob   )    cbind(base_matrix, matrix(bin_endpoint, ncol = 1, dimnames = list(NULL, \"ep\"))) }  data_list <- list(   list(add_binary_endpoint(1.5), add_binary_endpoint(1.5)),   list(add_binary_endpoint(2.5), add_binary_endpoint(2.5)) )  guide <- data.frame(   trueOR = c(1.5, 2.5),   driftOR = c(1.0, 1.0),   index = 1:2 )  sdl <- sim_data_list(   data_list = data_list,   guide = guide,   effect = \"trueOR\",   drift = \"driftOR\",   index = \"index\" )  if (check_cmdstan()) {   sim_object <- create_simulation_obj(     data_matrix_list = sdl,     outcome = outcome_bin_logistic(\"ep\", prior_normal(0, 1000)),     borrowing = sim_borrowing_list(list(       full_borrowing = borrowing_full(\"ext\"),       bdb = borrowing_hierarchical_commensurate(\"ext\", prior_exponential(0.0001))     )),     treatment = treatment_details(\"trt\", prior_normal(0, 1000))   ) }"},{"path":"https://genentech.github.io/psborrow2/reference/create_tau_string.html","id":null,"dir":"Reference","previous_headings":"","what":"Create tau string — create_tau_string","title":"Create tau string — create_tau_string","text":"Create tau string","code":""},{"path":"https://genentech.github.io/psborrow2/reference/create_tau_string.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create tau string — create_tau_string","text":"","code":"create_tau_string(borrowing_object)  # S4 method for Borrowing create_tau_string(borrowing_object)  # S4 method for BorrowingHierarchicalCommensurate create_tau_string(borrowing_object)"},{"path":"https://genentech.github.io/psborrow2/reference/create_tau_string.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create tau string — create_tau_string","text":"borrowing_object borrowing object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/custom_enrollment.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a DataSimEnrollment Object — custom_enrollment","title":"Create a DataSimEnrollment Object — custom_enrollment","text":"Create DataSimEnrollment Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/custom_enrollment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a DataSimEnrollment Object — custom_enrollment","text":"","code":"custom_enrollment(fun, label)"},{"path":"https://genentech.github.io/psborrow2/reference/custom_enrollment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a DataSimEnrollment Object — custom_enrollment","text":"fun function takes one argument n number enrollment times observe returns vector times. label user-friendly label","code":""},{"path":"https://genentech.github.io/psborrow2/reference/custom_enrollment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a DataSimEnrollment Object — custom_enrollment","text":"DataSimEnrollment object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/custom_enrollment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a DataSimEnrollment Object — custom_enrollment","text":"","code":"custom_enrollment(   fun = function(n) rpois(n, lambda = 5),   label = \"Poisson enrollment distribution\" ) #> An object of class \"DataSimEnrollment\" #> Slot \"fun\": #> function(n) rpois(n, lambda = 5) #> <environment: 0x5622c4dcb0a0> #>  #> Slot \"label\": #> [1] \"Poisson enrollment distribution\" #>"},{"path":"https://genentech.github.io/psborrow2/reference/cut_off_funs.html","id":null,"dir":"Reference","previous_headings":"","what":"Cut Off Functions — cut_off_funs","title":"Cut Off Functions — cut_off_funs","text":"Cut Functions","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cut_off_funs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cut Off Functions — cut_off_funs","text":"","code":"cut_off_none()  cut_off_after_first(time)  cut_off_after_last(time)  cut_off_after_events(n)"},{"path":"https://genentech.github.io/psborrow2/reference/cut_off_funs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cut Off Functions — cut_off_funs","text":"time Time cut n Number events","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cut_off_funs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cut Off Functions — cut_off_funs","text":"DataSimCutOff object containing cut-function","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cut_off_funs.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Cut Off Functions — cut_off_funs","text":"cut_off_none(): cut specified cut_off_after_first(): Cut time first enrolled patient cut_off_after_last(): Cut time last enrolled patient cut_off_after_events(): Cut time n-th event","code":""},{"path":"https://genentech.github.io/psborrow2/reference/cut_off_funs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cut Off Functions — cut_off_funs","text":"","code":"cut_off_none() #> An object of class \"DataSimCutOff\" #> Slot \"fun\": #> function (data)  #> { #>     data #> } #> <bytecode: 0x5622c7900290> #> <environment: 0x5622c7900108> #>  #> Slot \"label\": #> [1] \"No cut off\" #>  cut_off_after_first(time = 36) #> An object of class \"DataSimCutOff\" #> Slot \"fun\": #> function (data)  #> { #>     cut_time <- min(data$enrollment) + time #>     after_cut_off <- data$enrollment + data$eventtime > cut_time #>     data$status <- ifelse(after_cut_off, 0, data$status) #>     data$eventtime <- ifelse(after_cut_off, cut_time - data$enrollment,  #>         data$eventtime) #>     data[data$enrollment < cut_time, ] #> } #> <bytecode: 0x5622c8cb48e0> #> <environment: 0x5622c8cb6f00> #>  #> Slot \"label\": #> Cut off after first enrolled patient reaches time = 36 #>  cut_off_after_last(time = 36) #> An object of class \"DataSimCutOff\" #> Slot \"fun\": #> function (data)  #> { #>     cut_time <- max(data$enrollment) + time #>     after_cut_off <- data$enrollment + data$eventtime > cut_time #>     data$status <- ifelse(after_cut_off, 0, data$status) #>     data$eventtime <- ifelse(after_cut_off, cut_time - data$enrollment,  #>         data$eventtime) #>     data #> } #> <bytecode: 0x5622c9f80600> #> <environment: 0x5622c9f7f020> #>  #> Slot \"label\": #> Cut off after last enrolled patient reaches time=36 #>  cut_off_after_events(n = 20) #> An object of class \"DataSimCutOff\" #> Slot \"fun\": #> function (data)  #> { #>     cut_time <- sort(data$enrollment + data$eventtime)[n] #>     after_cut_off <- data$enrollment + data$eventtime > cut_time #>     data$status <- ifelse(after_cut_off, 0, data$status) #>     data$eventtime <- ifelse(after_cut_off, cut_time - data$enrollment,  #>         data$eventtime) #>     data[data$enrollment < cut_time, ] #> } #> <bytecode: 0x5622c8d2dc88> #> <environment: 0x5622c8d300e8> #>  #> Slot \"label\": #> Cut off after 20 events #>"},{"path":"https://genentech.github.io/psborrow2/reference/enrollment_constant.html","id":null,"dir":"Reference","previous_headings":"","what":"Constant Enrollment Rates — enrollment_constant","title":"Constant Enrollment Rates — enrollment_constant","text":"Constant Enrollment Rates","code":""},{"path":"https://genentech.github.io/psborrow2/reference/enrollment_constant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constant Enrollment Rates — enrollment_constant","text":"","code":"enrollment_constant(rate, for_time = rep(1, length(rate)))"},{"path":"https://genentech.github.io/psborrow2/reference/enrollment_constant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constant Enrollment Rates — enrollment_constant","text":"rate Number patients enroll per unit time for_time Number time periods rate. Must equal length rate","code":""},{"path":"https://genentech.github.io/psborrow2/reference/enrollment_constant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constant Enrollment Rates — enrollment_constant","text":"object class DataSimEnrollment passed create_data_simulation()","code":""},{"path":"https://genentech.github.io/psborrow2/reference/enrollment_constant.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Constant Enrollment Rates — enrollment_constant","text":"","code":"# 10 patients/month for 6 months, then 5/month for 6 months enroll_obj <- enrollment_constant(rate = c(10, 5), for_time = c(6, 6)) enroll_obj@fun(n = 80) #>  [1]  1  1  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  3  3  3  3  3 #> [26]  3  3  3  3  3  4  4  4  4  4  4  4  4  4  4  5  5  5  5  5  5  5  5  5  5 #> [51]  6  6  6  6  6  6  6  6  6  6  7  7  7  7  7  8  8  8  8  8  9  9  9  9  9 #> [76] 10 10 10 10 10"},{"path":"https://genentech.github.io/psborrow2/reference/eval_constraints.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate constraints — eval_constraints","title":"Evaluate constraints — eval_constraints","text":"Evaluate constraints called","code":""},{"path":"https://genentech.github.io/psborrow2/reference/eval_constraints.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate constraints — eval_constraints","text":"","code":"eval_constraints(object)  # S4 method for Prior eval_constraints(object)"},{"path":"https://genentech.github.io/psborrow2/reference/eval_constraints.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate constraints — eval_constraints","text":"object Prior object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/example_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Example data matrix — example_matrix","title":"Example data matrix — example_matrix","text":"matrix containing data clinical trial treatment arm control arm, well data external control. simulated dataset, true hazard ratio (HR) time--event endpoint comparing experimental treatment control treatment 0.70. true odds ratio () binary response endpoint comparing experimental treatment control treatment 1.20.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/example_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example data matrix — example_matrix","text":"","code":"example_matrix"},{"path":"https://genentech.github.io/psborrow2/reference/example_matrix.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example data matrix — example_matrix","text":"data frame 500 rows 11 columns. distributions patients : 50 internal control patients, 100 internal experimental patients, 350 external control patients. id patient identifier ext 0/1, flag external controls trt 0/1, flag treatment arm cov1 0/1, baseline covariate cov2 0/1, baseline covariate cov3 0/1, baseline covariate cov4 0/1, baseline covariate time numeric >0, survival time status 0/1, indicator event status (1 = event, 0 = event) cnsr 0/1, censoring indicator (1 = censored, 0 = censored) resp 0/1, indicator response outcome (1 = response, 0 = response)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/example_surv.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Survival Data — example_surv","title":"Simulated Survival Data — example_surv","text":"data frame containing simulated data clinical trial treatment arm (n=200) control arm (n=158), well data external control (n=242).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/example_surv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated Survival Data — example_surv","text":"","code":"example_surv"},{"path":"https://genentech.github.io/psborrow2/reference/example_surv.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated Survival Data — example_surv","text":"data frame 600 rows 6 variables: trt 0/1, flag treatment arm ext 0/1, flag external controls eventtime numeric >0, survival time status 0/1, event indicator censor 0/1, censoring indicator cov1 0/1, binary baseline covariate 1 cov2 integer [0, 15], baseline covariate 2 cov3 continuous numeric, baseline covariate 3","code":""},{"path":"https://genentech.github.io/psborrow2/reference/exp_surv_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the exponential survival distribution — exp_surv_dist","title":"Legacy function for the exponential survival distribution — exp_surv_dist","text":"Please use outcome_surv_exponential() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/exp_surv_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the exponential survival distribution — exp_surv_dist","text":"","code":"exp_surv_dist(...)"},{"path":"https://genentech.github.io/psborrow2/reference/exp_surv_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the exponential survival distribution — exp_surv_dist","text":"... Deprecated arguments exp_surv_dist().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/exp_surv_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the exponential survival distribution — exp_surv_dist","text":"function return value. called, triggers error message indicating exp_surv_dist() deprecated outcome_surv_exponential() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/exponential_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the exponential prior — exponential_prior","title":"Legacy function for the exponential prior — exponential_prior","text":"Please use prior_exponential() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/exponential_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the exponential prior — exponential_prior","text":"","code":"exponential_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/exponential_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the exponential prior — exponential_prior","text":"... Deprecated arguments exponential_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/exponential_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the exponential prior — exponential_prior","text":"function return value. called, triggers error message indicating exponential_prior() deprecated prior_exponential() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/gamma_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the gamma prior — gamma_prior","title":"Legacy function for the gamma prior — gamma_prior","text":"Please use prior_gamma() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/gamma_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the gamma prior — gamma_prior","text":"","code":"gamma_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/gamma_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the gamma prior — gamma_prior","text":"... Deprecated arguments gamma_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/gamma_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the gamma prior — gamma_prior","text":"function return value. called, triggers error message indicating gamma_prior() deprecated prior_gamma() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate-BaselineObject-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Data for a BaselineObject — generate,BaselineObject-method","title":"Generate Data for a BaselineObject — generate,BaselineObject-method","text":"Generate Data BaselineObject","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate-BaselineObject-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Data for a BaselineObject — generate,BaselineObject-method","text":"","code":"# S4 method for BaselineObject generate(x, ...)"},{"path":"https://genentech.github.io/psborrow2/reference/generate-BaselineObject-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Data for a BaselineObject — generate,BaselineObject-method","text":"x BaselineObject object created create_baseline_object ... additional parameters ignored","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate-BaselineObject-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Data for a BaselineObject — generate,BaselineObject-method","text":"BaselineDataFrame object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate-BaselineObject-method.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Data for a BaselineObject — generate,BaselineObject-method","text":"","code":"bl_biomarkers <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 100,   covariates = baseline_covariates(     c(\"b1\", \"b2\", \"b3\"),     means_int = c(0, 0, 0),     covariance_int = covariance_matrix(c(1, 1, 1), c(.8, .3, .8))   ),   transformations = list(     exp_b1 = function(data) exp(data$b1),     b2 = binary_cutoff(\"b2\", int_cutoff = 0.7, ext_cutoff = 0.5)   ) ) generate(bl_biomarkers) #> Baseline Data List #>  #> Internal Treated #>  patid ext trt          b1 b2           b3    exp_b1 #>      1   0   1 -0.29752164  0  0.651621455 0.7426565 #>      2   0   1 -0.09594731  0 -0.419500737 0.9085119 #>      3   0   1  0.68431145  0 -0.442280771 1.9824064 #>      4   0   1 -0.03911672  0  0.006301904 0.9616385 #>      5   0   1 -0.18551572  0 -0.173197245 0.8306758 #>      6   0   1 -1.17177372  0  0.449762281 0.3098169 #> Internal Control #>  patid ext trt          b1 b2          b3    exp_b1 #>    101   0   0 -0.71772681  0 -0.01722127 0.4878600 #>    102   0   0  0.37417996  0  0.09695297 1.4537987 #>    103   0   0  0.02700627  1  1.50617783 1.0273742 #>    104   0   0 -0.01032250  0 -0.22911050 0.9897306 #>    105   0   0 -0.21465875  0 -0.78306875 0.8068167 #>    106   0   0 -1.75017156  0 -0.13664082 0.1737441 #> External Control #>  patid ext trt          b1 b2          b3    exp_b1 #>    151   1   0  0.64842337  1  0.09323614 1.9125231 #>    152   1   0 -2.37665798  0  0.75488170 0.0928604 #>    153   1   0 -0.06731617  1  1.64724350 0.9348996 #>    154   1   0  1.25037819  1 -0.18215258 3.4916632 #>    155   1   0 -0.70986133  1  0.80879110 0.4917124 #>    156   1   0  1.67156477  1  1.42309757 5.3204866"},{"path":"https://genentech.github.io/psborrow2/reference/generate-DataSimObject-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Data for a DataSimObject — generate,DataSimObject-method","title":"Generate Data for a DataSimObject — generate,DataSimObject-method","text":"Generate Data DataSimObject","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate-DataSimObject-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Data for a DataSimObject — generate,DataSimObject-method","text":"","code":"# S4 method for DataSimObject generate(x, n = 1, treatment_hr = NULL, drift_hr = NULL)"},{"path":"https://genentech.github.io/psborrow2/reference/generate-DataSimObject-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Data for a DataSimObject — generate,DataSimObject-method","text":"x DataSimObject object created create_data_simulation n number data sets simulate treatment_hr vector numeric treatment effects drift_hr vector numeric drift effects","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate-DataSimObject-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Data for a DataSimObject — generate,DataSimObject-method","text":"SimDataList object use create_simulation_obj().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate-DataSimObject-method.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Data for a DataSimObject — generate,DataSimObject-method","text":"","code":"baseline_obj <- create_baseline_object(   n_trt_int = 100,   n_ctrl_int = 50,   n_ctrl_ext = 10,   covariates = baseline_covariates(     names = c(\"age\", \"score\"),     means_int = c(55, 5),     means_ext = c(60, 5),     covariance_int = covariance_matrix(c(5, 1))   ) ) sim_obj <- create_data_simulation(   baseline_obj,   coefficients = c(age = 0.001, score = 1.5),   event_dist = create_event_dist(dist = \"exponential\", lambdas = 1 / 36) ) data_sim_list <- generate(sim_obj, treatment_hr = c(0, 1), drift_hr = 0.5) #> Warning: There were 100 event times evaluated at infinity (likely due to the hazard approaching zero). Perhaps consider specifying a finite censoring time using the 'maxt' argument."},{"path":"https://genentech.github.io/psborrow2/reference/generate.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Data from Object — generate","title":"Generate Data from Object — generate","text":"Generate Data Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Data from Object — generate","text":"","code":"generate(x, ...)"},{"path":"https://genentech.github.io/psborrow2/reference/generate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Data from Object — generate","text":"x object ... arguments passed methods","code":""},{"path":"https://genentech.github.io/psborrow2/reference/generate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Data from Object — generate","text":"Object class SimDataList.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_cmd_stan_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Get CmdStanModel objects for MCMCSimulationResults — get_cmd_stan_models","title":"Get CmdStanModel objects for MCMCSimulationResults — get_cmd_stan_models","text":"Show CmdStanModel objects MCMCSimulationResults objects.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_cmd_stan_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get CmdStanModel objects for MCMCSimulationResults — get_cmd_stan_models","text":"","code":"get_cmd_stan_models(object)  # S4 method for MCMCSimulationResult get_cmd_stan_models(object)"},{"path":"https://genentech.github.io/psborrow2/reference/get_cmd_stan_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get CmdStanModel objects for MCMCSimulationResults — get_cmd_stan_models","text":"object MCMCSimulationResults object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_cmd_stan_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get CmdStanModel objects for MCMCSimulationResults — get_cmd_stan_models","text":"List lists CmdStanModel objects model.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Simulated Data from SimDataList object — get_data","title":"Get Simulated Data from SimDataList object — get_data","text":"Retrieves simulated data SimDataList object index.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Simulated Data from SimDataList object — get_data","text":"","code":"get_data(object, index = 1, dataset = 1)  # S4 method for SimDataList get_data(object, index = NULL, dataset = NULL)"},{"path":"https://genentech.github.io/psborrow2/reference/get_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Simulated Data from SimDataList object — get_data","text":"object SimDataList object index index scenario (see guide print(SimDataList)) dataset dataset n_datasets_per_param","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Simulated Data from SimDataList object — get_data","text":"Simulated data data frame index specified, else list","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_quantiles.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Quantiles of Random Data — get_quantiles","title":"Get Quantiles of Random Data — get_quantiles","text":"Helper use within transformation functions create_baseline_object().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_quantiles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Quantiles of Random Data — get_quantiles","text":"","code":"get_quantiles(object, var)"},{"path":"https://genentech.github.io/psborrow2/reference/get_quantiles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Quantiles of Random Data — get_quantiles","text":"object BaselineDataFrame var character string name variable","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_quantiles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Quantiles of Random Data — get_quantiles","text":"numeric vector containing quantiles based data generating distribution.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Get results for MCMCSimulationResults objects — get_results","title":"Get results for MCMCSimulationResults objects — get_results","text":"Get results data.frame MCMCSimulationResults objects.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get results for MCMCSimulationResults objects — get_results","text":"","code":"get_results(object)  # S4 method for MCMCSimulationResult get_results(object)"},{"path":"https://genentech.github.io/psborrow2/reference/get_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get results for MCMCSimulationResults objects — get_results","text":"object MCMCSimulationResults object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get results for MCMCSimulationResults objects — get_results","text":"data.frame simulation results.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_stan_code.html","id":null,"dir":"Reference","previous_headings":"","what":"Get method for Stan model — get_stan_code","title":"Get method for Stan model — get_stan_code","text":"Get method Stan model","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_stan_code.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get method for Stan model — get_stan_code","text":"","code":"get_stan_code(object)  # S4 method for Analysis get_stan_code(object)"},{"path":"https://genentech.github.io/psborrow2/reference/get_stan_code.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get method for Stan model — get_stan_code","text":"object Analysis object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_stan_code.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get method for Stan model — get_stan_code","text":"String containing Stan model","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Variables — get_vars","title":"Get Variables — get_vars","text":"Gets data variable names object.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Variables — get_vars","text":"","code":"get_vars(object)  # S4 method for Covariates get_vars(object)  # S4 method for Treatment get_vars(object)  # S4 method for Borrowing get_vars(object)  # S4 method for TimeToEvent get_vars(object)  # S4 method for BinaryOutcome get_vars(object)  # S4 method for ContinuousOutcome get_vars(object)  # S4 method for Analysis get_vars(object)  # S4 method for NULL get_vars(object)  # S4 method for SimTreatmentList get_vars(object)  # S4 method for SimOutcomeList get_vars(object)  # S4 method for SimBorrowingList get_vars(object)  # S4 method for SimCovariateList get_vars(object)  # S4 method for Simulation get_vars(object)  # S4 method for BaselineObject get_vars(object)"},{"path":"https://genentech.github.io/psborrow2/reference/get_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Variables — get_vars","text":"object Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Variables — get_vars","text":"character vector containing variable names","code":""},{"path":"https://genentech.github.io/psborrow2/reference/get_vars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Variables — get_vars","text":"","code":"get_vars(treatment_details(   trt_flag_col = \"treat_fl\",   trt_prior = prior_normal(0, 1000) )) #> trt_flag_col  #>   \"treat_fl\""},{"path":"https://genentech.github.io/psborrow2/reference/half_cauchy_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the half-cauchy prior — half_cauchy_prior","title":"Legacy function for the half-cauchy prior — half_cauchy_prior","text":"Please use prior_half_cauchy() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/half_cauchy_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the half-cauchy prior — half_cauchy_prior","text":"","code":"half_cauchy_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/half_cauchy_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the half-cauchy prior — half_cauchy_prior","text":"... Deprecated arguments half_cauchy_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/half_cauchy_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the half-cauchy prior — half_cauchy_prior","text":"function return value. called, triggers error message indicating half_cauchy_prior() deprecated prior_half_cauchy() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/half_normal_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the normal half prior — half_normal_prior","title":"Legacy function for the normal half prior — half_normal_prior","text":"Please use prior_half_normal() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/half_normal_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the normal half prior — half_normal_prior","text":"","code":"half_normal_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/half_normal_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the normal half prior — half_normal_prior","text":"... Deprecated arguments half_normal_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/half_normal_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the normal half prior — half_normal_prior","text":"function return value. called, triggers error message indicating half_normal_prior() deprecated prior_half_normal() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/logistic_bin_outcome.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for binary logistic regression — logistic_bin_outcome","title":"Legacy function for binary logistic regression — logistic_bin_outcome","text":"Please use outcome_bin_logistic() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/logistic_bin_outcome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for binary logistic regression — logistic_bin_outcome","text":"","code":"logistic_bin_outcome(...)"},{"path":"https://genentech.github.io/psborrow2/reference/logistic_bin_outcome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for binary logistic regression — logistic_bin_outcome","text":"... Deprecated arguments logistic_bin_outcome.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/logistic_bin_outcome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for binary logistic regression — logistic_bin_outcome","text":"function return value. called, triggers error message indicating logistic_bin_outcome() deprecated outcome_bin_logistic() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/make_model_string_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Stan Code for Model — make_model_string_model","title":"Create Stan Code for Model — make_model_string_model","text":"Create Stan Code Model","code":""},{"path":"https://genentech.github.io/psborrow2/reference/make_model_string_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Stan Code for Model — make_model_string_model","text":"","code":"make_model_string_model(borrowing, outcome, analysis_obj)  # S4 method for ANY,ANY,Analysis make_model_string_model(borrowing, outcome, analysis_obj)  # S4 method for BorrowingFull,ANY,Analysis make_model_string_model(borrowing, outcome, analysis_obj)  # S4 method for BorrowingNone,ANY,Analysis make_model_string_model(borrowing, outcome, analysis_obj)  # S4 method for BorrowingHierarchicalCommensurate,ANY,Analysis make_model_string_model(borrowing, outcome, analysis_obj)"},{"path":"https://genentech.github.io/psborrow2/reference/make_model_string_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Stan Code for Model — make_model_string_model","text":"borrowing borrowing object outcome outcome object analysis_obj analysis object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/make_model_string_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Stan Code for Model — make_model_string_model","text":"glue  character containing Stan code data block.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/make_model_string_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Stan Code for Model — make_model_string_model","text":"","code":"anls_obj <- create_analysis_obj(     data_matrix = example_matrix,     outcome = outcome_surv_exponential(       \"time\",       \"cnsr\",       baseline_prior = prior_normal(0, 1000)     ),     borrowing = borrowing_hierarchical_commensurate(       \"ext\",       prior_exponential(.001)     ),     treatment = treatment_details(       \"trt\",       prior_normal(0, 1000)     ),     covariates = add_covariates(       covariates = c(\"cov1\", \"cov2\"),       priors = prior_normal(0, 1000)     )   ) #> Inputs look good. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`. make_model_string_model(anls_obj@borrowing, anls_obj@outcome, anls_obj) #> model { #>   vector[N] lp; #>   vector[N] elp; #>   beta_trt ~ normal(0, 1000); #>   lp = X * beta + Z * alpha + trt * beta_trt; #> elp = exp(lp) ; #>    #>   beta[1] ~ normal(0, 1000) ; #> beta[2] ~ normal(0, 1000) ; #>   tau ~ exponential(0.001) ; #> real sigma; #> sigma = 1 / tau; #> alpha[2] ~ normal(0, 1000) ; #> alpha[1] ~ normal(alpha[2], sqrt(sigma)) ; #>   for (i in 1:N) { #>    if (cens[i] == 1) { #>       target += exponential_lccdf(time[i] | elp[i] ); #>    } else { #>       target += exponential_lpdf(time[i] | elp[i] ); #>    } #> } #> }"},{"path":"https://genentech.github.io/psborrow2/reference/mcmc_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from Stan model — mcmc_sample","title":"Sample from Stan model — mcmc_sample","text":"Method sample compiled Stan model return CmdStanMCMC object draws.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/mcmc_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from Stan model — mcmc_sample","text":"","code":"mcmc_sample(x, ...)  # S4 method for ANY mcmc_sample(x, ...)  # S4 method for Analysis mcmc_sample(   x,   iter_warmup = 1000L,   iter_sampling = 10000L,   chains = 4L,   verbose = FALSE,   ... )  # S4 method for Simulation mcmc_sample(   x,   posterior_quantiles = c(0.025, 0.975),   iter_warmup = 1000L,   iter_sampling = 10000L,   chains = 4L,   verbose = FALSE,   keep_cmd_stan_models = FALSE,   ... )"},{"path":"https://genentech.github.io/psborrow2/reference/mcmc_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from Stan model — mcmc_sample","text":"x object sample, Analysis (created create_analysis_obj()) Simulation. ... additional arguments passed $sample() method cmdstanr Stan model. See https://mc-stan.org/cmdstanr/reference/model-method-sample.html iter_warmup integer. number warm iterations run per chain. default 1000. iter_sampling integer. number post-warm iterations run per chain. default 10000. chains integer. number Markov chains run. default 4. verbose logical. Whether print sampler updates (TRUE) (FALSE) posterior_quantiles numeric vector length two. posterior quantiles used summarizing simulation results. default c(0.025, 0.975) See details. keep_cmd_stan_models logical. Whether keep CmdStanModel objects mcmc_sampler (TRUE, discouraged scenarios) (FALSE). default FALSE.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/mcmc_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from Stan model — mcmc_sample","text":"object class CmdStanMCMC object class MCMCSimulationResult","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/mcmc_sample.html","id":"simulation-objects","dir":"Reference","previous_headings":"","what":"Simulation objects","title":"Sample from Stan model — mcmc_sample","text":"function takes draws MCMC sampler summarizes results.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/mcmc_sample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from Stan model — mcmc_sample","text":"","code":"## Analysis objects if (check_cmdstan()) {   anls <- create_analysis_obj(     data_matrix = example_matrix,     covariates = add_covariates(       covariates = c(\"cov1\", \"cov2\"),       priors = prior_normal(0, 1000)     ),     outcome = outcome_surv_weibull_ph(       \"time\",       \"cnsr\",       shape_prior = prior_normal(0, 1000),       baseline_prior = prior_normal(0, 1000)     ),     borrowing = borrowing_hierarchical_commensurate(       \"ext\",       prior_exponential(.001)     ),     treatment = treatment_details(\"trt\", prior_normal(0, 1000))   )    mcmc_results <- mcmc_sample(anls, chains = 1, iter_warmup = 500L, iter_sampling = 1000L) } #> Inputs look good. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 2.7 seconds.  ## Simulation objects base_mat <- matrix(   c(     rep(0, 200), rep(0, 200), rep(1, 200),     rep(1, 200), rep(0, 200), rep(0, 200),     rep(0, 600)   ),   ncol = 3,   dimnames = list(NULL, c(\"ext\", \"trt\", \"driftOR\")) )  add_binary_endpoint <- function(odds_ratio,                                 base_matrix = base_mat) {   linear_predictor <- base_matrix[, \"trt\"] * log(odds_ratio)   prob <- 1 / (1 + exp(-linear_predictor))    bin_endpoint <- rbinom(     NROW(base_matrix),     1,     prob   )    cbind(base_matrix, matrix(bin_endpoint, ncol = 1, dimnames = list(NULL, \"ep\"))) }  data_list <- list(   list(add_binary_endpoint(1.5), add_binary_endpoint(1.5)),   list(add_binary_endpoint(2.5), add_binary_endpoint(2.5)) )  guide <- data.frame(   trueOR = c(1.5, 2.5),   driftOR = c(1.0, 1.0),   index = 1:2 )  sdl <- sim_data_list(   data_list = data_list,   guide = guide,   effect = \"trueOR\",   drift = \"driftOR\",   index = \"index\" )  if (check_cmdstan()) {   sim_object <- create_simulation_obj(     data_matrix_list = sdl,     outcome = outcome_bin_logistic(\"ep\", prior_normal(0, 1000)),     borrowing = sim_borrowing_list(list(       full_borrowing = borrowing_full(\"ext\"),       bdb = borrowing_hierarchical_commensurate(\"ext\", prior_exponential(0.0001))     )),     treatment = treatment_details(\"trt\", prior_normal(0, 1000))   )    mcmc_sample(sim_object, chains = 1, iter_warmup = 500L, iter_sampling = 1000L) } #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 0.4 seconds. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 0.4 seconds. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 0.4 seconds. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 0.4 seconds. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 2.9 seconds. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 2.7 seconds. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 2.8 seconds. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 3.8 seconds. #> `MCMCSimulationResult` object.  Call `get_results()` to save outputs as a data.frame if (FALSE) { library(future) # Use two separate R processes plan(\"multisession\", workers = 2)  # and two parallel threads in each. mcmc_sample(sim_object, chains = 1, iter_warmup = 500L, iter_sampling = 1000L, parallel_chains = 2)  # Tidy up processes when finished plan(\"sequential\") }"},{"path":"https://genentech.github.io/psborrow2/reference/normal_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the normal prior — normal_prior","title":"Legacy function for the normal prior — normal_prior","text":"Please use prior_normal() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/normal_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the normal prior — normal_prior","text":"","code":"normal_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/normal_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the normal prior — normal_prior","text":"... Deprecated arguments normal_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/normal_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the normal prior — normal_prior","text":"function return value. called, triggers error message indicating normal_prior() deprecated prior_normal() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_bin_logistic.html","id":null,"dir":"Reference","previous_headings":"","what":"Bernoulli distribution with logit parametrization — outcome_bin_logistic","title":"Bernoulli distribution with logit parametrization — outcome_bin_logistic","text":"Bernoulli distribution logit parametrization","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_bin_logistic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bernoulli distribution with logit parametrization — outcome_bin_logistic","text":"","code":"outcome_bin_logistic(binary_var, baseline_prior, weight_var = \"\")"},{"path":"https://genentech.github.io/psborrow2/reference/outcome_bin_logistic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bernoulli distribution with logit parametrization — outcome_bin_logistic","text":"binary_var character. Name binary (1/0 TRUE/FALSE) outcome variable model matrix baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. See Details information. weight_var character. Optional name variable model matrix weighting log likelihood.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_bin_logistic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bernoulli distribution with logit parametrization — outcome_bin_logistic","text":"Object class OutcomeBinaryLogistic.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_bin_logistic.html","id":"baseline-prior","dir":"Reference","previous_headings":"","what":"Baseline Prior","title":"Bernoulli distribution with logit parametrization — outcome_bin_logistic","text":"baseline_prior argument specifies prior distribution baseline log odds. interpretation baseline_prior differs slightly borrowing methods selected. Dynamic borrowing using borrowing_hierarchical_commensurate(): baseline_prior Bayesian Dynamic Borrowing refers log odds external control arm. Full borrowing borrowing using borrowing_full() borrowing_none(): baseline_prior borrowing methods refers log odds internal control arm.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_bin_logistic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bernoulli distribution with logit parametrization — outcome_bin_logistic","text":"","code":"lg <- outcome_bin_logistic(   binary_var = \"response\",   baseline_prior = prior_normal(0, 1000) )"},{"path":"https://genentech.github.io/psborrow2/reference/outcome_cont_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal Outcome Distribution — outcome_cont_normal","title":"Normal Outcome Distribution — outcome_cont_normal","text":"Normal Outcome Distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_cont_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal Outcome Distribution — outcome_cont_normal","text":"","code":"outcome_cont_normal(   continuous_var,   baseline_prior,   std_dev_prior,   weight_var = \"\" )"},{"path":"https://genentech.github.io/psborrow2/reference/outcome_cont_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normal Outcome Distribution — outcome_cont_normal","text":"continuous_var character. Name continuous outcome variable model matrix baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. See Details information. std_dev_prior Prior. Object class Prior specifying prior distribution standard deviation outcome distribution (.e. \"sigma\"). weight_var character. Optional name variable model matrix weighting log likelihood.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_cont_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normal Outcome Distribution — outcome_cont_normal","text":"Object class OutcomeContinuousNormal.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_cont_normal.html","id":"baseline-prior","dir":"Reference","previous_headings":"","what":"Baseline Prior","title":"Normal Outcome Distribution — outcome_cont_normal","text":"baseline_prior argument specifies prior distribution intercept linear model. interpretation baseline_prior differs slightly borrowing methods selected. Dynamic borrowing using borrowing_hierarchical_commensurate(): baseline_prior Bayesian Dynamic Borrowing refers intercept external control arm. Full borrowing borrowing using borrowing_full() borrowing_none(): baseline_prior borrowing methods refers intercept internal control arm.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_cont_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normal Outcome Distribution — outcome_cont_normal","text":"","code":"norm <- outcome_cont_normal(   continuous_var = \"tumor_size\",   baseline_prior = prior_normal(0, 100),   std_dev_prior = prior_half_cauchy(1, 5) )"},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_exponential.html","id":null,"dir":"Reference","previous_headings":"","what":"Exponential survival distribution — outcome_surv_exponential","title":"Exponential survival distribution — outcome_surv_exponential","text":"Exponential survival distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_exponential.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Exponential survival distribution — outcome_surv_exponential","text":"","code":"outcome_surv_exponential(time_var, cens_var, baseline_prior, weight_var = \"\")"},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_exponential.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exponential survival distribution — outcome_surv_exponential","text":"time_var character. Name time variable column model matrix cens_var character. Name censorship variable flag model matrix baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. See Details information. weight_var character. Optional name variable model matrix weighting log likelihood.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_exponential.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Exponential survival distribution — outcome_surv_exponential","text":"Object class OutcomeSurvExponential.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_exponential.html","id":"baseline-prior","dir":"Reference","previous_headings":"","what":"Baseline Prior","title":"Exponential survival distribution — outcome_surv_exponential","text":"baseline_prior argument specifies prior distribution baseline log hazard rate. interpretation baseline_prior differs slightly borrowing methods selected. Dynamic borrowing using borrowing_hierarchical_commensurate(): baseline_prior Bayesian Dynamic Borrowing refers log hazard rate external control arm. Full borrowing borrowing using borrowing_full() borrowing_none(): baseline_prior borrowing methods refers log hazard rate internal control arm.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_exponential.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Exponential survival distribution — outcome_surv_exponential","text":"","code":"es <- outcome_surv_exponential(   time_var = \"time\",   cens_var = \"cens\",   baseline_prior = prior_normal(0, 1000) )"},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_weibull_ph.html","id":null,"dir":"Reference","previous_headings":"","what":"Weibull survival distribution (proportional hazards formulation) — outcome_surv_weibull_ph","title":"Weibull survival distribution (proportional hazards formulation) — outcome_surv_weibull_ph","text":"Weibull survival distribution (proportional hazards formulation)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_weibull_ph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weibull survival distribution (proportional hazards formulation) — outcome_surv_weibull_ph","text":"","code":"outcome_surv_weibull_ph(   time_var,   cens_var,   shape_prior,   baseline_prior,   weight_var = \"\" )"},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_weibull_ph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weibull survival distribution (proportional hazards formulation) — outcome_surv_weibull_ph","text":"time_var character. Name time variable column model matrix cens_var character. Name censorship variable flag model matrix shape_prior Prior class object Weibull shape parameter. Default prior_exponential(beta = 0.0001). baseline_prior Prior. Object class Prior specifying prior distribution baseline outcome. See Details information. weight_var character. Optional name variable model matrix weighting log likelihood.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_weibull_ph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Weibull survival distribution (proportional hazards formulation) — outcome_surv_weibull_ph","text":"Object class OutcomeSurvWeibullPH.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_weibull_ph.html","id":"baseline-prior","dir":"Reference","previous_headings":"","what":"Baseline Prior","title":"Weibull survival distribution (proportional hazards formulation) — outcome_surv_weibull_ph","text":"baseline_prior argument specifies prior distribution baseline log hazard rate. interpretation baseline_prior differs slightly borrowing methods selected. Dynamic borrowing using borrowing_hierarchical_commensurate(): baseline_prior Bayesian Dynamic Borrowing refers log hazard rate external control arm. Full borrowing borrowing using borrowing_full() borrowing_none(): baseline_prior borrowing methods refers log hazard rate internal control arm.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/outcome_surv_weibull_ph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Weibull survival distribution (proportional hazards formulation) — outcome_surv_weibull_ph","text":"","code":"ws <- outcome_surv_weibull_ph(   time_var = \"time\",   cens_var = \"cens\",   shape_prior = prior_exponential(1),   baseline_prior = prior_normal(0, 1000) )"},{"path":"https://genentech.github.io/psborrow2/reference/plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Prior Objects — plot","title":"Plot Prior Objects — plot","text":"Plot prior distributions densities. Continuous distributions plotted curves discrete distributions bar plots.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Prior Objects — plot","text":"","code":"# S4 method for Prior,missing plot(   x,   y,   default_limits,   dist_type = c(\"continuous\", \"discrete\"),   density_fun,   add,   ... )  # S4 method for PriorNormal,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorExponential,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorHalfCauchy,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorBernoulli,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorBeta,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorCauchy,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorGamma,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorHalfNormal,missing plot(x, y, add = FALSE, ...)  # S4 method for PriorPoisson,missing plot(x, y, add = FALSE, ...)  # S4 method for UniformPrior,missing plot(x, y, add = FALSE, ...)"},{"path":"https://genentech.github.io/psborrow2/reference/plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Prior Objects — plot","text":"x Object inheriting Prior y used. default_limits Numeric range plot distribution . dist_type Plot continuous discrete distribution. density_fun Function takes vector values returns vector density values. add logical. Add density existing plot. ... Optional arguments plotting.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Prior Objects — plot","text":"return value, function generates plot current graphics device.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Prior Objects — plot","text":"Plot ranges selected default show 99% density unbounded distributions. limits can changed specifying xlim = c(lower, upper). Colors, line types, typical par() parameters can used.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Prior Objects — plot","text":"","code":"plot(prior_normal(1, 2))  plot(prior_exponential(0.1))  plot(prior_half_cauchy(0, 1), xlim = c(-20, 20)) plot(prior_half_cauchy(0, 2), xlim = c(-20, 20), col = 2, add = TRUE)  plot(prior_bernoulli(0.4), xlim = c(0, 15))  plot(prior_beta(2, 2))  plot(prior_cauchy(0, 1), xlim = c(-20, 20)) plot(prior_cauchy(0, 2), xlim = c(-20, 20), col = 2, add = TRUE)  plot(prior_gamma(0.1, 0.1))  plot(prior_half_normal(0, 1), xlim = c(-20, 20)) plot(prior_half_normal(0, 2), xlim = c(-20, 20), col = 2, add = TRUE)  plot(prior_poisson(5), xlim = c(0, 15))  plot(uniform_prior(1, 2), xlim = c(0, 3))"},{"path":"https://genentech.github.io/psborrow2/reference/plot_pdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Probability Density Function Values — plot_pdf","title":"Plot Probability Density Function Values — plot_pdf","text":"Plot Probability Density Function Values","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot_pdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Probability Density Function Values — plot_pdf","text":"","code":"plot_pdf(x, y, ...)"},{"path":"https://genentech.github.io/psborrow2/reference/plot_pdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Probability Density Function Values — plot_pdf","text":"x values y probability density values y = f(x) ... passed plot() Plots density values curve lower vertical limit set 0.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot_pdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Probability Density Function Values — plot_pdf","text":"return value, function generates plot current graphics device.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot_pdf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Probability Density Function Values — plot_pdf","text":"","code":"x <- seq(-2, 2, len = 100) y <- dnorm(x) plot_pdf(x, y)"},{"path":"https://genentech.github.io/psborrow2/reference/plot_pmf.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Probability Mass Function Values — plot_pmf","title":"Plot Probability Mass Function Values — plot_pmf","text":"Plot Probability Mass Function Values","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot_pmf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Probability Mass Function Values — plot_pmf","text":"","code":"plot_pmf(x, y, ..., col = \"grey\", add = FALSE)"},{"path":"https://genentech.github.io/psborrow2/reference/plot_pmf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Probability Mass Function Values — plot_pmf","text":"x values y probability mass values y = f(x) ... passed plot() rect() col Fill color bars. add Add bars existing plot. Plots probability values barplot.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot_pmf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Probability Mass Function Values — plot_pmf","text":"return value, function generates plot current graphics device.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/plot_pmf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Probability Mass Function Values — plot_pmf","text":"","code":"x <- seq(0, 5) y <- dpois(x, lambda = 2) plot_pmf(x, y)"},{"path":"https://genentech.github.io/psborrow2/reference/poisson_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the poisson prior — poisson_prior","title":"Legacy function for the poisson prior — poisson_prior","text":"Please use prior_poisson() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/poisson_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the poisson prior — poisson_prior","text":"","code":"poisson_prior(...)"},{"path":"https://genentech.github.io/psborrow2/reference/poisson_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the poisson prior — poisson_prior","text":"... Deprecated arguments poisson_prior().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/poisson_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the poisson prior — poisson_prior","text":"function return value. called, triggers error message indicating poisson_prior() deprecated prior_poisson() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/possible_data_sim_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get All Variable Names in Simulated Data Model Matrix — possible_data_sim_vars","title":"Get All Variable Names in Simulated Data Model Matrix — possible_data_sim_vars","text":"Get Variable Names Simulated Data Model Matrix","code":""},{"path":"https://genentech.github.io/psborrow2/reference/possible_data_sim_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get All Variable Names in Simulated Data Model Matrix — possible_data_sim_vars","text":"","code":"possible_data_sim_vars(object)"},{"path":"https://genentech.github.io/psborrow2/reference/possible_data_sim_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get All Variable Names in Simulated Data Model Matrix — possible_data_sim_vars","text":"object BaselineObject","code":""},{"path":"https://genentech.github.io/psborrow2/reference/possible_data_sim_vars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get All Variable Names in Simulated Data Model Matrix — possible_data_sim_vars","text":"vector variable names","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_bernoulli.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior bernoulli distribution — prior_bernoulli","title":"Prior bernoulli distribution — prior_bernoulli","text":"Prior bernoulli distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_bernoulli.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior bernoulli distribution — prior_bernoulli","text":"","code":"prior_bernoulli(theta)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_bernoulli.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior bernoulli distribution — prior_bernoulli","text":"theta numeric. Probability ([0, 1]).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_bernoulli.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior bernoulli distribution — prior_bernoulli","text":"Object class PriorBernoulli.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_bernoulli.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior bernoulli distribution — prior_bernoulli","text":"Stan reference https://mc-stan.org/docs/functions-reference/bernoulli-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_bernoulli.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior bernoulli distribution — prior_bernoulli","text":"","code":"bp <- prior_bernoulli(0.23)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_beta.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior beta distribution — prior_beta","title":"Prior beta distribution — prior_beta","text":"Prior beta distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_beta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior beta distribution — prior_beta","text":"","code":"prior_beta(alpha, beta)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_beta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior beta distribution — prior_beta","text":"alpha numeric. Shape (>=0). beta numeric. Shape (>=0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_beta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior beta distribution — prior_beta","text":"Object class PriorBeta","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_beta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior beta distribution — prior_beta","text":"Stan reference https://mc-stan.org/docs/functions-reference/beta-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_beta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior beta distribution — prior_beta","text":"","code":"bp <- prior_beta(9, 235)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_cauchy.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior cauchy distribution — prior_cauchy","title":"Prior cauchy distribution — prior_cauchy","text":"Prior cauchy distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_cauchy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior cauchy distribution — prior_cauchy","text":"","code":"prior_cauchy(mu, sigma)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_cauchy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior cauchy distribution — prior_cauchy","text":"mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_cauchy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior cauchy distribution — prior_cauchy","text":"Object class PriorCauchy.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_cauchy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior cauchy distribution — prior_cauchy","text":"Stan reference https://mc-stan.org/docs/functions-reference/cauchy-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_cauchy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior cauchy distribution — prior_cauchy","text":"","code":"cp <- prior_cauchy(1, 1)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_exponential.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior exponential distribution — prior_exponential","title":"Prior exponential distribution — prior_exponential","text":"Prior exponential distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_exponential.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior exponential distribution — prior_exponential","text":"","code":"prior_exponential(beta)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_exponential.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior exponential distribution — prior_exponential","text":"beta numeric. Inverse scale (>0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_exponential.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior exponential distribution — prior_exponential","text":"Object class PriorExponential.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_exponential.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior exponential distribution — prior_exponential","text":"Stan reference https://mc-stan.org/docs/functions-reference/exponential-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_exponential.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior exponential distribution — prior_exponential","text":"","code":"ep <- prior_exponential(1)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_gamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior gamma distribution — prior_gamma","title":"Prior gamma distribution — prior_gamma","text":"Prior gamma distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_gamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior gamma distribution — prior_gamma","text":"","code":"prior_gamma(alpha, beta)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_gamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior gamma distribution — prior_gamma","text":"alpha numeric. Shape (>0). beta numeric. Inverse scale (>=0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_gamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior gamma distribution — prior_gamma","text":"Object class PriorGamma.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_gamma.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior gamma distribution — prior_gamma","text":"Stan reference https://mc-stan.org/docs/functions-reference/gamma-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_gamma.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior gamma distribution — prior_gamma","text":"","code":"gp <- prior_gamma(0.001, 0.001)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_cauchy.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior half-cauchy distribution — prior_half_cauchy","title":"Prior half-cauchy distribution — prior_half_cauchy","text":"Prior half-cauchy distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_cauchy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior half-cauchy distribution — prior_half_cauchy","text":"","code":"prior_half_cauchy(mu, sigma)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_cauchy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior half-cauchy distribution — prior_half_cauchy","text":"mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_cauchy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior half-cauchy distribution — prior_half_cauchy","text":"Object class PriorHalfCauchy.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_cauchy.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior half-cauchy distribution — prior_half_cauchy","text":"Stan reference https://mc-stan.org/docs/functions-reference/cauchy-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_cauchy.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior half-cauchy distribution — prior_half_cauchy","text":"","code":"hcp <- prior_half_cauchy(1, 1)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior half-normal distribution — prior_half_normal","title":"Prior half-normal distribution — prior_half_normal","text":"Prior half-normal distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior half-normal distribution — prior_half_normal","text":"","code":"prior_half_normal(mu, sigma)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior half-normal distribution — prior_half_normal","text":"mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior half-normal distribution — prior_half_normal","text":"Object class PriorHalfNormal.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_normal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior half-normal distribution — prior_half_normal","text":"Stan reference https://mc-stan.org/docs/functions-reference/normal-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_half_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior half-normal distribution — prior_half_normal","text":"","code":"hcp <- prior_half_normal(1, 1)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_normal.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior normal distribution — prior_normal","title":"Prior normal distribution — prior_normal","text":"Prior normal distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_normal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior normal distribution — prior_normal","text":"","code":"prior_normal(mu, sigma)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_normal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior normal distribution — prior_normal","text":"mu numeric. Location. sigma numeric. Scale (>0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_normal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior normal distribution — prior_normal","text":"Object class PriorNormal.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_normal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior normal distribution — prior_normal","text":"Stan reference https://mc-stan.org/docs/functions-reference/normal-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_normal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior normal distribution — prior_normal","text":"","code":"np <- prior_normal(1, 1)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_poisson.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior poisson distribution — prior_poisson","title":"Prior poisson distribution — prior_poisson","text":"Prior poisson distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_poisson.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior poisson distribution — prior_poisson","text":"","code":"prior_poisson(lambda)"},{"path":"https://genentech.github.io/psborrow2/reference/prior_poisson.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior poisson distribution — prior_poisson","text":"lambda numeric. Rate (>0).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_poisson.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior poisson distribution — prior_poisson","text":"Object class PriorPoisson.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/prior_poisson.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior poisson distribution — prior_poisson","text":"Stan reference https://mc-stan.org/docs/functions-reference/poisson.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/prior_poisson.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior poisson distribution — prior_poisson","text":"","code":"pp <- prior_poisson(100)"},{"path":"https://genentech.github.io/psborrow2/reference/psborrow2-package.html","id":null,"dir":"Reference","previous_headings":"","what":"psborrow2: Bayesian Dynamic Borrowing Analysis and Simulation — psborrow2-package","title":"psborrow2: Bayesian Dynamic Borrowing Analysis and Simulation — psborrow2-package","text":"Bayesian dynamic borrowing approach incorporating external data supplement randomized, controlled trial analysis external data incorporated dynamic way (e.g., based similarity outcomes); see Viele 2013 doi:10.1002/pst.1589  overview. package implements hierarchical commensurate prior approach dynamic borrowing described Hobbes 2011 doi:10.1111/j.1541-0420.2011.01564.x . three main functionalities. First, 'psborrow2' provides user-friendly interface applying dynamic borrowing study results handles Markov Chain Monte Carlo sampling behalf user. Second, 'psborrow2' provides simulation framework compare different borrowing parameters (e.g. full borrowing, borrowing, dynamic borrowing) trial borrowing characteristics (e.g. sample size, covariates) unified way. Third, 'psborrow2' provides set functions generate data simulation studies, also allows user specify data generation process. package designed use sampling functions 'cmdstanr' can installed https://mc-stan.org/r-packages/.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/psborrow2-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"psborrow2: Bayesian Dynamic Borrowing Analysis and Simulation — psborrow2-package","text":"Maintainer: Matt Secrest secrestm@gene.com (ORCID) Authors: Isaac Gravestock isaac.gravestock@roche.com contributors: Craig Gower-Page craig.gower-page@roche.com [contributor] Genentech, Inc. [copyright holder, funder]","code":""},{"path":"https://genentech.github.io/psborrow2/reference/rename_draws_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename Covariates in draws Object — rename_draws_covariates","title":"Rename Covariates in draws Object — rename_draws_covariates","text":"Rename Covariates draws Object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/rename_draws_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename Covariates in draws Object — rename_draws_covariates","text":"","code":"rename_draws_covariates(draws, analysis)"},{"path":"https://genentech.github.io/psborrow2/reference/rename_draws_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename Covariates in draws Object — rename_draws_covariates","text":"draws draws created sampled analysis object. See example. analysis Analysis created create_analysis_obj().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/rename_draws_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rename Covariates in draws Object — rename_draws_covariates","text":"draws[posterior::draws] object covariate names.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/rename_draws_covariates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename Covariates in draws Object — rename_draws_covariates","text":"","code":"if (check_cmdstan()) {   analysis_object <- create_analysis_obj(     data_matrix = example_matrix,     covariates = add_covariates(       covariates = c(\"cov1\", \"cov2\"),       priors = prior_normal(0, 1000)     ),     outcome = outcome_surv_exponential(       \"time\",       \"cnsr\",       baseline_prior = prior_normal(0, 1000)     ),     borrowing = borrowing_hierarchical_commensurate(       \"ext\",       prior_exponential(.001)     ),     treatment = treatment_details(       \"trt\",       prior_normal(0, 1000)     )   )   samples <- mcmc_sample(analysis_object, 200, 400, 1)   draws <- samples$draws()   renamed_draws <- rename_draws_covariates(draws, analysis_object)   summary(renamed_draws) } #> Inputs look good. #> Stan program compiled successfully! #> Ready to go! Now call `mcmc_sample()`. #> Running MCMC with 1 chain... #>  #> Chain 1 finished in 0.4 seconds. #> # A tibble: 8 × 10 #>   variable         mean   median      sd    mad       q5      q95  rhat ess_bulk #>   <chr>           <dbl>    <dbl>   <dbl>  <dbl>    <dbl>    <dbl> <dbl>    <dbl> #> 1 lp__         -1.57e+3 -1.57e+3 1.76e+0 1.53   -1.57e+3 -1.56e+3 1.00      149. #> 2 treatment l… -5.52e-1 -5.53e-1 2.15e-1 0.229  -8.95e-1 -2.24e-1 1.00      215. #> 3 commensurab…  3.80e+1  9.67e+0 1.35e+2 9.61    1.19e+0  1.30e+2 1.00      198. #> 4 baseline lo… -3.73e+0 -3.73e+0 1.88e-1 0.178  -4.04e+0 -3.44e+0 1.00      196. #> 5 baseline lo… -3.21e+0 -3.21e+0 1.21e-1 0.105  -3.41e+0 -3.03e+0 1.00      181. #> 6 cov1          8.10e-1  8.01e-1 1.08e-1 0.0951  6.42e-1  9.91e-1 0.999     220. #> 7 cov2          5.76e-1  5.75e-1 9.91e-2 0.0998  4.09e-1  7.40e-1 0.998     230. #> 8 treatment HR  5.89e-1  5.75e-1 1.30e-1 0.131   4.09e-1  7.99e-1 1.00      215. #> # ℹ 1 more variable: ess_tail <dbl>"},{"path":"https://genentech.github.io/psborrow2/reference/set_cut_off.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Clinical Cut Off Rule — set_cut_off","title":"Set Clinical Cut Off Rule — set_cut_off","text":"Set Clinical Cut Rule","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_cut_off.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Clinical Cut Off Rule — set_cut_off","text":"","code":"set_cut_off(object, internal = cut_off_none(), external = cut_off_none())"},{"path":"https://genentech.github.io/psborrow2/reference/set_cut_off.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Clinical Cut Off Rule — set_cut_off","text":"object DataSimObject internal DataSimCutOff object specified one cut functions: cut_off_after_events(), cut_off_after_first(), cut_off_after_last(), cut_off_none(). external DataSimCutOff external data.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_cut_off.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Clinical Cut Off Rule — set_cut_off","text":"DataSimObject updated cut_off_internal cut_off_external slots.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_cut_off.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Clinical Cut Off Rule — set_cut_off","text":"","code":"data_sim <- create_data_simulation(   create_baseline_object(10, 10, 10),   event_dist = create_event_dist(dist = \"exponential\", lambdas = 1 / 36) ) set_cut_off(   data_sim,   cut_off_after_events(n = 10),   cut_off_after_first(time = 30) ) #> DataSimObject #> ------------- #> Baseline object: #> Baseline Data Simulation Object #>   N internal treated:  10  #>   N internal control:  10  #>   N external control:  10  #>  #> Covariates:  #> [[1]] #> [1] covariate      means_internal means_external #> <0 rows> (or 0-length row.names) #>  #> Covariance Matrices #> Internal         External #> <0 x 0 matrix>   <0 x 0 matrix>  #>  #>  #> Event distribution: #> exponential distribution with lambda = 0.0277777777777778  #>  #> Treatment HR:  1  #> Drift HR:  1  #>  #> Enrollment: #>  Internal: Enrolling 1 patient per time  #>  External: Enrolling 1 patient per time  #>  #> Dropout: #>  Internal treated: No distribution specified  #>  Internal control: No distribution specified  #>  External control: No distribution specified  #>  #> Clinical cut off: #>  Internal: Cut off after 10 events  #>  External: Cut off after first enrolled patient reaches time = 30  #>"},{"path":"https://genentech.github.io/psborrow2/reference/set_dropout.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Drop Out Distribution — set_dropout","title":"Set Drop Out Distribution — set_dropout","text":"Set Drop Distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_dropout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Drop Out Distribution — set_dropout","text":"","code":"set_dropout(object, internal_treated, internal_control, external_control)"},{"path":"https://genentech.github.io/psborrow2/reference/set_dropout.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Drop Out Distribution — set_dropout","text":"object DataSimObject internal_treated DataSimEvent object specifying distribution internal treated patients. internal_control DataSimEvent object specifying distribution internal control patients. external_control DataSimEvent object specifying distribution external control patients.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_dropout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Drop Out Distribution — set_dropout","text":"DataSimObject updated internal_treated, internal_control external_control slots.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_dropout.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set Drop Out Distribution — set_dropout","text":"DataSimEvent objects can specified create_event_dist(). Currently beta parameters can used drop distributions (unlike survival outcome).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_dropout.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Drop Out Distribution — set_dropout","text":"","code":"data_sim <- create_data_simulation(   create_baseline_object(10, 10, 10),   event_dist = create_event_dist(dist = \"exponential\", lambdas = 1 / 36) ) set_dropout(   data_sim,   internal_treated = create_event_dist(dist = \"exponential\", lambdas = 1 / 55),   internal_control = create_event_dist(dist = \"exponential\", lambdas = 1 / 50),   external_control = create_event_dist(dist = \"exponential\", lambdas = 1 / 40) ) #> DataSimObject #> ------------- #> Baseline object: #> Baseline Data Simulation Object #>   N internal treated:  10  #>   N internal control:  10  #>   N external control:  10  #>  #> Covariates:  #> [[1]] #> [1] covariate      means_internal means_external #> <0 rows> (or 0-length row.names) #>  #> Covariance Matrices #> Internal         External #> <0 x 0 matrix>   <0 x 0 matrix>  #>  #>  #> Event distribution: #> exponential distribution with lambda = 0.0277777777777778  #>  #> Treatment HR:  1  #> Drift HR:  1  #>  #> Enrollment: #>  Internal: Enrolling 1 patient per time  #>  External: Enrolling 1 patient per time  #>  #> Dropout: #>  Internal treated: exponential distribution with lambda = 0.0181818181818182  #>  Internal control: exponential distribution with lambda = 0.02  #>  External control: exponential distribution with lambda = 0.025  #>  #> Clinical cut off: #>  Internal: No cut off  #>  External: No cut off  #>"},{"path":"https://genentech.github.io/psborrow2/reference/set_enrollment.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Enrollment Rates for Internal and External Trials — set_enrollment","title":"Set Enrollment Rates for Internal and External Trials — set_enrollment","text":"Set Enrollment Rates Internal External Trials","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_enrollment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Enrollment Rates for Internal and External Trials — set_enrollment","text":"","code":"set_enrollment(object, internal, external = internal)"},{"path":"https://genentech.github.io/psborrow2/reference/set_enrollment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Enrollment Rates for Internal and External Trials — set_enrollment","text":"object DataSimObject create_data_simulation internal DataSimEnrollment object define enrollment times internal data external DataSimEnrollment object define enrollment times external data. Defaults internal.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_enrollment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Enrollment Rates for Internal and External Trials — set_enrollment","text":"DataSimObject updated enrollment_internal enrollment_external slots.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_enrollment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Enrollment Rates for Internal and External Trials — set_enrollment","text":"","code":"data_sim <- create_data_simulation(   create_baseline_object(10, 10, 10),   event_dist = create_event_dist(dist = \"exponential\", lambdas = 1 / 36) ) set_enrollment(   data_sim,   internal = enrollment_constant(rate = c(10, 5), for_time = c(6, 6)),   external = enrollment_constant(rate = c(5), for_time = c(20)) ) #> DataSimObject #> ------------- #> Baseline object: #> Baseline Data Simulation Object #>   N internal treated:  10  #>   N internal control:  10  #>   N external control:  10  #>  #> Covariates:  #> [[1]] #> [1] covariate      means_internal means_external #> <0 rows> (or 0-length row.names) #>  #> Covariance Matrices #> Internal         External #> <0 x 0 matrix>   <0 x 0 matrix>  #>  #>  #> Event distribution: #> exponential distribution with lambda = 0.0277777777777778  #>  #> Treatment HR:  1  #> Drift HR:  1  #>  #> Enrollment: #>  Internal: Enrolling patients per time at rates: 10, 10, 10, 10, 10, 10, 5, 5, 5, 5, 5, 5  #>  External: Enrolling patients per time at rates: 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5....  #>  #> Dropout: #>  Internal treated: No distribution specified  #>  Internal control: No distribution specified  #>  External control: No distribution specified  #>  #> Clinical cut off: #>  Internal: No cut off  #>  External: No cut off  #>"},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations-BaselineObject-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Transformations in Baseline Objects — set_transformations,BaselineObject-method","title":"Set Transformations in Baseline Objects — set_transformations,BaselineObject-method","text":"Set Transformations Baseline Objects","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations-BaselineObject-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Transformations in Baseline Objects — set_transformations,BaselineObject-method","text":"","code":"# S4 method for BaselineObject set_transformations(object, ..., overwrite = FALSE)"},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations-BaselineObject-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Transformations in Baseline Objects — set_transformations,BaselineObject-method","text":"object BaselineObject created create_baseline_object. ... named transformation functions. See details information. overwrite TRUE overwrite existing transformation list include newly specified transformations.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations-BaselineObject-method.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Transformations in Baseline Objects — set_transformations,BaselineObject-method","text":"updated BaselineObject","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations-BaselineObject-method.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set Transformations in Baseline Objects — set_transformations,BaselineObject-method","text":"Transformation functions evaluated order create overwrite column data.frame name. function signature function(data), taking data.frame (specifically BaselineDataFrame object generate(BaselineObject)) return vector length identical total number patients. @BaselineObject slot BaselineDataFrame may accessed directly get_quantiles() create transformations. See binary_cutoff().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations-BaselineObject-method.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Transformations in Baseline Objects — set_transformations,BaselineObject-method","text":"","code":"baseline <- create_baseline_object(   100, 50, 100,   covariates = baseline_covariates(     names = \"age\", means_int = 55,     covariance_int = covariance_matrix(5)   ) ) set_transformations(baseline, age_scaled = function(data) scale(data$age)) #> Baseline Data Simulation Object #>   N internal treated:  100  #>   N internal control:  50  #>   N external control:  100  #>  #> Covariates:  #> [[1]] #>  covariate means_internal means_external #>        age             55             55 #>  #> Covariance Matrices #> Internal   External #>     age        age  #> age   5    age   5  #>  #> Transformations:  #>    age_scaled"},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations.html","id":null,"dir":"Reference","previous_headings":"","what":"Set transformations in BaselineObject objects — set_transformations","title":"Set transformations in BaselineObject objects — set_transformations","text":"Set transformations BaselineObject objects","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set transformations in BaselineObject objects — set_transformations","text":"","code":"set_transformations(object, ..., overwrite = FALSE)"},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set transformations in BaselineObject objects — set_transformations","text":"object BaselineObject object ... Additional arguments passed methods overwrite logical. Overwrite existing transformations?","code":""},{"path":"https://genentech.github.io/psborrow2/reference/set_transformations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set transformations in BaselineObject objects — set_transformations","text":"BaselineObject object transformations","code":""},{"path":"https://genentech.github.io/psborrow2/reference/show_guide.html","id":null,"dir":"Reference","previous_headings":"","what":"Show guide for objects with guides — show_guide","title":"Show guide for objects with guides — show_guide","text":"Show guide Simulation objects.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/show_guide.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show guide for objects with guides — show_guide","text":"","code":"show_guide(object)  # S4 method for Simulation show_guide(object)"},{"path":"https://genentech.github.io/psborrow2/reference/show_guide.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show guide for objects with guides — show_guide","text":"object Simulation object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/show_guide.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show guide for objects with guides — show_guide","text":"data.frame showing simulation scenarios.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_borrowing_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Input borrowing details for a simulation study — sim_borrowing_list","title":"Input borrowing details for a simulation study — sim_borrowing_list","text":"function defining borrowing scenarios evaluated part simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_borrowing_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Input borrowing details for a simulation study — sim_borrowing_list","text":"","code":"sim_borrowing_list(borrowing_list)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_borrowing_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Input borrowing details for a simulation study — sim_borrowing_list","text":"borrowing_list named list objects class Borrowing created borrowing_full(), borrowing_none(), borrowing_hierarchical_commensurate().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_borrowing_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Input borrowing details for a simulation study — sim_borrowing_list","text":"Object class SimBorrowingList.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/sim_borrowing_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Input borrowing details for a simulation study — sim_borrowing_list","text":"","code":"borrow_scenarios <- sim_borrowing_list(   list(     \"No borrowing\" = borrowing_none(\"ext\"),     \"Full borrowing\" = borrowing_full(\"ext\"),     \"BDB, uninformative prior\" = borrowing_hierarchical_commensurate(       \"ext\",       prior_gamma(0.001, 0.001)     ),     \"BDB, informative prior\" = borrowing_hierarchical_commensurate(       \"ext\",       prior_gamma(1, 0.001)     )   ) )"},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariate_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Input covariate adjustment details for a simulation study — sim_covariate_list","title":"Input covariate adjustment details for a simulation study — sim_covariate_list","text":"function defining covariate adjustment scenarios evaluated part simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariate_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Input covariate adjustment details for a simulation study — sim_covariate_list","text":"","code":"sim_covariate_list(covariate_list)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariate_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Input covariate adjustment details for a simulation study — sim_covariate_list","text":"covariate_list named list objects class Covariate created add_covariates().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariate_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Input covariate adjustment details for a simulation study — sim_covariate_list","text":"Object class SimCovariateList.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariate_list.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Input covariate adjustment details for a simulation study — sim_covariate_list","text":"function allows user specify covariate adjustment details included part simulation study. often interest compare several adjustment methods adjustment. specify adjustment, pass NULL list item covariate_list.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariate_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Input covariate adjustment details for a simulation study — sim_covariate_list","text":"","code":"covariates <- sim_covariate_list(   list(     \"No adjustment\" = NULL,     \"Covariates 1 and 2\" = add_covariates(c(\"cov1\", \"cov2\"), prior_normal(0, 1000))   ) )"},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify covariates for simulation study — sim_covariates","title":"Specify covariates for simulation study — sim_covariates","text":"Provide details desired covariate distributions covariance simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify covariates for simulation study — sim_covariates","text":"","code":"sim_covariates(   covariates,   covariance_internal,   covariance_external = covariance_internal )"},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify covariates for simulation study — sim_covariates","text":"covariates list. Named list covariate mean values probabilities generated bin_var() (class SimVarBin cont_var() (class SimVarCont). See details information. covariance_internal matrix. Covariance matrix binarization internal patients. covariance_external matrix. Covariance matrix binarization external patients. Defaults internal covariance.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify covariates for simulation study — sim_covariates","text":"Object class SimCovariates","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify covariates for simulation study — sim_covariates","text":"function intended specify number covariates relationships purposes designing simulation study psborrow2. outcome model necessarily need adjust covariates, function necessary create_simulation_obj(). relationship treatment outcome specified elsewhere (.e, sim_survival() sim_binary_event()). need things ","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify covariates for simulation study — sim_covariates","text":"","code":"set.seed(123) covmat <- matrix(rWishart(1, 2, diag(2)), ncol = 2)  covset1 <- sim_covariates(   covariates = list(     cov1 = bin_var(0.5, 0.5),     cov2 = cont_var(100, 130)   ),   covariance_internal = covmat )"},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates_summ.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize the number of continuous and binary covariates in a SimCovariates object created by sim_covariates() — sim_covariates_summ","title":"Summarize the number of continuous and binary covariates in a SimCovariates object created by sim_covariates() — sim_covariates_summ","text":"Summarize number continuous binary covariates SimCovariates object created sim_covariates()","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates_summ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize the number of continuous and binary covariates in a SimCovariates object created by sim_covariates() — sim_covariates_summ","text":"","code":"sim_covariates_summ(sim_covariates_obj)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates_summ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize the number of continuous and binary covariates in a SimCovariates object created by sim_covariates() — sim_covariates_summ","text":"sim_covariates_obj SimCovariates. Object returned sim_covariates().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_covariates_summ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize the number of continuous and binary covariates in a SimCovariates object created by sim_covariates() — sim_covariates_summ","text":"data.frame showing covariate names types well counts binary continuous covariates.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Input generated data for a simulation study — sim_data_list","title":"Input generated data for a simulation study — sim_data_list","text":"function defining generated data use part simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Input generated data for a simulation study — sim_data_list","text":"","code":"sim_data_list(data_list, guide, effect, drift, index)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Input generated data for a simulation study — sim_data_list","text":"data_list list lists matrices. lists highest level differ parameters used generate data. matrices lowest level different iterations data generation parameters. See details. guide data.frame. guide contains information parameters differ highest level data_list. See details. effect character. column guide corresponds true treatment effect estimate (hazard ratio odds ratio). drift character. column guide corresponds true drift effect estimate (hazard ratio odds ratio). drift >1 means external arm experiences greater effects. index character. column guide corresponds index column.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Input generated data for a simulation study — sim_data_list","text":"Object class SimDataList.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Input generated data for a simulation study — sim_data_list","text":"function, providing generated data analysis simulation study psborrow2. Note function data generation behalf; assumes generated data already. full working example, refer relevant vignette: vignette('simulation_study', package = 'psborrow2'). information inputs provided .","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"matrix-requirements-in-data-list","dir":"Reference","previous_headings":"","what":"Matrix requirements in data_list","title":"Input generated data for a simulation study — sim_data_list","text":"matrix embedded data_list must : flag whether patient external control flag whether patient experimental treatment arm outcome information (time censorship survival, flag outcome binary endpoints) Optionally, matrices may also contain covariates. See examples.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"data-list","dir":"Reference","previous_headings":"","what":"data_list","title":"Input generated data for a simulation study — sim_data_list","text":"set distinct data generation parameters represented single list matrices. multiple scenarios may want compared, list list matrices preferred. See examples.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"guide","dir":"Reference","previous_headings":"","what":"guide","title":"Input generated data for a simulation study — sim_data_list","text":"guide data.frame one row per scenario. consquence , length list equal number rows guide. See examples.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/sim_data_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Input generated data for a simulation study — sim_data_list","text":"","code":"base_mat <- matrix(   c(     rep(0, 200), rep(0, 200), rep(1, 200),     rep(1, 200), rep(0, 200), rep(0, 200),     rep(0, 600)   ),   ncol = 3,   dimnames = list(NULL, c(\"ext\", \"trt\", \"driftOR\")) )  add_binary_endpoint <- function(odds_ratio,                                 base_matrix = base_mat) {   linear_predictor <- base_matrix[, \"trt\"] * log(odds_ratio)   prob <- 1 / (1 + exp(-linear_predictor))    bin_endpoint <- rbinom(     NROW(base_matrix),     1,     prob   )    cbind(base_matrix, matrix(bin_endpoint, ncol = 1, dimnames = list(NULL, \"ep\"))) }  data_list <- list(   list(add_binary_endpoint(1.5), add_binary_endpoint(1.5)),   list(add_binary_endpoint(2.5), add_binary_endpoint(2.5)) )  guide <- data.frame(   trueOR = c(1.5, 2.5),   driftOR = c(1.0, 1.0),   ind = c(1, 2) )  sdl <- sim_data_list(   data_list = data_list,   guide = guide,   effect = \"trueOR\",   drift = \"driftOR\",   index = \"ind\" )"},{"path":"https://genentech.github.io/psborrow2/reference/sim_outcome_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Input outcome details for a simulation study — sim_outcome_list","title":"Input outcome details for a simulation study — sim_outcome_list","text":"function defining outcome scenarios evaluated part simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_outcome_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Input outcome details for a simulation study — sim_outcome_list","text":"","code":"sim_outcome_list(outcome_list)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_outcome_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Input outcome details for a simulation study — sim_outcome_list","text":"outcome_list named list objects class Outcome created outcome_details().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_outcome_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Input outcome details for a simulation study — sim_outcome_list","text":"Object class SimOutcomeList.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/sim_outcome_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Input outcome details for a simulation study — sim_outcome_list","text":"","code":"outcome_scenarios <- sim_outcome_list(   list(     \"Exponential\" = outcome_surv_exponential(\"time\", \"cnsr\", prior_normal(0, 10000))   ) )"},{"path":"https://genentech.github.io/psborrow2/reference/sim_samplesize.html","id":null,"dir":"Reference","previous_headings":"","what":"Set simulation study parameters for sample size — sim_samplesize","title":"Set simulation study parameters for sample size — sim_samplesize","text":"Set simulation study parameters sample size","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_samplesize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set simulation study parameters for sample size — sim_samplesize","text":"","code":"sim_samplesize(n_internal_control, n_external_control, n_internal_experimental)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_samplesize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set simulation study parameters for sample size — sim_samplesize","text":"n_internal_control integer. Number patients simulated internal control arm. n_external_control integer. Number patients simulated external control arm. n_internal_experimental integer. Number patients simulated internal experimental arm.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_samplesize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set simulation study parameters for sample size — sim_samplesize","text":"Object class SimSampleSize","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/sim_samplesize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set simulation study parameters for sample size — sim_samplesize","text":"","code":"ss <- sim_samplesize(200, 200, 500)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_treatment_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Input treatment details for a simulation study — sim_treatment_list","title":"Input treatment details for a simulation study — sim_treatment_list","text":"function defining treatment scenarios evaluated part simulation study.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_treatment_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Input treatment details for a simulation study — sim_treatment_list","text":"","code":"sim_treatment_list(treatment_list)"},{"path":"https://genentech.github.io/psborrow2/reference/sim_treatment_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Input treatment details for a simulation study — sim_treatment_list","text":"treatment_list named list objects class Treatment created treatment_details().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/sim_treatment_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Input treatment details for a simulation study — sim_treatment_list","text":"Object class SimTreatmentList.","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/sim_treatment_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Input treatment details for a simulation study — sim_treatment_list","text":"","code":"treatment_scenarios <- sim_treatment_list(   list(     \"Standard\" = treatment_details(\"trt\", prior_normal(0, 1000))   ) )"},{"path":"https://genentech.github.io/psborrow2/reference/treatment_details.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Treatment Details — treatment_details","title":"Specify Treatment Details — treatment_details","text":"Specify treatment arm column name model matrix set prior distribution treatment effect (log hazard ratio log odds ratio)","code":""},{"path":"https://genentech.github.io/psborrow2/reference/treatment_details.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Treatment Details — treatment_details","text":"","code":"treatment_details(trt_flag_col, trt_prior)"},{"path":"https://genentech.github.io/psborrow2/reference/treatment_details.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Treatment Details — treatment_details","text":"trt_flag_col character. name column model matrix corresponds treatment flag (1/0 TRUE/FALSE). identifies patients belonging experimental treatment arm. trt_prior Object class Prior specifying prior distribution log effect estimate (log hazard ratio time event endpoints log odds ratio binary endpoints).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/treatment_details.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Treatment Details — treatment_details","text":"Object class Treatment.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/treatment_details.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Treatment Details — treatment_details","text":"","code":"sta <- treatment_details(   trt_flag_col = \"trt\",   trt_prior = prior_normal(0, 1000) )"},{"path":"https://genentech.github.io/psborrow2/reference/trim_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim columns from Data Matrix Based on Borrowing object type — trim_cols","title":"Trim columns from Data Matrix Based on Borrowing object type — trim_cols","text":"Trim columns Data Matrix Based Borrowing object type","code":""},{"path":"https://genentech.github.io/psborrow2/reference/trim_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim columns from Data Matrix Based on Borrowing object type — trim_cols","text":"","code":"trim_cols(borrowing_object, analysis_object)  # S4 method for Borrowing trim_cols(borrowing_object, analysis_object)  # S4 method for BorrowingHierarchicalCommensurate trim_cols(borrowing_object, analysis_object)"},{"path":"https://genentech.github.io/psborrow2/reference/trim_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim columns from Data Matrix Based on Borrowing object type — trim_cols","text":"borrowing_object borrowing object analysis_object analysis object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/trim_rows.html","id":null,"dir":"Reference","previous_headings":"","what":"Trim Rows from Data Matrix Based on Borrowing object type — trim_rows","title":"Trim Rows from Data Matrix Based on Borrowing object type — trim_rows","text":"Trim Rows Data Matrix Based Borrowing object type","code":""},{"path":"https://genentech.github.io/psborrow2/reference/trim_rows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Trim Rows from Data Matrix Based on Borrowing object type — trim_rows","text":"","code":"trim_rows(borrowing_object, analysis_object)  # S4 method for Borrowing trim_rows(borrowing_object, analysis_object)  # S4 method for BorrowingNone trim_rows(borrowing_object, analysis_object)"},{"path":"https://genentech.github.io/psborrow2/reference/trim_rows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Trim Rows from Data Matrix Based on Borrowing object type — trim_rows","text":"borrowing_object borrowing object analysis_object analysis object","code":""},{"path":"https://genentech.github.io/psborrow2/reference/uniform_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior uniform distribution — uniform_prior","title":"Prior uniform distribution — uniform_prior","text":"Prior uniform distribution","code":""},{"path":"https://genentech.github.io/psborrow2/reference/uniform_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior uniform distribution — uniform_prior","text":"","code":"uniform_prior(alpha, beta)"},{"path":"https://genentech.github.io/psborrow2/reference/uniform_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior uniform distribution — uniform_prior","text":"alpha numeric. Lower bound. beta numeric. Upper bound (>alpha).","code":""},{"path":"https://genentech.github.io/psborrow2/reference/uniform_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior uniform distribution — uniform_prior","text":"Object class UniformPrior.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/uniform_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior uniform distribution — uniform_prior","text":"Stan reference https://mc-stan.org/docs/functions-reference/uniform-distribution.html","code":""},{"path":[]},{"path":"https://genentech.github.io/psborrow2/reference/uniform_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior uniform distribution — uniform_prior","text":"","code":"up <- uniform_prior(0, 1)"},{"path":"https://genentech.github.io/psborrow2/reference/variable_dictionary.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Variable Dictionary — variable_dictionary","title":"Create Variable Dictionary — variable_dictionary","text":"Create Variable Dictionary","code":""},{"path":"https://genentech.github.io/psborrow2/reference/variable_dictionary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Variable Dictionary — variable_dictionary","text":"","code":"variable_dictionary(analysis_obj)"},{"path":"https://genentech.github.io/psborrow2/reference/variable_dictionary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Variable Dictionary — variable_dictionary","text":"analysis_obj Analysis. Object describe variable names.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/variable_dictionary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Variable Dictionary — variable_dictionary","text":"data.frame names Stan variables descriptions.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/weib_ph_surv_dist.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy function for the Weibull proportional Hazards survival distribution — weib_ph_surv_dist","title":"Legacy function for the Weibull proportional Hazards survival distribution — weib_ph_surv_dist","text":"Please use outcome_surv_weibull_ph() instead.","code":""},{"path":"https://genentech.github.io/psborrow2/reference/weib_ph_surv_dist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy function for the Weibull proportional Hazards survival distribution — weib_ph_surv_dist","text":"","code":"weib_ph_surv_dist(...)"},{"path":"https://genentech.github.io/psborrow2/reference/weib_ph_surv_dist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy function for the Weibull proportional Hazards survival distribution — weib_ph_surv_dist","text":"... Deprecated arguments weib_ph_surv_dist().","code":""},{"path":"https://genentech.github.io/psborrow2/reference/weib_ph_surv_dist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy function for the Weibull proportional Hazards survival distribution — weib_ph_surv_dist","text":"function return value. called, triggers error message indicating weib_ph_surv_dist() deprecated outcome_surv_weibull_ph() used instead.","code":""},{"path":"https://genentech.github.io/psborrow2/news/index.html","id":"psborrow2-003","dir":"Changelog","previous_headings":"","what":"psborrow2 0.0.3","title":"psborrow2 0.0.3","text":"Addition data generation functions simulation studies Improved user interface documentation Additional vignettes","code":""},{"path":"https://genentech.github.io/psborrow2/news/index.html","id":"psborrow2-002","dir":"Changelog","previous_headings":"","what":"psborrow2 0.0.2","title":"psborrow2 0.0.2","text":"First public demonstration psborrow2 Propensity score weighting (weighting) Fixed power priors","code":""},{"path":"https://genentech.github.io/psborrow2/news/index.html","id":"psborrow2-001","dir":"Changelog","previous_headings":"","what":"psborrow2 0.0.1","title":"psborrow2 0.0.1","text":"First private functional application psborrow2 Logistic, exponential survival Weibull proportional hazards survival outcome models Dynamic borrowing commensurate priors Full borrowing borrowing Covariate adjustment Prior specification treatment effect, baseline hazard covariate coefficients Uses CmdStan MCMC","code":""},{"path":"https://genentech.github.io/psborrow2/news/index.html","id":"psborrow2-0009000","dir":"Changelog","previous_headings":"","what":"psborrow2 0.0.0.9000","title":"psborrow2 0.0.0.9000","text":"Start psborrow2","code":""}]
